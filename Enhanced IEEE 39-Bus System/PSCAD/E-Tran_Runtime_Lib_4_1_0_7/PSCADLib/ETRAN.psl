PSCAD 4.2.1

Settings
 {
 Id = "990548388.1520973454"
 Author = "gdi.jd"
 Desc = "Electranix E-TRAN - Power System Translation Library"
 Arch = "windows"
 Options = 32
 Build = 18
 Warn = 1
 Check = 15
 Libs = ""
 Source = ""
 RunInfo = 
  {
  Fin = 0.5
  Step = 5e-005
  Plot = 0.001
  Chat = 0.001
  Brch = 0.0005
  Lat = 100
  Options = 0
  Advanced = 511
  Debug = 0
  StartFile = ""
  OFile = "noname.out"
  SFile = "noname.snp"
  SnapTime = 0.3
  Mruns = 10
  Mrunfile = 0
  StartType = 0
  PlotType = 0
  SnapType = 0
  MrunType = "mrun"
  }

 }

Definitions
 {
 Component("Electranix_meter_1phase")
  {
  Desc = "+ve Sequence Fundamental Frequency Meter"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Choice("PQMon",5,4,118,44,2)
     {
     Style = 1
     Desc = "Monitor P and Q?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes (requires current input)"
     }
    Choice("PU",133,4,132,44,2)
     {
     Style = 1
     Desc = "Outputs in pu or kV,kA,MW,MVAR?"
     Def = "0"
     Len = 15
     *0 = "kV,kA,MW,MVAR"
     *1 = "pu"
     }
    Input("VBase",5,52,260,12,2)
     {
     Desc = "Base Voltage (kV,L-L,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0
     }
    Input("MVABase",5,68,260,12,2)
     {
     Desc = "Base MVA (3 phase)"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 0
     }
    Input("FINIT",5,84,260,12,6)
     {
     Desc = "Initial Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Text("F_NAME",5,100,260,12,2)
     {
     Desc = "Name for Output Frequency (Hz)"
     Len = 15
     }
    Text("Irms",5,116,260,12,2)
     {
     Desc = "Name for +ve Seq Fundamental Current Magnitude (kA,rms)"
     Len = 15
     Cond = "PQMon==1"
     }
    Text("Iphase",5,132,260,12,2)
     {
     Desc = "Name for +ve Seq Fundamental Current Phase (Deg)"
     Len = 15
     Cond = "PQMon==1"
     }
    Choice("View",5,148,142,54,2)
     {
     Style = 1
     Desc = "Connection Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *2 = "Single Phase"
     }
    }
   }

  Nodes = 
   {
   Output("Vphase",54,-18)
    {
    Type = Real
    }
   Output("P",54,0)
    {
    Cond = "PQMon==1"
    Type = Real
    }
   Output("Vrms",54,-36)
    {
    Type = Real
    }
   Output("Q",54,18)
    {
    Cond = "PQMon==1"
    Type = Real
    }
   Input("I",-54,0)
    {
    Cond = "(PQMon==1)&&(View==2)"
    Type = Real
    }
   Input("V",-54,-18)
    {
    Cond = "View==2"
    Type = Real
    }
   Input("I",-54,0)
    {
    Cond = "(PQMon==1)&&(View!=2)"
    Type = Real
    Dim  = [3]
    }
   Input("V",-54,-18)
    {
    Cond = "View!=2"
    Type = Real
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Pen(ByNode,,ByNode,V)
   Line(-41,-18,-47,-24)
   Pen(,,,I)
   Cond = "PQMon==1"
   Line(-41,0,-47,6)
   Line(-41,0,-47,-6)
   Pen(,ByNode,,Vrms)
   Cond = "true"
   Line(54,-36,42,-36)
   Pen(,,,Q)
   Cond = "PQMon==1"
   Line(54,18,42,18)
   Pen(,,,P)
   Line(54,0,42,0)
   Pen(,,,Vphase)
   Cond = "true"
   Line(54,-18,42,-18)
   Pen(,Solid,,V)
   Line(-41,-18,-47,-11)
   Font(,,Right)
   Text(40,-13,"Vphase")
   Cond = "PQMon==1"
   Text(40,3,"P")
   Text(40,21,"Q")
   Font(,,Left)
   Cond = "true"
   Text(-39,-15,"V")
   Cond = "PQMon==1"
   Text(-37,3,"I")
   Font(,,Centre)
   Cond = "true"
   Text(-36,-31,"E")
   Font(,,Right)
   Text(40,-31,"VF0")
   Font(,,Centre)
   Cond = "View==2"
   Text(1,-46,"1-Phase Meter")
   Cond = "View!=2"
   Text(3,-46,"3-Phase Meter")
   Pen(,ByNode,,Vphase)
   Cond = "true"
   Line(-54,-18,-40,-18)
   Pen(,,,I)
   Cond = "PQMon==1"
   Line(-54,0,-40,0)
   Pen(Black,Solid,0.2)
   Cond = "(PQMon==1)&&(View!=2)"
   Line(-52,3,-49,-4)
   Cond = "View!=2"
   Text(-46,-22,"3")
   Cond = "(PQMon==1)&&(View!=2)"
   Text(-46,-6,"3")
   Cond = "View!=2"
   Line(-52,-13,-49,-21)
   Pen(Green,,0.4)
   Cond = "PQMon==1"
   Rectangle(-40,-43,42,25)
   Cond = "PQMon==0"
   Rectangle(-41,-44,41,-10)
   }

  Section(EMTDC)
   {
   DSOUT = "\
#SUBROUTINE Electranix_1Meas - Single Phase Measurements
#IF View==2
 #IF PQMon==0
   #STORAGE STOR:74
   #STORAGE REAL:32
   #STORAGE INTEGER:4
   #STORAGE COMPLEX:2
 #ELSE
   #STORAGE STOR:129
   #STORAGE REAL:51
   #STORAGE INTEGER:6
   #STORAGE COMPLEX:4
 #ENDIF
#ELSE
 #IF PQMon==0
   #STORAGE STOR:222
   #STORAGE REAL:93
   #STORAGE INTEGER:12
   #STORAGE COMPLEX:6
 #ELSE
   #STORAGE STOR:387
   #STORAGE REAL:150
   #STORAGE INTEGER:18
   #STORAGE COMPLEX:12
 #ENDIF
#ENDIF

#IF View==2
#LOCAL REAL V_Clean
#LOCAL REAL V_IN
#LOCAL REAL I_IN
#LOCAL REAL I_rms
#LOCAL REAL I_Phase
#LOCAL INTEGER M_TYPE
#LOCAL REAL V_Freq
#LOCAL REAL VI_P
#LOCAL REAL VI_Q
! Single Phase VI Measurement
      V_IN = $V
 #IF PQMon==0
      I_IN=0.0
      M_TYPE = 0
 #ELSE
      I_IN = $I
      M_TYPE = 1
 #ENDIF
      CALL Electranix_1Meas(V_IN,I_IN,$FINIT,$VBASE,$MVABase,$PU,M_TYPE,$Vrms,$VPhase,V_Freq,I_rms,I_Phase,VI_P,VI_Q,V_Clean)
 #IF PQMon!=0
      $P = VI_P
      $Q = VI_Q
      #OUTPUT REAL Irms 1 {I_rms}
      #OUTPUT REAL Iphase 1 {I_phase}
 #ENDIF
 #OUTPUT REAL F_NAME 1 {V_Freq}
#ELSE
! Three Phase VI Measurements
#LOCAL REAL V_INA
#LOCAL REAL V_INB
#LOCAL REAL V_INC
#LOCAL REAL I_INA
#LOCAL REAL I_INB
#LOCAL REAL I_INC
#LOCAL REAL V_Freq
#LOCAL REAL V_rms
#LOCAL REAL VI_P
#LOCAL REAL VI_Q
#LOCAL INTEGER M_TYPE
#LOCAL REAL V_Freq
#LOCAL REAL V_rms
#LOCAL REAL V_Phase
#LOCAL REAL I_rms
#LOCAL REAL I_Phase
      V_INA = $V(1)
      V_INB = $V(2)
      V_INC = $V(3)
 #IF PQMon==0
      I_INA=0.0
      I_INB=0.0
      I_INC=0.0
      M_TYPE = 0
 #ELSE
      I_INA = $I(1)
      I_INB = $I(2)
      I_INC = $I(3)
      M_TYPE = 1
 #ENDIF
      CALL Electranix_3Meas(V_INA,V_INB,V_INC,I_INA,I_INB,I_INC,$FINIT,$VBASE,$MVABase,$PU,M_TYPE,V_rms,V_Phase,V_Freq,I_rms,I_Phase,VI_P,VI_Q)
      $Vrms = V_rms
      $Vphase = V_Phase

 #IF PQMon!=0
! Calculate +ve sequence fundamental component of PQ
      $P = VI_P
      $Q = VI_Q
      #OUTPUT REAL Irms 1 {I_rms}
      #OUTPUT REAL Iphase 1 {I_Phase}
 #ENDIF
 #OUTPUT REAL F_NAME 1 {V_Freq}
#ENDIF


"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Measurements"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase RMS Meter

Measurement of the following Fundamental Frequency Quantities:
     - Voltage Magnitude (kV,L-L,rms)
     - Current Magnitude (kA,rms)
     - Voltage and Current Phase (Deg)
     - P and Q (MW,MVAR,3 Phase)
     - Bus Frequency (Hz)
:V
Voltage Input (kV,L-G,Instantaneous)
:I
Current Input (kA,Instantaneous)
(Note sign of current will determine direction of P and Q)
:Vrms
Fundamental Frequency Voltage Magnitude (kV,L-L,rms)
:Phase
Fundamental Frequency Voltage Phase (Deg)
:P
Fundamental Frequency Real Power (MW,3 phase)
:Q
Fundamental Frequency Reactive Power (MVAR,3 phase)
"
   }
  }
 Component("Electranix_xfmr_2w")
  {
  Desc = "PSSE Compatible 2 winding transformer"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("Name",5,4,256,12,2)
     {
     Desc = "Transformer Name"
     Def = "T1"
     Len = 15
     }
    Input("Tmva3",5,20,256,12,2)
     {
     Desc = "Transformer MVA (3 phase)"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 1e-006
     }
    Input("f",5,36,256,12,2)
     {
     Desc = "Base Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0.0001
     }
    Input("V1LL",5,52,256,12,2)
     {
     Desc = "Winding #1 Volts (kV,L-L,rms)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("V2LL",5,68,256,12,2)
     {
     Desc = "Winding #2 Volts (kV,L-L,rms)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("Rw",5,84,256,12,2)
     {
     Desc = "R - Winding Resistance (pu)"
     Def = "0.01"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("Xl",5,100,256,12,2)
     {
     Desc = "X - Leakage Reactance (pu)"
     Def = "0.1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("B",5,116,256,12,2)
     {
     Desc = "B - Susceptance (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Choice("Config1",5,136,128,56,2)
     {
     Style = 1
     Desc = "Winding 1 Config"
     Def = "0"
     Len = 15
     Cond = "(PHSHFT==0)&&(View!=2)"
     *0 = "Star Gnd"
     *1 = "Delta-Lag"
     *2 = "Delta-Lead"
     }
    Choice("Config2",151,137,110,55,2)
     {
     Style = 1
     Desc = "Winding 2 Config"
     Def = "0"
     Len = 15
     Cond = "(PHSHFT==0)&&(View!=2)"
     *0 = "Star Gnd"
     *1 = "Delta-Lag"
     *2 = "Delta-Lead"
     }
    Choice("Enable",5,196,128,40,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("PHSHFT",151,196,110,40,2)
     {
     Style = 1
     Desc = "Is this a Phase Shifter?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("View",5,240,128,55,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "1"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line (V4)"
     *2 = "Single Phase"
     }
    Choice("NegXCap",151,240,110,52,2)
     {
     Style = 1
     Desc = "If X is -ve, Model it as:"
     Def = "0"
     Len = 15
     *0 = "-ve Series Inductance"
     *1 = "+ve Series Capacitance"
     }
    Choice("V5Format",59,296,160,44,2)
     {
     Style = 1
     Desc = "Use new PSCAD V5 Transformer Format?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    }
   Category("Tap, Shunt Phase Shifter Data")
    {
    Choice("Tap",5,4,109,52,2)
     {
     Style = 1
     Desc = "Select Tap Winding:"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "None"
     *1 = "Winding 1"
     *2 = "Winding 2"
     }
    Input("TapI",5,64,265,12,6)
     {
     Desc = "Tap Setting ( = Vtap / Vx, 0.8<Tap<1.2, can be a variable)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.0001
     Cond = "Tap!=0"
     }
    Input("PSANG",5,80,265,24,2)
     {
     Desc = "Phase Shifter Angle (Winding 1 - Winding 2) (Deg, -80<X<80)"
     Def = "0.0"
     Data = Real
     Unit = "°"
     Len = 15
     Min = -80
     Max = 80
     Cond = "PHSHFT==1"
     }
    Input("XlTable",5,108,265,12,2)
     {
     Desc = "Impedance Correction Table #"
     Def = "0"
     Data = Integer
     Len = 15
     Min = -1
     Max = 100000
     Cond = "(Tap!=0) || (PHSHFT==1)"
     }
    Input("XlFactor",5,124,265,24,2)
     {
     Desc = "Real Impedance Correction Factor (obtained from Tables for a given Tap/Angle)"
     Def = "1.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0) || (PHSHFT==1)"
     }
    Input("XlFactj",5,152,265,24,2)
     {
     Desc = "Imag. Impedance Correction Factor (obtained from Tables for a given Tap/Angle)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0) || (PHSHFT==1)"
     }
    Input("GI",5,180,265,12,2)
     {
     Desc = "GI - Real Shunt Admittance on bus I (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BI",5,196,265,12,2)
     {
     Desc = "BI - Imag. Shunt Admittance on bus I (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("GJ",5,212,265,12,2)
     {
     Desc = "GJ - Real Shunt Admittance on bus J (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BJ",5,228,265,12,2)
     {
     Desc = "BJ - Imag. Shunt Admittance on bus J (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    }
   Category("Saturation")
    {
    Choice("Enab",5,4,150,40,2)
     {
     Style = 1
     Desc = "Enable Saturation?"
     Def = "0"
     Len = 15
     *0 = "No (can be enabled from a snapshot)"
     *1 = "Yes"
     }
    Choice("Sat",165,4,105,40,2)
     {
     Style = 1
     Desc = "Place saturation on winding:"
     Def = "1"
     Len = 15
     *1 = "#1"
     *2 = "#2"
     }
    Input("Xair",5,52,265,12,2)
     {
     Desc = "Air core reactance (pu)"
     Def = "0.2"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0.001
     Max = 10
     }
    Input("Tdc",5,68,265,12,2)
     {
     Desc = "Inrush decay time constant (sec)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0.001
     }
    Input("Xknee",5,84,265,12,2)
     {
     Desc = "Knee voltage(pu)"
     Def = "1.25"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("Txk",5,100,265,12,2)
     {
     Desc = "Time to release flux clipping"
     Def = "0.1"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0
     Max = 1e+006
     }
    Input("Im1",5,116,265,12,2)
     {
     Desc = "Magnetizing current"
     Def = "0.4"
     Data = Real
     Unit = "%"
     Len = 15
     Min = 0.0001
     Max = 50
     }
    }
   Category("Monitoring of Currents and Flux")
    {
    Text("IL1",5,4,265,24,2)
     {
     Desc = "Name for winding #1 line currents (kA,into winding, not including inrush current)"
     Len = 23
     }
    Text("IL2",5,32,265,24,2)
     {
     Desc = "Name for winding #2 line currents (kA,into winding, not including inrush current)"
     Len = 23
     }
    Text("IMAG",5,64,265,12,2)
     {
     Desc = "Name for magnetizing currents (kA)"
     Len = 23
     }
    Text("FLUX",5,80,265,12,2)
     {
     Desc = "Name for flux linkages (kWb-N)"
     Len = 23
     }
    }
   }

  Nodes = 
   {
   Electrical("A11",-54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A11",-54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("B11",-54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("C11",-54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N11",-54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("A22",54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A22",54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("B22",54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("C22",54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N22",54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("Ground",-36,18)
    {
    Cond = "Enable==1"
    Type = Ground
    }
   Electrical("A1",-18,-18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("A1",-18,-18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("A1",-18,0)
    {
    Cond = "(Enable==1)&&((((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))||(PHSHFT==1))&&(View==2)"
    }
   Electrical("A1",-18,0)
    {
    Cond = "(Enable==1)&&((((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))||(PHSHFT==1))&&(View==2)"
    }
   Electrical("B1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("B1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("C1",-18,18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("C1",-18,18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("N1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==1)"
    Dim  = [3]
    }
   Electrical("N1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==1)"
    Dim  = [3]
    }
   Electrical("A2",18,-18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("A2",18,-18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("A2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==2)"
    }
   Electrical("A2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==2)"
    }
   Electrical("B2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("B2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("C2",18,18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("C2",18,18)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==0)"
    }
   Electrical("N2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==1)"
    Dim  = [3]
    }
   Electrical("N2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))&&(View==1)"
    Dim  = [3]
    }
   Electrical("MA2",0,-18)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MA2",0,-18)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MB2",0,0)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MB2",0,0)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MC2",0,18)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MC2",0,18)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==0)"
    }
   Electrical("MN2",0,0)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("MN2",0,0)
    {
    Cond = "(Enable==1)&&(PHSHFT==1)&&(View==1)"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-27,-12,27,10)
   Cond = "PHSHFT==1"
   Line(18,-12,18,-9)
   Line(15,-10,18,-12)
   Line(3,12,18,-12)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Line(-21,22,-21,19)
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Line(21,7,21,0)
   Line(21,22,21,19)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Line(-21,7,-21,0)
   Brush(Hollow)
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Rectangle(16,7,25,19)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Rectangle(-25,7,-16,19)
   Cond = "View!=1"
   Line(16,0,54,0)
   Line(-54,0,-16,0)
   Pen(,,0.6)
   Cond = "View==1"
   Ellipse(-4,-10,16,10)
   Ellipse(-16,-10,4,10)
   Line(-54,0,-16,0)
   Pen(,,0.2)
   Cond = "View!=1"
   Ellipse(-4,-10,16,10)
   Ellipse(-16,-10,4,10)
   Cond = "View==0"
   Line(-54,-18,-46,0)
   Line(-46,0,-54,18)
   Line(54,-18,46,0)
   Line(46,0,54,18)
   Pen(,,0.6)
   Cond = "View==1"
   Line(16,0,54,0)
   Pen(,,0.2)
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config1!=0)"
   Line(-12,6,-9,1)
   Line(-6,6,-12,6)
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config2!=0)"
   Line(6,6,9,1)
   Line(12,6,6,6)
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config1!=0)"
   Line(-9,1,-6,6)
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config2!=0)"
   Line(9,1,12,6)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Text(-21,18,"I")
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Text(21,18,"J")
   Cond = "true"
   Text(24,-12,"$V2LL")
   Text(-24,-12,"$V1LL")
   Text(0,19,"E")
   Text(0,-12,":")
   Text(-8,1,"1")
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config1==0)"
   Line(-10,5,-5,0)
   Line(-10,5,-14,-1)
   Line(-10,11,-10,5)
   Line(-10,5,-6,5)
   Line(-6,2,-6,8)
   Line(-5,3,-5,7)
   Line(-4,4,-4,6)
   Cond = "(View!=2)&&(PHSHFT==0)&&(Config2==0)"
   Line(6,5,11,0)
   Line(6,5,2,-1)
   Line(6,11,6,5)
   Line(6,5,10,5)
   Line(10,2,10,8)
   Line(11,3,11,7)
   Line(12,4,12,6)
   }

  Section(EMTDC)
   {
   Computations = "\
INTEGER Type1=((View==2)||(PHSHFT==1)) ? 0 : Config1
INTEGER Type2=((View==2)||(PHSHFT==1)) ? 0 : Config2
INTEGER NCW = -2
REAL    PSAngle = -PSANG
REAL    N1x = (PHSHFT==1)&&(View!=2) ? cos(abs(PSANG)*pi/180.0) : 1.0
REAL    N2x = (PHSHFT==1)&&(View!=2) ? sin(abs(PSANG)*pi/180.0) : 1.0
REAL    V1x=(Type1==0) ? V1LL/sqrt(3.0) : V1LL
REAL    V2x=(Type2==0) ? V2LL/sqrt(3.0) : V2LL
REAL    V1 = ((Tap==0)||(Tap==2)) ? V1x : V1x
REAL    V2 = ((Tap==0)||(Tap==1)) ? V2x : V2x
REAL    Tmva=Tmva3/3.0
REAL    Xlcorrf= ((Tap!=0)||(PHSHFT==1)) ? XlFactor : 1.0
REAL    Xlcorrfj= ((Tap!=0)||(PHSHFT==1)) ? XlFactj : 0.0
REAL    xlnew = ((Xl>0.0)||(NegXCap==0)) ? Xl : 0.000001
REAL    xlmod = xlnew/(N1x*N1x)
REAL    xlc = xlnew*Xlcorrf + Rw*Xlcorrfj
REAL    rwc = Rw*Xlcorrf - xlnew*Xlcorrfj
REAL    I_m1= Im1*0.01
REAL    I_m2= I_m1
REAL    w   = 2*pi*f
REAL    ib1 = Tmva/V1
REAL    zb1 = V1/ib1
REAL	 tr  = V1/(V2*N1x)
REAL    l1  = w/(xlc*zb1)
REAL    l2  = tr*tr*l1
REAL    l12 = -tr*l1
REAL    PSxlc = 0.00001
REAL    PSV1 = V2LL*N1x
REAL    PSV2 = V2LL/sqrt(3.0)
REAL    PSib1 = Tmva/PSV1
REAL    PSzb1 = PSV1/PSib1
REAL	 PStr  = (PSANG!=0.0) ? PSV1/(PSV2*N2x) : 0.0
REAL    PSl1  = w/(PSxlc*PSzb1)
REAL    PSl2  = PStr*PStr*PSl1
REAL    PSl12 = -PStr*PSl1
REAL    ZBASE1   = (V1LL*V1LL)/Tmva3
REAL    ZBASE2   = (V2LL*V2LL)/Tmva3
REAL    YBASE1   = Tmva3/(V1LL*V1LL)
REAL    YBASE2   = Tmva3/(V2LL*V2LL)
REAL    Rw1      = 0.5*rwc*ZBASE1
REAL    Rw2      = 0.5*rwc*ZBASE2
REAL    Rw1D     = (V5Format==0) ? Rw1 : 0.0
REAL    Rw2D     = (V5Format==0) ? Rw2 : 0.0
REAL    Cw1      = ((Xl>0.0)||(NegXCap==0)) ? 0.0 : (1.0e6*2.0)/(-Xl*ZBASE1*w)
REAL    Cw2      = ((Xl>0.0)||(NegXCap==0)) ? 0.0 : (1.0e6*2.0)/(-Xl*ZBASE2*w)
REAL    CShunt1  = B>0  ? (1.0e6/2.0)*B/(ZBASE1*w)   : 0.0
REAL    CShunt2  = B>0  ? (1.0e6/2.0)*B/(ZBASE2*w)   : 0.0
REAL    LShunt1  = B<0  ? 2.0*(ZBASE1/(-B))/w        : 0.0
REAL    LShunt2  = B<0  ? 2.0*(ZBASE2/(-B))/w        : 0.0
REAL    RShuntI  = ((GI>1.0e-10)||(GI<(-1.0e-10)))  ? 1.0/(GI*YBASE1) : 0.0
REAL    CShuntI  = BI>0  ? (1.0e6)*BI/(ZBASE1*w)     : 0.0
REAL    LShuntI  = BI<0  ? (ZBASE1/(-BI))/w          : 0.0
REAL    RShuntJ  = ((GJ>1.0e-10)||(GJ<(-1.0e-10)))  ? 1.0/(GJ*YBASE2) : 0.0
REAL    CShuntJ  = BJ>0  ? (1.0e6)*BJ/(ZBASE2*w)     : 0.0
REAL    LShuntJ  = BJ<0  ? (ZBASE2/(-BJ))/w          : 0.0
REAL    Rw1V5    = Rw1>=1.0E-6 ? (Type1==0 ? Rw1 : (3.0*Rw1)) : 0.0
REAL    Rw2V5    = Rw2>=1.0E-6 ? (Type2==0 ? Rw2 : (3.0*Rw2)) : 0.0
"
   Transformers = "\
#IF Enable==1
C   PSSE Compatible Single Phase Transformer:   $Tmva3 MVA, $V1LL kV,LL : $V2LL kV,LL
#IF PHSHFT==0
C Normal Transformer (not phase shifters) 
 #IF View==2
  #TRANSFORMERS 1
  #WINDINGS 2
 #ELSE
  #TRANSFORMERS 3
  #WINDINGS 2
 #ENDIF
 #IF (((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))
C Winding R,C > 0.0
  #IF View==0
C 3 Phase
   $NCW / Number of windings...
   #IF Type1==0
    $A1 0      $l1 /
   #ELSEIF Type1==1
    $A1 $B1    $l1 /
   #ELSEIF Type1==2
    $A1 $C1    $l1 /
   #ENDIF
   #IF Type2==0
    $A2 0      $l12   $l2 /
   #ELSEIF Type2==1
    $A2 $B2    $l12   $l2 /
   #ELSEIF Type2==2
    $A2 $C2    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $B1 0      $l1 /
   #ELSEIF Type1==1
    $B1 $C1    $l1 /
   #ELSEIF Type1==2
    $B1 $A1    $l1 /
   #ENDIF
   #IF Type2==0
    $B2 0      $l12   $l2 /
   #ELSEIF Type2==1
    $B2 $C2    $l12   $l2 /
   #ELSEIF Type2==2
    $B2 $A2    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $C1 0      $l1 /
   #ELSEIF Type1==1
    $C1 $A1    $l1 /
   #ELSEIF Type1==2
    $C1 $B1    $l1 /
   #ENDIF
   #IF Type2==0
    $C2 0      $l12   $l2 /
   #ELSEIF Type2==1
    $C2 $A2    $l12   $l2 /
   #ELSEIF Type2==2
    $C2 $B2    $l12   $l2 /
   #ENDIF
  #ELSEIF View==1
C 3 Phase SLD
   $NCW / Number of windings...
   #IF Type1==0
    $N1(1) 0      $l1 /
   #ELSEIF Type1==1
    $N1(1) $N1(2)    $l1 /
   #ELSEIF Type1==2
    $N1(1) $N1(3)    $l1 /
   #ENDIF
   #IF Type2==0
    $N2(1) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N2(1) $N2(2)    $l12   $l2 /
   #ELSEIF Type2==2
    $N2(1) $N2(3)    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N1(2) 0      $l1 /
   #ELSEIF Type1==1
    $N1(2) $N1(3)    $l1 /
   #ELSEIF Type1==2
    $N1(2) $N1(1)    $l1 /
   #ENDIF
   #IF Type2==0
    $N2(2) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N2(2) $N2(3)    $l12   $l2 /
   #ELSEIF Type2==2
    $N2(2) $N2(1)    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N1(3) 0      $l1 /
   #ELSEIF Type1==1
    $N1(3) $N1(1)    $l1 /
   #ELSEIF Type1==2
    $N1(3) $N1(2)    $l1 /
   #ENDIF
   #IF Type2==0
    $N2(3) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N2(3) $N2(1)    $l12   $l2 /
   #ELSEIF Type2==2
    $N2(3) $N2(2)    $l12   $l2 /
   #ENDIF
  #ELSE
C Single Phase
   $NCW / Number of windings...
   $A1 0    $l1 /
   $A2 0    $l12   $l2 /
  #ENDIF
 #ELSEIF ((ABS(Rw)>0)&&(V5Format!=0))
C Winding resistance is entered - use new format

  #IF View==0
C 3 Phase
   $NCW -1/ Number of windings...
   #IF Type1==0
    $A11 0      $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $A11 $B11   $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $A11 $C11   $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $A22 0     0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $A22 $B22   0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $A22 $C22    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $B11 0     $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $B11 $C11  $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $B11 $A11  $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $B22 0      0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $B22 $C22    0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $B22 $A22    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $C11 0     $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $C11 $A11  $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $C11 $B11  $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $C22 0      0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $C22 $A22    0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $C22 $B22    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
  #ELSEIF View==1
C 3 Phase SLD
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(1) 0     $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $N11(1) $N11(2)   $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $N11(1) $N11(3)   $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $N22(1) 0      0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $N22(1) $N22(2)    0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $N22(1) $N22(3)    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(2) 0     $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $N11(2) $N11(3)   $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $N11(2) $N11(1)   $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $N22(2) 0      0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $N22(2) $N22(3)   0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $N22(2) $N22(1)    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(3) 0     $Rw1V5 $l1 /
   #ELSEIF Type1==1
    $N11(3) $N11(1)   $Rw1V5 $l1 /
   #ELSEIF Type1==2
    $N11(3) $N11(2)   $Rw1V5 $l1 /
   #ENDIF
   #IF Type2==0
    $N22(3) 0      0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==1
    $N22(3) $N22(1)    0.0 $l12 $Rw2V5 $l2 /
   #ELSEIF Type2==2
    $N22(3) $N22(2)    0.0 $l12 $Rw2V5 $l2 /
   #ENDIF
  #ELSE
C Single Phase
   $NCW -1/ Number of windings...
   $A11 0   $Rw1V5   $l1 /
   $A22 0   0.0 $l12 $Rw2V5 $l2 /
  #ENDIF

 #ELSE
C Winding R = 0.0 - use old format
  #IF View==0
C 3 Phase
   $NCW / Number of windings...
   #IF Type1==0
    $A11 0      $l1 /
   #ELSEIF Type1==1
    $A11 $B11    $l1 /
   #ELSEIF Type1==2
    $A11 $C11    $l1 /
   #ENDIF
   #IF Type2==0
    $A22 0      $l12   $l2 /
   #ELSEIF Type2==1
    $A22 $B22    $l12   $l2 /
   #ELSEIF Type2==2
    $A22 $C22    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $B11 0      $l1 /
   #ELSEIF Type1==1
    $B11 $C11    $l1 /
   #ELSEIF Type1==2
    $B11 $A11    $l1 /
   #ENDIF
   #IF Type2==0
    $B22 0      $l12   $l2 /
   #ELSEIF Type2==1
    $B22 $C22    $l12   $l2 /
   #ELSEIF Type2==2
    $B22 $A22    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $C11 0      $l1 /
   #ELSEIF Type1==1
    $C11 $A11    $l1 /
   #ELSEIF Type1==2
    $C11 $B11    $l1 /
   #ENDIF
   #IF Type2==0
    $C22 0      $l12   $l2 /
   #ELSEIF Type2==1
    $C22 $A22    $l12   $l2 /
   #ELSEIF Type2==2
    $C22 $B22    $l12   $l2 /
   #ENDIF
  #ELSEIF View==1
C 3 Phase SLD
   $NCW / Number of windings...
   #IF Type1==0
    $N11(1) 0      $l1 /
   #ELSEIF Type1==1
    $N11(1) $N11(2)    $l1 /
   #ELSEIF Type1==2
    $N11(1) $N11(3)    $l1 /
   #ENDIF
   #IF Type2==0
    $N22(1) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N22(1) $N22(2)    $l12   $l2 /
   #ELSEIF Type2==2
    $N22(1) $N22(3)    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N11(2) 0      $l1 /
   #ELSEIF Type1==1
    $N11(2) $N11(3)    $l1 /
   #ELSEIF Type1==2
    $N11(2) $N11(1)    $l1 /
   #ENDIF
   #IF Type2==0
    $N22(2) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N22(2) $N22(3)    $l12   $l2 /
   #ELSEIF Type2==2
    $N22(2) $N22(1)    $l12   $l2 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N11(3) 0      $l1 /
   #ELSEIF Type1==1
    $N11(3) $N11(1)    $l1 /
   #ELSEIF Type1==2
    $N11(3) $N11(2)    $l1 /
   #ENDIF
   #IF Type2==0
    $N22(3) 0      $l12   $l2 /
   #ELSEIF Type2==1
    $N22(3) $N22(1)    $l12   $l2 /
   #ELSEIF Type2==2
    $N22(3) $N22(2)    $l12   $l2 /
   #ENDIF
  #ELSE
C Single Phase
   $NCW / Number of windings...
   $A11 0    $l1 /
   $A22 0    $l12   $l2 /
  #ENDIF
 #ENDIF
#ELSE
C Phase Shifter
 #IF View==2
  #TRANSFORMERS 1
  #WINDINGS 2
 #ELSE
  #TRANSFORMERS 6
  #WINDINGS 2
 #ENDIF
 #IF (((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))
C (ABS(Rw)>0)||((Xl<0)&&(NegXCap==1))
  #IF View==0
C Parallel Transformer
    $NCW / Number of windings...
    $A1   0    $l1 /
    $MA2  0    $l12   $l2 /
    $NCW / Number of windings...
    $B1   0    $l1 /
    $MB2  0    $l12   $l2 /
    $NCW / Number of windings...
    $C1   0    $l1 /
    $MC2  0    $l12   $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW / Number of windings...
    $MB2  $MC2   $PSl1 /
    $MA2  $A2    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MC2  $MA2   $PSl1 /
    $MB2  $B2    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MA2  $MB2   $PSl1 /
    $MC2  $C2    $PSl12   $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW / Number of windings...
    $MC2  $MB2   $PSl1 /
    $MA2  $A2    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MA2  $MC2   $PSl1 /
    $MB2  $B2    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MB2  $MA2   $PSl1 /
    $MC2  $C2    $PSl12   $PSl2 /
   #ENDIF
  #ELSEIF View==1
C Parallel Transformer
    $NCW / Number of windings...
    $N1(1)   0    $l1 /
    $MN2(1)  0    $l12   $l2 /
    $NCW / Number of windings...
    $N1(2)   0    $l1 /
    $MN2(2)  0    $l12   $l2 /
    $NCW / Number of windings...
    $N1(3)   0    $l1 /
    $MN2(3)  0    $l12   $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW / Number of windings...
    $MN2(2)  $MN2(3)   $PSl1 /
    $MN2(1)  $N2(1)    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(3)  $MN2(1)   $PSl1 /
    $MN2(2)  $N2(2)    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(1)  $MN2(2)   $PSl1 /
    $MN2(3)  $N2(3)    $PSl12   $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW / Number of windings...
    $MN2(3)  $MN2(2)   $PSl1 /
    $MN2(1)  $N2(1)    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(1)  $MN2(3)   $PSl1 /
    $MN2(2)  $N2(2)    $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(2)  $MN2(1)   $PSl1 /
    $MN2(3)  $N2(3)    $PSl12   $PSl2 /
   #ENDIF
  #ELSE
    $NCW / Number of windings...
    $A1   0    $l1 /
    $A22  0    $l12   $l2 /
  #ENDIF
 #ELSEIF ((ABS(Rw)>0)&&(V5Format!=0))
C Winding resistance is entered - use new format

  #IF View==0
C Parallel Transformer
    $NCW -1 / Number of windings...
    $A11  0    $Rw1V5 $l1 /
    $MA2  0    0.0 $l12   $Rw2V5 $l2 /
    $NCW -1/ Number of windings...
    $B11  0    $Rw1V5 $l1 /
    $MB2  0    0.0 $l12   $Rw2V5 $l2 /
    $NCW -1/ Number of windings...
    $C11  0    $Rw1V5 $l1 /
    $MC2  0    0.0 $l12   $Rw2V5 $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW -1/ Number of windings...
    $MB2  $MC2   0.0 $PSl1 /
    $MA2  $A22   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MC2  $MA2   0.0 $PSl1 /
    $MB2  $B22   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MA2  $MB2   0.0 $PSl1 /
    $MC2  $C22   0.0 $PSl12   0.0 $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW -1/ Number of windings...
    $MC2  $MB2   0.0 $PSl1 /
    $MA2  $A22   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MA2  $MC2   0.0 $PSl1 /
    $MB2  $B22   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MB2  $MA2   0.0 $PSl1 /
    $MC2  $C22   0.0 $PSl12   0.0 $PSl2 /
   #ENDIF
  #ELSEIF View==1
C Parallel Transformer
    $NCW -1/ Number of windings...
    $N11(1)  0    $Rw1V5 $l1 /
    $MN2(1)  0    0.0 $l12   $Rw2V5 $l2 /
    $NCW -1/ Number of windings...
    $N11(2)  0    $Rw1V5 $l1 /
    $MN2(2)  0    0.0 $l12   $Rw2V5 $l2 /
    $NCW -1/ Number of windings...
    $N11(3)  0    $Rw1V5 $l1 /
    $MN2(3)  0    0.0 $l12   $Rw2V5 $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW -1/ Number of windings...
    $MN2(2)  $MN2(3)   0.0 $PSl1 /
    $MN2(1)  $N22(1)   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MN2(3)  $MN2(1)   0.0 $PSl1 /
    $MN2(2)  $N22(2)   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MN2(1)  $MN2(2)   0.0 $PSl1 /
    $MN2(3)  $N22(3)   0.0 $PSl12   0.0 $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW -1/ Number of windings...
    $MN2(3)  $MN2(2)   0.0 $PSl1 /
    $MN2(1)  $N22(1)   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MN2(1)  $MN2(3)   0.0 $PSl1 /
    $MN2(2)  $N22(2)   0.0 $PSl12   0.0 $PSl2 /
    $NCW -1/ Number of windings...
    $MN2(2)  $MN2(1)   0.0 $PSl1 /
    $MN2(3)  $N22(3)   0.0 $PSl12   0.0 $PSl2 /
   #ENDIF
  #ELSE
    $NCW -1/ Number of windings...
    $A1   0    $Rw1V5 $l1 /
    $A22  0    0.0 $l12  $Rw2V5 $l2 /
  #ENDIF

#ELSE
C RwCw=0
  #IF View==0
C Parallel Transformer
    $NCW / Number of windings...
    $A11  0    $l1 /
    $MA2  0    $l12   $l2 /
    $NCW / Number of windings...
    $B11  0    $l1 /
    $MB2  0    $l12   $l2 /
    $NCW / Number of windings...
    $C11  0    $l1 /
    $MC2  0    $l12   $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW / Number of windings...
    $MB2  $MC2   $PSl1 /
    $MA2  $A22   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MC2  $MA2   $PSl1 /
    $MB2  $B22   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MA2  $MB2   $PSl1 /
    $MC2  $C22   $PSl12   $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW / Number of windings...
    $MC2  $MB2   $PSl1 /
    $MA2  $A22   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MA2  $MC2   $PSl1 /
    $MB2  $B22   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MB2  $MA2   $PSl1 /
    $MC2  $C22   $PSl12   $PSl2 /
   #ENDIF
  #ELSEIF View==1
C Parallel Transformer
    $NCW / Number of windings...
    $N11(1)  0    $l1 /
    $MN2(1)  0    $l12   $l2 /
    $NCW / Number of windings...
    $N11(2)  0    $l1 /
    $MN2(2)  0    $l12   $l2 /
    $NCW / Number of windings...
    $N11(3)  0    $l1 /
    $MN2(3)  0    $l12   $l2 /
   #IF PSAngle >= 0.0
C Series Transformer - +ve Phase Shift Angle
    $NCW / Number of windings...
    $MN2(2)  $MN2(3)   $PSl1 /
    $MN2(1)  $N22(1)   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(3)  $MN2(1)   $PSl1 /
    $MN2(2)  $N22(2)   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(1)  $MN2(2)   $PSl1 /
    $MN2(3)  $N22(3)   $PSl12   $PSl2 /
   #ELSE
C Series Transformer - -ve Phase Shift Angle
    $NCW / Number of windings...
    $MN2(3)  $MN2(2)   $PSl1 /
    $MN2(1)  $N22(1)   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(1)  $MN2(3)   $PSl1 /
    $MN2(2)  $N22(2)   $PSl12   $PSl2 /
    $NCW / Number of windings...
    $MN2(2)  $MN2(1)   $PSl1 /
    $MN2(3)  $N22(3)   $PSl12   $PSl2 /
   #ENDIF
  #ELSE
    $NCW / Number of windings...
    $A1   0    $l1 /
    $A22  0    $l12   $l2 /
  #ENDIF
 #ENDIF
#ENDIF
#ENDIF
"
   Matrix-fill = "\
#IF Enable==1
#IF PHSHFT==0
 #IF (((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))
  #IF View==0
   $A1 $A11
   $A2 $A22
   $B1 $B11
   $B2 $B22
   $C1 $C11
   $C2 $C22
   #IF (Type1==0)&&(Type2==0)
    $A1 $A2
    $B1 $B2
    $C1 $C2
   #ELSE
    $A1 $A2 $B1 $B2 $C1 $C2
   #ENDIF
  #ELSEIF View==1
   $N1(1) $N11(1)
   $N2(1) $N22(1)
   $N1(2) $N11(2)
   $N2(2) $N22(2)
   $N1(3) $N11(3)
   $N2(3) $N22(3)
   #IF (Type1==0)&&(Type2==0)
    $N1(1) $N2(1)
    $N1(2) $N2(2)
    $N1(3) $N2(3)
   #ELSE
    $N1(1) $N2(1) $N1(2) $N2(2) $N1(3) $N2(3)
   #ENDIF
  #ELSE
   $A1 $A11
   $A2 $A22
   $A1 $A2
  #ENDIF
 #ELSE
   #IF View==0
    #IF (Type1==0)&&(Type2==0)
     $A11 $A22
     $B11 $B22
     $C11 $C22
    #ELSE
     $A11 $A22 $B11 $B22 $C11 $C22
    #ENDIF
   #ELSEIF View==1
    #IF (Type1==0)&&(Type2==0)
     $N11(1) $N22(1)
     $N11(2) $N22(2)
     $N11(3) $N22(3)
    #ELSE
     $N11(1) $N22(1) $N11(2) $N22(2) $N11(3) $N22(3)
    #ENDIF
   #ELSE
     $A11 $A22
   #ENDIF
 #ENDIF
#ELSE
 #IF (((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))
    #IF View==0
      $A1  $A11
      $A2  $A22
      $B1  $B11
      $B2  $B22
      $C1  $C11
      $C2  $C22
      $A1  $MA2
      $B1  $MB2
      $C1  $MC2
      $MB2 $MC2 $MA2 $A2
      $MC2 $MA2 $MB2 $B2
      $MA2 $MB2 $MC2 $C2
    #ELSEIF View==1
      $N1(1)  $N11(1)
      $N2(1)  $N22(1)
      $N1(2)  $N11(2)
      $N2(2)  $N22(2)
      $N1(3)  $N11(3)
      $N2(3)  $N22(3)
      $N1(1)  $MN2(1)
      $N1(2)  $MN2(2)
      $N1(3)  $MN2(3)
      $MN2(2) $MN2(3) $MN2(1) $N2(1)
      $MN2(3) $MN2(1) $MN2(2) $N2(2)
      $MN2(1) $MN2(2) $MN2(3) $N2(3)
    #ELSE
      $A1  $A11
      $A2  $A22
    #ENDIF
 #ELSE
    #IF View==0
      $A11  $MA2
      $B11  $MB2
      $C11  $MC2
      $MB2 $MC2 $MA2 $A22
      $MC2 $MA2 $MB2 $B22
      $MA2 $MB2 $MC2 $C22
    #ELSEIF View==1
      $N11(1)  $MN2(1)
      $N11(2)  $MN2(2)
      $N11(3)  $MN2(3)
      $MN2(2) $MN2(3) $MN2(1) $N22(1)
      $MN2(3) $MN2(1) $MN2(2) $N22(2)
      $MN2(1) $MN2(2) $MN2(3) $N22(3)
    #ELSE
      $A1  $A11
      $A2  $A22
    #ENDIF
 #ENDIF
#ENDIF
#ENDIF"
   Dsdyn = "\
#IF Enable==1
 #IF PHSHFT==0
      CALL ETRAN_COM_SET_YEQ(0,0,0,$SS,0,\"$Name\",$Rw,$Xl,$Tmva3,$V1LL)

   #IF View==0
    #STORAGE STOR:63
   #ELSEIF View==1
    #STORAGE STOR:63
   #ELSE
    #STORAGE STOR:21
   #ENDIF

 #ELSE

  #IF View==2
   #STORAGE REAL:33
   #STORAGE INTEGER:4
   #STORAGE COMPLEX:2
  #ENDIF
   #IF View==0
    #STORAGE STOR:63
   #ELSEIF View==1
    #STORAGE STOR:63
   #ELSE
    #STORAGE STOR:21
   #ENDIF


 #ENDIF
!  TRANSFORMER SATURATION SUBROUTINE
#SUBROUTINE TSAT21 Transformer Saturation Subroutine
#LOCAL REAL X_KNEE
#If Txk>0
      IF (TIME.GT.$Txk) THEN
         X_KNEE = $Xknee
      ELSE
         X_KNEE = -$Xknee
      ENDIF
#ELSE
      X_KNEE = $Xknee
#ENDIF
#IF Sat==1
   #IF View==0
     #IF Type1==0
      CALL TSAT21($A11,0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($B11,0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($C11,0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==1
      CALL TSAT21($A11,$B11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($B11,$C11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($C11,$A11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==2
      CALL TSAT21($A11,$C11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($B11,$A11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($C11,$B11, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ENDIF
   #ELSEIF View==1
     #IF Type1==0
      CALL TSAT21($N11(1),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==1
      CALL TSAT21($N11(1),$N11(2), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),$N11(3), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),$N11(1), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==2
      CALL TSAT21($N11(1),$N11(3), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),$N11(1), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),$N11(2), 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ENDIF
   #ELSE
      CALL TSAT21($A11,0, 0,0, 0,0, $SS,
     +     $Tmva,$V1x,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #OUTPUT REAL IMAG {-STOR(NEXC-21+17)}
    #OUTPUT REAL FLUX {STOR(NEXC-21+11)}
   #ENDIF
   #IF View!=2
    #OUTPUT REAL IMAG 3 {-STOR(NEXC-21*3+17)} {-STOR(NEXC-21*2+17)} {-STOR(NEXC-21+17)}
    #OUTPUT REAL FLUX 3 { STOR(NEXC-21*3+11)} { STOR(NEXC-21*2+11)} { STOR(NEXC-21+11)}
   #ENDIF
#ELSE
   #IF View==0
     #IF Type2==0
      CALL TSAT21($A22,0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($B22,0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($C22,0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==1
      CALL TSAT21($A22,$B22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($B22,$C22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($C22,$A22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==2
      CALL TSAT21($A22,$C22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($B22,$A22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($C22,$B22, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ENDIF
   #ELSEIF View==1
     #IF Type2==0
      CALL TSAT21($N22(1),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==1
      CALL TSAT21($N22(1),$N22(2), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),$N22(3), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),$N22(1), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==2
      CALL TSAT21($N22(1),$N22(3), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),$N22(1), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),$N22(2), 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ENDIF
   #ELSE
      CALL TSAT21($A22,0, 0,0, 0,0, $SS,
     +     $Tmva,$V2x,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
    #OUTPUT REAL IMAG {-STOR(NEXC-21+17)}
    #OUTPUT REAL FLUX {STOR(NEXC-21+11)}
   #ENDIF
   #IF View!=2
    #OUTPUT REAL IMAG 3 {-STOR(NEXC-21*3+17)} {-STOR(NEXC-21*2+17)} {-STOR(NEXC-21+17)}
    #OUTPUT REAL FLUX 3 { STOR(NEXC-21*3+11)} { STOR(NEXC-21*2+11)} { STOR(NEXC-21+11)}
   #ENDIF
#ENDIF
!
#IF PHSHFT
   #IF View==2
      CALL Electranix_1PhaseShift($A11,$BPH,$SS,$V1LL,$f,$PSANG)
   #ENDIF
#ENDIF

#IF Tap!=0
#STORAGE STOR:15
      CALL TRTAP5($#[1], $Tap, $SS, $TapI)
      CALL TRTAP5($#[2], $Tap, $SS, $TapI)
      CALL TRTAP5($#[3], $Tap, $SS, $TapI)
#ENDIF


#ELSE
   #IF View==2
    #OUTPUT REAL IMAG {0.0}
    #OUTPUT REAL FLUX {0.0}
   #ELSE
    #OUTPUT REAL IMAG 3 {0.0} {0.0} {0.0}
    #OUTPUT REAL FLUX 3 {0.0} {0.0} {0.0}
   #ENDIF
#ENDIF


"
   Dsout = "\
#IF Enable==1
   #IF View==2
    #OUTPUT REAL IL1  {CDCTR(1,$#[1])}
    #OUTPUT REAL IL2  {CDCTR(2,$#[1])}
   #ELSE
    #IF Type1==0
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])} {CDCTR(1,$#[2])} {CDCTR(1,$#[3])}
    #ELSEIF Type1==1
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])-CDCTR(1,$#[3])} {CDCTR(1,$#[2])-CDCTR(1,$#[1])} {CDCTR(1,$#[3])-CDCTR(1,$#[2])}
    #ELSE
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])-CDCTR(1,$#[2])} {CDCTR(1,$#[2])-CDCTR(1,$#[3])} {CDCTR(1,$#[3])-CDCTR(1,$#[1])}
    #ENDIF

    #IF PHSHFT==0
     #IF Type2==0
      #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])} {CDCTR(2,$#[2])} {CDCTR(2,$#[3])}
     #ELSEIF Type2==1
      #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])-CDCTR(2,$#[3])} {CDCTR(2,$#[2])-CDCTR(2,$#[1])} {CDCTR(2,$#[3])-CDCTR(2,$#[2])}
     #ELSE
      #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])-CDCTR(2,$#[2])} {CDCTR(2,$#[2])-CDCTR(2,$#[3])} {CDCTR(2,$#[3])-CDCTR(2,$#[1])}
     #ENDIF
    #ELSE
      #OUTPUT REAL IL2 3 {-CDCTR(2,$#[4])} {-CDCTR(2,$#[5])} {-CDCTR(2,$#[6])}
    #ENDIF

   #ENDIF
#ELSE
   #IF View==2
    #OUTPUT REAL IL1  {0.0}
    #OUTPUT REAL IL2  {0.0}
   #ELSE
    #OUTPUT REAL IL1 3  {0.0} {0.0} {0.0}
    #OUTPUT REAL IL2 3  {0.0} {0.0} {0.0}
   #ENDIF
#ENDIF

"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Transformers"
   Branch = "\
#IF Enable==1


#IF PHSHFT==0
  #IF (((ABS(Rw)>0)&&(V5Format==0))||((Xl<0)&&(NegXCap==1)))
   #IF View==0
    $A11  $A1  $Rw1D 0.0 $Cw1
    $B11  $B1  $Rw1D 0.0 $Cw1
    $C11  $C1  $Rw1D 0.0 $Cw1
    $A22  $A2  $Rw2D 0.0 $Cw2
    $B22  $B2  $Rw2D 0.0 $Cw2
    $C22  $C2  $Rw2D 0.0 $Cw2
   #ELSEIF View==1
    $N11(1)  $N1(1)  $Rw1D 0.0 $Cw1
    $N11(2)  $N1(2)  $Rw1D 0.0 $Cw1
    $N11(3)  $N1(3)  $Rw1D 0.0 $Cw1
    $N22(1)  $N2(1)  $Rw2D 0.0 $Cw2
    $N22(2)  $N2(2)  $Rw2D 0.0 $Cw2
    $N22(3)  $N2(3)  $Rw2D 0.0 $Cw2
   #ELSE
    $A11  $A1  $Rw1D 0.0 $Cw1
    $A22  $A2  $Rw2D 0.0 $Cw2
   #ENDIF
  #ENDIF
#ELSE
  #IF ((ABS(Rw)>0)&&(V5Format==0))
   #IF View==0
    $A11  $A1  $Rw1D 0.0 $Cw1
    $B11  $B1  $Rw1D 0.0 $Cw1
    $C11  $C1  $Rw1D 0.0 $Cw1
    $A22  $A2  $Rw2D 0.0 $Cw2
    $B22  $B2  $Rw2D 0.0 $Cw2
    $C22  $C2  $Rw2D 0.0 $Cw2
   #ELSEIF View==1
    $N11(1)  $N1(1)  $Rw1D 0.0 $Cw1
    $N11(2)  $N1(2)  $Rw1D 0.0 $Cw1
    $N11(3)  $N1(3)  $Rw1D 0.0 $Cw1
    $N22(1)  $N2(1)  $Rw2D 0.0 $Cw2
    $N22(2)  $N2(2)  $Rw2D 0.0 $Cw2
    $N22(3)  $N2(3)  $Rw2D 0.0 $Cw2
   #ELSE
    BPH = $A11  $A1 SOURCE $Rw1D 0.0 $Cw1
    $A22  $A2  $Rw2D 0.0 $Cw2
   #ENDIF
  #ELSE
   #IF View==2
      BPH = $A11  $A1 SOURCE
   #ENDIF
  #ENDIF


#ENDIF



#IF CShunt1>0
 #IF View==0
   $A11 $Ground     0.0 0.0 $CShunt1
   $A22 $Ground     0.0 0.0 $CShunt2
   $B11 $Ground     0.0 0.0 $CShunt1
   $B22 $Ground     0.0 0.0 $CShunt2
   $C11 $Ground     0.0 0.0 $CShunt1
   $C22 $Ground     0.0 0.0 $CShunt2
 #ELSEIF View==1
   $N11(1) $Ground     0.0 0.0 $CShunt1
   $N22(1) $Ground     0.0 0.0 $CShunt2
   $N11(2) $Ground     0.0 0.0 $CShunt1
   $N22(2) $Ground     0.0 0.0 $CShunt2
   $N11(3) $Ground     0.0 0.0 $CShunt1
   $N22(3) $Ground     0.0 0.0 $CShunt2
 #ELSE
   $A11 $Ground     0.0 0.0 $CShunt1
   $A22 $Ground     0.0 0.0 $CShunt2
 #ENDIF
#ELSE
   #IF LShunt1>0
    #IF View==0
      $A11 $Ground     0.0 $LShunt1
      $A22 $Ground     0.0 $LShunt2
      $B11 $Ground     0.0 $LShunt1
      $B22 $Ground     0.0 $LShunt2
      $C11 $Ground     0.0 $LShunt1
      $C22 $Ground     0.0 $LShunt2
    #ELSEIF View==1
      $N11(1) $Ground     0.0 $LShunt1
      $N22(1) $Ground     0.0 $LShunt2
      $N11(2) $Ground     0.0 $LShunt1
      $N22(2) $Ground     0.0 $LShunt2
      $N11(3) $Ground     0.0 $LShunt1
      $N22(3) $Ground     0.0 $LShunt2
    #ELSE
      $A11 $Ground     0.0 $LShunt1
      $A22 $Ground     0.0 $LShunt2
    #ENDIF
   #ENDIF
#ENDIF
#IF RShuntI>0
 #IF View==0
   $A11 $Ground     $RShuntI
   $B11 $Ground     $RShuntI
   $C11 $Ground     $RShuntI
 #ELSEIF View==1
   $N11(1) $Ground     $RShuntI
   $N11(2) $Ground     $RShuntI
   $N11(3) $Ground     $RShuntI
 #ELSE
   $A11 $Ground     $RShuntI
 #ENDIF
#ENDIF
#IF CShuntI>0
 #IF View==0
   $A11 $Ground     0.0 0.0 $CShuntI
   $B11 $Ground     0.0 0.0 $CShuntI
   $C11 $Ground     0.0 0.0 $CShuntI
 #ELSEIF View==1
   $N11(1) $Ground     0.0 0.0 $CShuntI
   $N11(2) $Ground     0.0 0.0 $CShuntI
   $N11(3) $Ground     0.0 0.0 $CShuntI
 #ELSE
   $A11 $Ground     0.0 0.0 $CShuntI
 #ENDIF
#ELSE
   #IF LShuntI>0
    #IF View==0
      $A11 $Ground     0.0 $LShuntI
      $B11 $Ground     0.0 $LShuntI
      $C11 $Ground     0.0 $LShuntI
    #ELSEIF View==1
      $N11(1) $Ground     0.0 $LShuntI
      $N11(2) $Ground     0.0 $LShuntI
      $N11(3) $Ground     0.0 $LShuntI
    #ELSE
      $A11 $Ground     0.0 $LShuntI
    #ENDIF
   #ENDIF
#ENDIF
#IF RShuntJ>0
 #IF View==0
   $A22 $Ground     $RShuntJ
   $B22 $Ground     $RShuntJ
   $C22 $Ground     $RShuntJ
 #ELSEIF View==1
   $N22(1) $Ground     $RShuntJ
   $N22(2) $Ground     $RShuntJ
   $N22(3) $Ground     $RShuntJ
 #ELSE
   $A22 $Ground     $RShuntJ
 #ENDIF
#ENDIF
#IF CShuntJ>0
 #IF View==0
   $A22 $Ground     0.0 0.0 $CShuntJ
   $B22 $Ground     0.0 0.0 $CShuntJ
   $C22 $Ground     0.0 0.0 $CShuntJ
 #ELSEIF View==1
   $N22(1) $Ground     0.0 0.0 $CShuntJ
   $N22(2) $Ground     0.0 0.0 $CShuntJ
   $N22(3) $Ground     0.0 0.0 $CShuntJ
 #ELSE
   $A22 $Ground     0.0 0.0 $CShuntJ
 #ENDIF
#ELSE
   #IF LShuntJ>0
    #IF View==0
      $A22 $Ground     0.0 $LShuntJ
      $B22 $Ground     0.0 $LShuntJ
      $C22 $Ground     0.0 $LShuntJ
    #ELSEIF View==1
      $N22(1) $Ground     0.0 $LShuntJ
      $N22(2) $Ground     0.0 $LShuntJ
      $N22(3) $Ground     0.0 $LShuntJ
    #ELSE
      $A22 $Ground     0.0 $LShuntJ
    #ENDIF
   #ENDIF
#ENDIF
#ENDIF
"
   Checks = "\
#IF Enable==1
WARNING -ve R,X Encountered - Numerical instabilities are possible! : Rw>=0 && (Xl>=0 || NegXCap==1)
ERROR   Phase Shifter Angles must be <80 and >-80 degrees! : !((PSANG>80) || (PSANG<(-80)) && (PHSHFT==1) )
ERROR   Phase Shifter Angle cannot be 0.0 degrees! (use a wye-wye transformer) : !((PSANG==0.0)&&(PHSHFT==1))
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase Transformer Model

Features:
     - Transformer modelled with linear coupled inductances
     - Winding resistance modelled as resistors in series at winding terminals
     - Saturation implemented as a delayed current injection (TSAT21)
     - Phase Shifter Option:
          - Phase Shifter Angle can be changed dynamically during the run
          - Varying frequency supported

:A11
Terminal 1 Single Phase Electrical Connection
:A22
Terminal 2 Single Phase Electrical Connection
"
   }
  }
 Component("Electranix_Pi")
  {
  Desc = "PSSE Compatible PI Model"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Text("Name",5,4,269,12,2)
     {
     Desc = "T-LINE NAME"
     Def = "Line1"
     Len = 21
     }
    Input("MVA2",5,20,269,12,2)
     {
     Desc = "Rated MVA (3 Phase)"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 21
     Min = 0
     }
    Input("F",5,36,269,12,2)
     {
     Desc = "Line Rated Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 21
     Min = 0
     }
    Input("VR2",5,52,269,12,2)
     {
     Desc = "Rated Voltage (kV,L-L,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 21
     Min = 0
     }
    Input("RPUP2",5,68,269,12,2)
     {
     Desc = "R - +ve Seq. Resistance (pu)"
     Def = ".00336786"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     Cond = "Ideal==0"
     }
    Input("XLPUP2",5,84,269,12,2)
     {
     Desc = "X - +ve Seq. Inductive Reactance (pu)"
     Def = ".0593346"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     Cond = "Ideal==0"
     }
    Input("BPUP2",5,100,269,12,2)
     {
     Desc = "B - +ve Seq. Capacitive Susceptance (pu)"
     Def = "0.193387"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     }
    Input("len",5,116,269,12,2)
     {
     Desc = "Line Length (used only for display)"
     Def = "100"
     Data = Real
     Len = 21
     Min = 0
     Cond = "Ideal==0"
     }
    Choice("Enable",5,132,114,44,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("View",123,132,151,56,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    Choice("Ideal",5,192,114,40,2)
     {
     Style = 1
     Desc = "Is this an Ideal Branch (R=0.0)?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("ZeroSeq",123,192,151,40,2)
     {
     Style = 1
     Desc = "Enter and use Zero Sequence Data?"
     Def = "0"
     Len = 15
     *0 = "No (Z0=Z+)"
     *1 = "Yes"
     }
    Input("RPUZ2",5,240,269,12,2)
     {
     Desc = "R0 - Zero Seq. Resistance (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     Cond = "(Ideal==0) && (ZeroSeq==1)"
     }
    Input("XLPUZ2",5,256,269,12,2)
     {
     Desc = "X0 - Zero Seq. Inductive Reactance (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     Cond = "(Ideal==0) && (ZeroSeq==1)"
     }
    Input("BPUZ2",5,272,269,12,2)
     {
     Desc = "B0 - Zero Seq. Capacitive Susceptance (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 21
     Min = 0
     Cond = "(ZeroSeq==1)"
     }
    }
   Category("Shunt Admittances")
    {
    Input("GI",5,4,269,12,2)
     {
     Desc = "GI - Real Shunt Admittance on bus I (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BI",5,20,269,12,2)
     {
     Desc = "BI - Imag. Shunt Admittance on bus I (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("GJ",5,36,269,12,2)
     {
     Desc = "GJ - Real Shunt Admittance on bus J (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BJ",5,52,269,12,2)
     {
     Desc = "BJ - Imag. Shunt Admittance on bus J (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("GI0",5,76,269,12,2)
     {
     Desc = "GI0 - Zero Seq Real Shunt Admittance on bus I (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Cond = "ZeroSeq==1"
     }
    Input("BI0",5,92,269,12,2)
     {
     Desc = "BI0 - Zero Seq Imag. Shunt Admittance on bus I (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Cond = "ZeroSeq==1"
     }
    Input("GJ0",5,108,269,12,2)
     {
     Desc = "GJ0 - Zero Seq Real Shunt Admittance on bus J (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Cond = "ZeroSeq==1"
     }
    Input("BJ0",9,124,265,12,2)
     {
     Desc = "BJ0 - Zero Seq Imag. Shunt Admittance on bus J (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Cond = "ZeroSeq==1"
     }
    }
   }

  Nodes = 
   {
   Electrical("Ground",0,0)
    {
    Cond = "Enable==1"
    Type = Ground
    }
   Electrical("C1",-54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("C2",54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A2",54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A2",54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("B2",54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N2",54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("A1",-54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("A1",-54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("B1",-54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N1",-54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-46,-10,46,7)
   Cond = "Ideal==1"
   Text(-1,-1,"Ideal (R=0)")
   Cond = "Ideal==0 && len>0.0"
   Text(0,-12,"<-- %len -->")
   Font(,,Right)
   Cond = "Ideal==0"
   Text(18,-1,"T-Line")
   Font(,,Centre)
   Cond = "true"
   Text(0,16,"$Name")
   Text(-42,-1,"E")
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Line(-42,7,-42,0)
   Line(-42,22,-42,19)
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Line(42,7,42,0)
   Line(42,22,42,19)
   Brush(Hollow)
   Rectangle(39,7,45,19)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Text(-42,18,"I")
   Rectangle(-45,7,-39,19)
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Text(42,18,"J")
   Cond = "View==0"
   Line(-54,-18,-46,0)
   Line(-46,0,-54,18)
   Line(54,-18,46,0)
   Line(46,0,54,18)
   Text(-48,-16,"A")
   Text(48,-16,"A")
   Cond = "View!=1"
   Line(-54,0,54,0)
   Pen(,,0.6)
   Cond = "View==1"
   Line(-54,0,54,0)
   }

  Section(EMTDC)
   {
   Computations = "\
REAL   W       = 2*PI*F
REAL   ZBASE   = (VR2*VR2)/MVA2
REAL   YBASE   = MVA2/(VR2*VR2)
REAL   RSeries = RPUP2*ZBASE
REAL   LSeries = XLPUP2>0 ? XLPUP2*ZBASE/W            : 0.0
REAL   CSeries = XLPUP2<0 ? 1.0e6/(W*(-XLPUP2)*ZBASE) : 0.0
REAL   CShunt  = BPUP2>0  ? (1.0e6/2.0)*BPUP2/(ZBASE*W)   : 0.0
REAL   LShunt  = BPUP2<0  ? 2.0*(ZBASE/(-BPUP2))/W        : 0.0
REAL   tau     = sqrt(abs(XLPUP2)*abs(BPUP2))/W
REAL   c       = 2.997925e8
REAL   lenr    = tau*c
INTEGER leni   = lenr
REAL    len1   = leni/1000.0
REAL   RShuntI  = ((GI>1.0e-10)||(GI<(-1.0e-10)))  ? 1.0/(GI*YBASE) : 0.0
REAL   CShuntI  = BI>0  ? (1.0e6)*BI/(ZBASE*W)   : 0.0
REAL   LShuntI  = BI<0  ? (ZBASE/(-BI))/W        : 0.0
REAL   RShuntJ  = ((GJ>1.0e-10)||(GJ<(-1.0e-10)))  ? 1.0/(GJ*YBASE) : 0.0
REAL   CShuntJ  = BJ>0  ? (1.0e6)*BJ/(ZBASE*W)   : 0.0
REAL   LShuntJ  = BJ<0  ? (ZBASE/(-BJ))/W        : 0.0
REAL   RSeries0 = ZeroSeq==1 ? RPUZ2*ZBASE : 0.0
REAL   LSeries0 = ZeroSeq==1 ? XLPUZ2*ZBASE/W : 0.0
REAL   CShunt0  = ZeroSeq==1 ? (1.0e6/2.0)*BPUZ2/(ZBASE*W) : 0.0
REAL   Rm1  = (RSeries0-RSeries)/3
REAL   R    = (2.0*RSeries+RSeries0)/3
REAL   Lm1  = (LSeries0-LSeries)/3
REAL   L    = (2.0*LSeries+LSeries0)/3
REAL   Cm1  = CShunt0
REAL   C1x   = -(CShunt0-CShunt)/3
REAL   Rm = (ABS(Rm1) <= 1.0E-20) ? 0.0 : Rm1
REAL   Lm = (ABS(Lm1) <= 1.0E-20) ? 0.0 : Lm1
REAL   Cm = (ABS(Cm1) <= 1.0E-20) ? 0.0 : Cm1
REAL   Cxx  = (ABS(C1x)  <= 1.0E-20) ? 0.0 : C1x"
   Checks = "\
#IF Enable==1
WARNING -ve R Encountered - Numerical instabilities are possible! : RSeries>=0
ERROR Zero sequence data entry for capacitive series reactances not supported! : !((ZeroSeq==1)&&(XLPUP2<0.0))
ERROR Zero sequence data entry for single phase circuits not supported! : !((ZeroSeq==1)&&(View==2))
ERROR Zero sequence data entry for ideal circuits not supported! : !((ZeroSeq==1)&&(Ideal==1))
ERROR Zero sequence data entry for shunt gi,gj,bi,bj not yet supported! : !((ZeroSeq==1)&&((gi0>0.0)||(bi0>0.0)||(gj0>0.0)||(bj0>0.0)))
WARNING Zero sequence R should be larger than the positive sequence R! : !((ZeroSeq==1)&&(RPUZ2<RPUP2))
WARNING Zero sequence X should be larger than the positive sequence X! : !((ZeroSeq==1)&&(XLPUZ2<XLPUP2))
WARNING Zero sequence B should be smaller than the positive sequence B! : !((ZeroSeq==1)&&(BPUZ2>BPUP2))
#ENDIF"
   Branch = "\
#IF Enable==1
#IF ZeroSeq==0
 #IF CShunt>0
  #IF View==2
   $A1 $Ground     0.0 0.0 $CShunt
   $A2 $Ground     0.0 0.0 $CShunt
  #ELSEIF View==1
   $N1(1) $Ground     0.0 0.0 $CShunt
   $N1(2) $Ground     0.0 0.0 $CShunt
   $N1(3) $Ground     0.0 0.0 $CShunt
   $N2(1) $Ground     0.0 0.0 $CShunt
   $N2(2) $Ground     0.0 0.0 $CShunt
   $N2(3) $Ground     0.0 0.0 $CShunt
  #ELSE
   $A1 $Ground     0.0 0.0 $CShunt
   $B1 $Ground     0.0 0.0 $CShunt
   $C1 $Ground     0.0 0.0 $CShunt
   $A2 $Ground     0.0 0.0 $CShunt
   $B2 $Ground     0.0 0.0 $CShunt
   $C2 $Ground     0.0 0.0 $CShunt
  #ENDIF
 #ELSEIF LShunt>0
   #IF View==2
    $A1 $Ground     0.0 $LShunt
    $A2 $Ground     0.0 $LShunt
   #ELSEIF View==1
    $N1(1) $Ground     0.0 $LShunt
    $N1(2) $Ground     0.0 $LShunt
    $N1(3) $Ground     0.0 $LShunt
    $N2(1) $Ground     0.0 $LShunt
    $N2(2) $Ground     0.0 $LShunt
    $N2(3) $Ground     0.0 $LShunt
   #ELSE
    $A1 $Ground     0.0 $LShunt
    $B1 $Ground     0.0 $LShunt
    $C1 $Ground     0.0 $LShunt
    $A2 $Ground     0.0 $LShunt
    $B2 $Ground     0.0 $LShunt
    $C2 $Ground     0.0 $LShunt
   #ENDIF
 #ELSE
  #IF View==2
   $A1 $Ground     1.0E8
   $A2 $Ground     1.0E8
  #ELSEIF View==1
   $N1(1) $Ground     1.0E8
   $N1(2) $Ground     1.0E8
   $N1(3) $Ground     1.0E8
   $N2(1) $Ground     1.0E8
   $N2(2) $Ground     1.0E8
   $N2(3) $Ground     1.0E8
  #ELSE
   $A1 $Ground     1.0E8
   $B1 $Ground     1.0E8
   $C1 $Ground     1.0E8
   $A2 $Ground     1.0E8
   $B2 $Ground     1.0E8
   $C2 $Ground     1.0E8
  #ENDIF
 #ENDIF
 #IF Ideal==0
  #IF View==2
   $A1 $A2   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ELSEIF View==1
   $N1(1) $N2(1)   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $N1(2) $N2(2)   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $N1(3) $N2(3)   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ELSE
   $A1 $A2   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $B1 $B2   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $C1 $C2   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ENDIF
 #ELSE
  #IF View==2
   $A1 $A2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
  #ELSEIF View==1
   $N1(1) $N2(1)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $N1(2) $N2(2)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $N1(3) $N2(3)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
  #ELSE
   $A1 $A2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $B1 $B2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $C1 $C2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
  #ENDIF
 #ENDIF





#ELSE




  #IF View==2
   #IF Cm>0
   $A1 $Ground     0.0 0.0 $Cm
   $A2 $Ground     0.0 0.0 $Cm
   #ENDIF
  #ELSEIF View==1
   #IF Cm>0
   $N1(1) $Ground     0.0 0.0 $Cm
   $N1(2) $Ground     0.0 0.0 $Cm
   $N1(3) $Ground     0.0 0.0 $Cm
   $N2(1) $Ground     0.0 0.0 $Cm
   $N2(2) $Ground     0.0 0.0 $Cm
   $N2(3) $Ground     0.0 0.0 $Cm
   #ENDIF
   #IF ABS(Cxx)>1.0E-20
    $N1(1) $N1(2)     0 0 $Cxx
    $N1(2) $N1(3)     0 0 $Cxx
    $N1(3) $N1(1)     0 0 $Cxx
    $N2(1) $N2(2)     0 0 $Cxx
    $N2(2) $N2(3)     0 0 $Cxx
    $N2(3) $N2(1)     0 0 $Cxx
   #ENDIF
  #ELSE
   #IF Cm>0
   $A1 $Ground     0.0 0.0 $Cm
   $B1 $Ground     0.0 0.0 $Cm
   $C1 $Ground     0.0 0.0 $Cm
   $A2 $Ground     0.0 0.0 $Cm
   $B2 $Ground     0.0 0.0 $Cm
   $C2 $Ground     0.0 0.0 $Cm
   #ENDIF
   #IF ABS(Cxx)>1.0E-20
    $A1 $B1     0 0 $Cxx
    $B1 $C1     0 0 $Cxx
    $C1 $A1     0 0 $Cxx
    $A2 $B2     0 0 $Cxx
    $B2 $C2     0 0 $Cxx
    $C2 $A2     0 0 $Cxx
   #ENDIF
  #ENDIF


#ENDIF

 #IF ((RShuntI>1.0e-10)||(RShuntI<(-1.0e-10)))
  #IF View==2
   $A1 $Ground     $RShuntI
  #ELSEIF View==1
   $N1(1) $Ground     $RShuntI
   $N1(2) $Ground     $RShuntI
   $N1(3) $Ground     $RShuntI
  #ELSE
   $A1 $Ground     $RShuntI
   $B1 $Ground     $RShuntI
   $C1 $Ground     $RShuntI
  #ENDIF
 #ENDIF
 #IF CShuntI>0
  #IF View==2
   $A1 $Ground     0.0 0.0 $CShuntI
  #ELSEIF View==1
   $N1(1) $Ground     0.0 0.0 $CShuntI
   $N1(2) $Ground     0.0 0.0 $CShuntI
   $N1(3) $Ground     0.0 0.0 $CShuntI
  #ELSE
   $A1 $Ground     0.0 0.0 $CShuntI
   $B1 $Ground     0.0 0.0 $CShuntI
   $C1 $Ground     0.0 0.0 $CShuntI
  #ENDIF
 #ELSE
   #IF LShuntI>0
    #IF View==2
     $A1 $Ground     0.0 $LShuntI
    #ELSEIF View==1
     $N1(1) $Ground     0.0 $LShuntI
     $N1(2) $Ground     0.0 $LShuntI
     $N1(3) $Ground     0.0 $LShuntI
    #ELSE
     $A1 $Ground     0.0 $LShuntI
     $B1 $Ground     0.0 $LShuntI
     $C1 $Ground     0.0 $LShuntI
    #ENDIF
   #ENDIF
 #ENDIF



 #IF ((RShuntJ>1.0e-10)||(RShuntJ<(-1.0e-10)))
  #IF View==2
   $A2 $Ground     $RShuntJ
  #ELSEIF View==1
   $N2(1) $Ground     $RShuntJ
   $N2(2) $Ground     $RShuntJ
   $N2(3) $Ground     $RShuntJ
  #ELSE
   $A2 $Ground     $RShuntJ
   $B2 $Ground     $RShuntJ
   $C2 $Ground     $RShuntJ
  #ENDIF
 #ENDIF
 #IF CShuntJ>0
  #IF View==2
   $A2 $Ground     0.0 0.0 $CShuntJ
  #ELSEIF View==1
   $N2(1) $Ground     0.0 0.0 $CShuntJ
   $N2(2) $Ground     0.0 0.0 $CShuntJ
   $N2(3) $Ground     0.0 0.0 $CShuntJ
  #ELSE
   $A2 $Ground     0.0 0.0 $CShuntJ
   $B2 $Ground     0.0 0.0 $CShuntJ
   $C2 $Ground     0.0 0.0 $CShuntJ
  #ENDIF
 #ELSE
   #IF LShuntJ>0
    #IF View==2
     $A2 $Ground     0.0 $LShuntJ
    #ELSEIF View==1
     $N2(1) $Ground     0.0 $LShuntJ
     $N2(2) $Ground     0.0 $LShuntJ
     $N2(3) $Ground     0.0 $LShuntJ
    #ELSE
     $A2 $Ground     0.0 $LShuntJ
     $B2 $Ground     0.0 $LShuntJ
     $C2 $Ground     0.0 $LShuntJ
    #ENDIF
   #ENDIF
 #ENDIF


#ENDIF"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Transmission_Lines"
   Matrix-fill = "\
#IF Enable==1
#IF ZeroSeq==1
  #IF View==0
  $A1 $A2 $B1 $B2 $C1 $C2 
  #ELSE
  $N1 $N2
  #ENDIF
#ELSE
 #IF View==2
  $A1 $A2
 #ELSEIF View==1
  $N1(1) $N2(1)
  $N1(2) $N2(2)
  $N1(3) $N2(3)
 #ELSE
  $A1 $A2
  $B1 $B2
  $C1 $C2
 #ENDIF
#ENDIF
#ENDIF"
   TRANSFORMERS = "\
#IF Enable==1 && ZeroSeq==1
#TRANSFORMERS 1
#WINDINGS 3
C PI Section Coupled RL Data $Name
3 /
#IF View==0
$A1 $A2     $R  $L /
$B1 $B2     $Rm $Lm  $R  $L /
$C1 $C2     $Rm $Lm  $Rm $Lm  $R  $L /
#ELSE
$N1(1) $N2(1)     $R  $L /
$N1(2) $N2(2)     $Rm $Lm  $R  $L /
$N1(3) $N2(3)     $Rm $Lm  $Rm $Lm  $R  $L /
#ENDIF
#ENDIF"
   DSDYN = "\
#IF (Enable==1)
      CALL ETRAN_COM_SET_YEQ(0,0,0,$SS,0,\"$Name\",$RPUP2,$XLPUP2,$MVA2,$VR2)
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase PI Line Section

Generates PI Model for Short Transmission Lines or Cables.
     - R and L added as a series branch
     - If series X is -ve, a series C is used
     - C/2 added as a shunt branch at each end (only if B is entered)
     - It is assumed R,X and B have already been corrected for \"long line\" effects
     - The Bergeron travelling wave model should be used for \"long\" lines
       (where the travel time is > 1 time step)
:A1
Single Phase Electrical Connection
:A2
Single Phase Electrical Connection"
   }
  }
 Component("Electranix_Gen")
  {
  Desc = "PSSE Compatible Generator"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("Name",6,0,230,12,2)
     {
     Desc = "Generator Name"
     Def = "Gen1"
     Len = 15
     }
    Input("MVA",6,14,230,12,2)
     {
     Desc = "Machine MVA Base (3 Phase)"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     }
    Input("F",6,28,230,12,2)
     {
     Desc = "Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VBASE",6,42,230,12,2)
     {
     Desc = "Rated Voltage (kV,L-L,RMS)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Choice("Imped",6,54,152,44,2)
     {
     Style = 1
     Desc = "Generator Impedance Type:"
     Def = "0"
     Len = 15
     *0 = "Infinite bus (zero impedance)"
     *1 = "Series RL Source Impedance"
     }
    Input("RPU",6,98,230,12,2)
     {
     Desc = "Series R (pu on machine base mva)"
     Def = ".01"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "Imped==1"
     }
    Input("XPU",6,112,230,12,2)
     {
     Desc = "Series X (pu on machine base mva, +ve for L)"
     Def = ".01"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "Imped==1"
     }
    Choice("VType",6,128,192,42,2)
     {
     Style = 1
     Desc = "Location where Voltage Mag & Phase are Entered:"
     Def = "0"
     Len = 15
     Cond = "Imped"
     *0 = "At Terminal (P,Q are used to calculate source volts)"
     *1 = "At Source Behind Impedance"
     }
    Input("TInit",6,174,230,12,2)
     {
     Desc = "Source Initializaton Time"
     Def = ".05"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0
     }
    Choice("Enable",4,194,82,42,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("View",94,194,156,62,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    Choice("ZeroSeq",5,260,142,44,2)
     {
     Style = 1
     Desc = "Enter and use Zero Sequence Data?"
     Def = "0"
     Len = 15
     Cond = "Imped==1"
     *0 = "No (Z0=Z+)"
     *1 = "Yes"
     }
    Input("RPU0",6,305,230,12,2)
     {
     Desc = "Zero Seq Series R (pu on mac base mva)"
     Def = ".0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "(Imped==1)&&(ZeroSeq==1)"
     }
    Input("XPU0",6,319,230,12,2)
     {
     Desc = "Zero Seq Series X (pu on mac base mva, +ve for L)"
     Def = ".0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "(Imped==1)&&(ZeroSeq==1)"
     }
    Choice("Dynamic",5,340,261,44,2)
     {
     Style = 1
     Desc = "Is this a dynamic Interface to PSS/E (requires E-TRAN Plus runtime license)?"
     Def = "0"
     Len = 15
     *0 = "No (Constant Source)"
     *1 = "Yes (Dynamic Source)"
     }
    Text("CUR",5,392,229,12,2)
     {
     Desc = "Name for Source Currents (kA,out of source)"
     Len = 15
     }
    }
   Category("Initial Conditions and Outputs")
    {
    Cond = "Dynamic!=1"
    Input("V",5,4,229,12,6)
     {
     Desc = "Voltage Magnitude (pu)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("Phase",5,20,229,12,6)
     {
     Desc = "Voltage Phase (Deg)"
     Def = "0.0"
     Data = Real
     Unit = "°"
     Len = 15
     Min = -360
     Max = 360
     }
    Input("POUT",5,36,229,12,6)
     {
     Desc = "Initial Real Power Out (MW,3 Phase):"
     Def = "0.0"
     Data = Real
     Unit = "MW"
     Len = 15
     Min = -1e+010
     Max = 1e+010
     }
    Input("QOUT",5,52,229,12,6)
     {
     Desc = "Initial Reactive Power Out (MVAR,3 Phase,+L):"
     Def = "0.0"
     Data = Real
     Unit = "MVAR"
     Len = 15
     Min = -1e+010
     Max = 1e+010
     }
    }
   Category("Dynamic Interface to PSS/E")
    {
    Cond = "Dynamic==1"
    Input("Port",5,8,229,12,2)
     {
     Desc = "TCP/IP Port of other end (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    Text("Vterm",5,24,229,12,2)
     {
     Desc = "Name for Interface Terminal Volts (from PSSE)"
     Len = 15
     }
    Text("ANGterm",5,40,229,12,2)
     {
     Desc = "Name for Interface Terminal Angle (from PSSE)"
     Len = 15
     }
    Text("POutI",5,56,229,12,2)
     {
     Desc = "Name for Interface P (from PSCAD)"
     Len = 15
     }
    Text("QOutI",5,72,229,12,2)
     {
     Desc = "Name for Interface Q (from PSCAD)"
     Len = 15
     }
    Text("ConvergeError",5,88,229,12,2)
     {
     Desc = "Name for Convergence Error (from PSSE)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("G",72,0)
    {
    Cond = ""
    Type = Ground
    }
   Electrical("NC",0,18)
    {
    Cond = "(View==0)"
    }
   Electrical("NA",0,-18)
    {
    Cond = "(View==0)"
    }
   Electrical("NA",0,0)
    {
    Cond = "(View==2)"
    }
   Electrical("N",0,0)
    {
    Cond = "(View==1)"
    Dim  = [3]
    }
   Electrical("NB",0,0)
    {
    Cond = "(View==0)"
    }
   Electrical("NG",54,0)
    {
    Cond = "(Imped==1)&&(ZeroSeq==1)&&(Enable==1)"
    }
   Input("NINF",18,0)
    {
    Cond = "(Enable==1)&&(Dynamic==1)"
    Type = Integer
    }
   Output("NOUTF",18,0)
    {
    Cond = "(Enable==1)&&(Dynamic==1)"
    Type = Integer
    }
   Input("NINI",36,0)
    {
    Cond = "(Enable==1)&&(Dynamic==1)"
    Type = Integer
    }
   Output("NOUTI",36,0)
    {
    Cond = "(Enable==1)&&(Dynamic==1)"
    Type = Integer
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "(Enable==0)&&(View==0)"
   Rectangle(-4,-22,90,22)
   Cond = "(Enable==0)&&(View!=0)"
   Rectangle(-4,-16,90,15)
   Pen(,,0.6)
   Cond = "(Imped==0)&&(View==1)"
   Line(0,0,63,0)
   Pen(,,0.2)
   Cond = "(Imped==0)&&(View!=1)"
   Line(0,0,63,0)
   Cond = "(View==0)&&(Imped==0)"
   Line(0,18,63,18)
   Line(0,-18,63,-18)
   Font(,Medium)
   Cond = "true"
   Text(73,6,"~")
   Cond = "View==0"
   Line(33,-18,39,-21)
   Line(39,-15,33,-18)
   Line(33,18,39,15)
   Line(39,21,33,18)
   Line(63,-18,63,18)
   Font(,Small)
   Cond = "true"
   Text(58,-6,"E")
   Brush(Hollow)
   Cond = "(View==0)&&(Imped==1)"
   Rectangle(42,-21,57,-15)
   Rectangle(42,15,57,21)
   Cond = "true"
   Line(39,3,33,0)
   Cond = "(View==0)&&(Imped==1)"
   Line(57,-18,62,-18)
   Line(57,18,62,18)
   Line(0,18,42,18)
   Line(0,-18,42,-18)
   Cond = "View==0"
   Text(6,-19,"A")
   Cond = "(Imped==1)&&(View!=1)"
   Line(0,0,42,0)
   Line(57,0,62,0)
   Cond = "true"
   Line(33,0,39,-3)
   Cond = "(Imped==1)&&(View!=1)"
   Rectangle(42,-3,57,3)
   Pen(,,0.6)
   Cond = "(Imped==1)&&(View==1)"
   Rectangle(42,-3,57,3)
   Font(,,Left)
   Cond = "true"
   Text(0,-3,"$POUT")
   Pen(,,0.2)
   Cond = "View!=1"
   Ellipse(63,-10,84,10)
   Pen(,,0.6)
   Cond = "(Imped==1)&&(View==1)"
   Line(57,0,62,0)
   Cond = "View==1"
   Ellipse(63,-10,84,10)
   Cond = "true"
   Text(-1,12,"$QOUT")
   Cond = "(Imped==1)&&(View==1)"
   Line(0,0,42,0)
   Cond = "true"
   Text(66,19,"$Name")
   Cond = "Dynamic==1"
   Text(85,3,"$Port")
   }

  Section(EMTDC)
   {
   Computations = "\
REAL   w       = 2*pi*F
REAL   ZBASE   = VBASE*VBASE/MVA
REAL   R       = RPU*ZBASE
REAL   L       = XPU>0 ? XPU*ZBASE/w            : 0.0
REAL   C       = XPU<0 ? 1.0e6/(w*(-XPU)*ZBASE) : 0.0
REAL   R0      = ZeroSeq==1 ? RPU0*ZBASE : 0.0
REAL   L0      = ZeroSeq==1 ? XPU0>0 ? XPU0*ZBASE/w            : 0.0 : 0.0
REAL   C0      = ZeroSeq==1 ? XPU0<0 ? 1.0e6/(w*(-XPU0)*ZBASE) : 0.0 : 0.0
REAL   RN      = ZeroSeq==1 ? (R0-R)/3 : 0.0
REAL   LN      = ZeroSeq==1 ? (L0-L)/3 : 0.0
REAL   CN      = ZeroSeq==1 ? ABS(C0-C)>0 ? 3/(1/C0-1/C) : 0.0 : 0.0"
   Checks = "\
#IF (Enable==1 && Imped==1)
WARNING -ve R,L,C Encountered - Numerical instabilities are possible! : R>=0 && L>=0 && C>=0
#ENDIF"
   Branch = "\
#IF Enable==1
#IF ZeroSeq==0
 #IF Imped==1
  #IF View==2
     BA =  0  $NA     SOURCE   $R $L $C  /
  #ELSE
   #IF View==1
     BA =  0  $N(1)   SOURCE   $R $L $C  /
     BB =  0  $N(2)   SOURCE   $R $L $C  /
     BC =  0  $N(3)   SOURCE   $R $L $C  /
   #ELSE
     BA =  0  $NA     SOURCE   $R $L $C  /
     BB =  0  $NB     SOURCE   $R $L $C  /
     BC =  0  $NC     SOURCE   $R $L $C  /
   #ENDIF
  #ENDIF
 #ELSE
  #IF View==2
     BA =  0  $NA     SOURCE  0.0 0.0 0.0  /
  #ELSE
   #IF View==1
     BA =  0  $N(1)   SOURCE  0.0 0.0 0.0  /
     BB =  0  $N(2)   SOURCE  0.0 0.0 0.0  /
     BC =  0  $N(3)   SOURCE  0.0 0.0 0.0  /
   #ELSE
     BA =  0  $NA     SOURCE  0.0 0.0 0.0  /
     BB =  0  $NB     SOURCE  0.0 0.0 0.0  /
     BC =  0  $NC     SOURCE  0.0 0.0 0.0  /
   #ENDIF
  #ENDIF
 #ENDIF
#ELSE
 #IF Imped==1
  #IF View==2
     #IF ( (ABS(RN)>0)||(ABS(LN)>0)||(ABS(CN)>0) )
        BA =  $NG  $NA     SOURCE   $R $L $C  /
        BN =  $NG  0      $RN $LN $CN /
     #ELSE
        BA =  0  $NA     SOURCE   $R $L $C  /
        BN =  $NG  0      1.0E12 /
     #ENDIF
  #ELSE
   #IF View==1
     #IF ( (ABS(RN)>0)||(ABS(LN)>0)||(ABS(CN)>0) )
        BA =  $NG  $N(1)   SOURCE   $R $L $C  /
        BB =  $NG  $N(2)   SOURCE   $R $L $C  /
        BC =  $NG  $N(3)   SOURCE   $R $L $C  /
        BN =  $NG  0      $RN $LN $CN /
     #ELSE
        BA =  0  $N(1)   SOURCE   $R $L $C  /
        BB =  0  $N(2)   SOURCE   $R $L $C  /
        BC =  0  $N(3)   SOURCE   $R $L $C  /
        BN =  $NG  0      1.0E12 /
     #ENDIF
   #ELSE
     #IF ( (ABS(RN)>0)||(ABS(LN)>0)||(ABS(CN)>0) )
        BA =  $NG  $NA     SOURCE   $R $L $C  /
        BB =  $NG  $NB     SOURCE   $R $L $C  /
        BC =  $NG  $NC     SOURCE   $R $L $C  /
        BN =  $NG  0      $RN $LN $CN /
     #ELSE
        BA =  0  $NA     SOURCE   $R $L $C  /
        BB =  0  $NB     SOURCE   $R $L $C  /
        BC =  0  $NC     SOURCE   $R $L $C  /
        BN =  $NG  0      1.0E12 /
     #ENDIF
   #ENDIF
  #ENDIF
 #ELSE
  #IF View==2
     BA =  0  $NA     SOURCE  0.0 0.0 0.0  /
  #ELSE
   #IF View==1
     BA =  0  $N(1)   SOURCE  0.0 0.0 0.0  /
     BB =  0  $N(2)   SOURCE  0.0 0.0 0.0  /
     BC =  0  $N(3)   SOURCE  0.0 0.0 0.0  /
   #ELSE
     BA =  0  $NA     SOURCE  0.0 0.0 0.0  /
     BB =  0  $NB     SOURCE  0.0 0.0 0.0  /
     BC =  0  $NC     SOURCE  0.0 0.0 0.0  /
   #ENDIF
  #ENDIF
 #ENDIF
#ENDIF
#ELSE
  #IF View==2
     BA =  0  $NA     1.0E8  /
  #ELSE
   #IF View==1
     BA =  0  $N(1)   1.0E8  /
     BB =  0  $N(2)   1.0E8  /
     BC =  0  $N(3)   1.0E8  /
   #ELSE
     BA =  0  $NA     1.0E8  /
     BB =  0  $NB     1.0E8  /
     BC =  0  $NC     1.0E8  /
   #ENDIF
  #ENDIF
#ENDIF"
   Dsdyn = "\
#IF Enable==1
#IF Dynamic==0
#IF Imped==0
      CALL ETRAN_COM_SET_YEQ($BA,$BB,$BC,$SS,0,\"$Name\",0.0,0.0,$MVA,$VBASE)
#ELSE
      CALL ETRAN_COM_SET_YEQ($BA,$BB,$BC,$SS,0,\"$Name\",$RPU,$XPU,$MVA,$VBASE)
#ENDIF
#SUBROUTINE EMTDC_1PVSRC Single-Phase Source model
#SUBROUTINE Electranix_Calc_ESource -  Calculates Source E behind Z for a given V,delta
#IF View==2
 #STORAGE INTEGER:6
 #STORAGE LOGICAL:1
 #IF ((Imped==0)||((Imped==1)&&(VType==1)))
   #STORAGE REAL:8
 #ELSE
   #STORAGE REAL:10
 #ENDIF
#ELSE
 #STORAGE INTEGER:18
 #STORAGE LOGICAL:3
 #IF ((Imped==0)||((Imped==1)&&(VType==1)))
   #STORAGE REAL:24
 #ELSE
   #STORAGE REAL:30
 #ENDIF
#ENDIF
#LOCAL REAL E_MAG
#LOCAL REAL E_PHASE
!  $VBASE kV AC Source: $V pu, Freq: $F Hz, Phase: $Phase deg
#IF ((Imped==0)||((Imped==1)&&(VType==1)))
      E_MAG = $V*$VBASE*SQRT_2*SQRT_1BY3
      E_PHASE = $Phase*PI_BY180
      IF ( FIRSTSTEP ) WRITE(6,*) \"Warning - Infinite Bus used at Bus \",$BA,\" in SS \",$SS
#ELSE
! Compute Source Voltage and Phase based on Entered Terminal Voltage and Phase:
      IF ( TIMEZERO ) THEN
         CALL ELECTRANIX_CALC_ESOURCE($VBASE,$MVA,$RPU,$XPU,$POUT,$QOUT,$V,$Phase,E_MAG,E_PHASE)
         STORF(NSTORF+0) = E_MAG
         STORF(NSTORF+1) = E_PHASE*PI_BY180
      ENDIF
      E_MAG   = STORF(NSTORF+0)*$VBASE*SQRT_2*SQRT_1BY3
      E_PHASE = STORF(NSTORF+1)
      NSTORF = NSTORF + 2
#ENDIF
#IF View==2
      CALL EMTDC_1PVSRC($SS,$BA,$TInit,1,E_MAG,$w,E_PHASE)
#ELSE
      CALL EMTDC_1PVSRC($SS,$BA,$TInit,1,E_MAG,$w,E_PHASE)
      E_PHASE = E_PHASE - (PI_*2.0/3.0)
      CALL EMTDC_1PVSRC($SS,$BB,$TInit,1,E_MAG,$w,E_PHASE)
      E_PHASE = E_PHASE + 2.0*(PI_*2.0/3.0)
      CALL EMTDC_1PVSRC($SS,$BC,$TInit,1,E_MAG,$w,E_PHASE)
#ENDIF
!
#ELSE
#SUBROUTINE ETRAN_COM_PSSE_DSDYN Dynamic Interface from PSCAD to PSS/E
#STORAGE STOR:4
#STORAGE REAL:20
#STORAGE INTEGER:10
#STORAGE STOR:498
#STORAGE REAL:6
! Dynamnic Interface to PSS/E
#LOCAL REAL E_1,A_1,P_1,Q_1
#IF Imped==0
      CALL ETRAN_COM_SET_YEQ($BA,$BB,$BC,$SS,$Port,\"$Name\",0.0,0.0,$MVA,$VBASE)
      CALL ETRAN_COM_PSSE_DSDYN($BA,$BB,$BC,$N,0,$SS,$Port,$NOUTF,$NOUTI,$F,$VBASE,$MVA,0.0,0.0,$TInit,E_1,A_1,P_1,Q_1)
#ELSE
      CALL ETRAN_COM_SET_YEQ($BA,$BB,$BC,$SS,$Port,\"$Name\",$RPU,$XPU,$MVA,$VBASE)
      CALL ETRAN_COM_PSSE_DSDYN($BA,$BB,$BC,$N,0,$SS,$Port,$NOUTF,$NOUTI,$F,$VBASE,$MVA,$RPU,$XPU,$TInit,E_1,A_1,P_1,Q_1)
#ENDIF
      #OUTPUT REAL Vterm    {E_1}
      #OUTPUT REAL ANGterm  {A_1}
      #OUTPUT INTEGER ConvergeError {STORI(NSTORI-10+4)}
#ENDIF
#ENDIF"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Generators"
   Dsout = "\
#IF Enable==1
#IF Dynamic==1
#SUBROUTINE ETRAN_COM_PSSE_DSOUT Dynamic Interface from PSCAD to PSS/E
#LOCAL REAL E_1,A_1,P_1,Q_1
      CALL ETRAN_COM_PSSE_DSOUT($BA,$BB,$BC,$N,0,$SS,$Port,$NINF,$NINI,$F,$VBASE,E_1,A_1,P_1,Q_1)
      #OUTPUT REAL POutI    {P_1}
      #OUTPUT REAL QOutI    {Q_1}
#ENDIF
 #IF View==2
  #OUTPUT REAL CUR  {$CBR:BA}
 #ELSE
  #OUTPUT REAL CUR 3 {$CBR:BA} {$CBR:BB} {$CBR:BC}
 #ENDIF
#ELSE
 #IF View==2
  #OUTPUT REAL CUR  {0.0}
 #ELSE
  #OUTPUT REAL CUR 3 {0.0} {0.0} {0.0}
 #ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Single Phase Generator Model

Features:
     - Infinite Bus or Series R,X Voltage Source
     - Source E,delta or V,theta (at bus) can be entered
     - Source E,delta can be calculated given bus values and P,Q
"
   }
  }
 Component("Electranix_1to3")
  {
  Desc = "Single Phase to 3 Phase Converter"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Input("F",5,4,260,12,6)
     {
     Desc = "Frequency (Hz,can be a variable):"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 21
     Min = 0
     }
    Choice("SrcTyp",5,20,260,46,2)
     {
     Style = 1
     Desc = "Type of Interface?"
     Def = "0"
     Len = 15
     *0 = "Voltage Source on 1 side, Current Injection on 3 side"
     *1 = "Current Injection on 1 side, Voltage Source on 3 side"
     }
    Choice("PhAdv1",5,72,124,48,2)
     {
     Style = 1
     Desc = "Phase Advance on 1 Phase Side?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("PhAdv2",146,72,119,48,2)
     {
     Style = 1
     Desc = "Phase Advance on A,B,C Side?"
     Def = "1"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Input("R1",5,124,124,28,6)
     {
     Desc = "Source Res. on 1 Phase Side (ohms):"
     Def = "1"
     Data = Real
     Unit = "ohm"
     Len = 21
     Min = 0
     }
    Input("R2",146,124,119,28,6)
     {
     Desc = "Source Res. on A,B,C Side (ohms):"
     Def = "1"
     Data = Real
     Unit = "ohm"
     Len = 21
     Min = 0
     }
    Choice("View",5,160,164,44,2)
     {
     Style = 1
     Desc = "Three Phase Side Connection Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase Individual Connections"
     *1 = "Three Phase Single Line Diagram (V4)"
     }
    }
   }

  Nodes = 
   {
   Electrical("A",18,-18)
    {
    Cond = "View==0"
    }
   Electrical("C",18,18)
    {
    Cond = "View==0"
    }
   Electrical("A1",-18,0)
    {
    }
   Electrical("B",18,0)
    {
    Cond = "View==0"
    }
   Electrical("N",18,0)
    {
    Cond = "View==1"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Text(-12,10,"1")
   Text(12,10,"3")
   Text(-10,-9,"E")
   Cond = "View==0"
   Line(-18,0,18,0)
   Pen(,,0.6)
   Cond = "View==1"
   Line(0,0,16,0)
   Pen(,,0.2)
   Cond = "View==0"
   Line(0,18,18,18)
   Line(0,-18,18,-18)
   Line(0,-18,0,18)
   Cond = "View==1"
   Line(-18,0,0,0)
   }

  Section(EMTDC)
   {
   Computations = "\
INTEGER SrcTyp1 = SrcTyp
INTEGER SrcTyp2 = 1-SrcTyp"
   Checks = ""
   Branch = "\
#IF SrcTyp1==0
    Br1 =  $A1 0   SOURCE   $R1 /
#ENDIF
#IF SrcTyp2==0
 #IF View==0
    BrA =  $A  0   SOURCE   $R2 /
    BrB =  $B  0   SOURCE   $R2 /
    BrC =  $C  0   SOURCE   $R2 /
 #ELSE
    BrA =  $N(1)  0   SOURCE   $R2 /
    BrB =  $N(2)  0   SOURCE   $R2 /
    BrC =  $N(3)  0   SOURCE   $R2 /
 #ENDIF
#ENDIF"
   Help = ""
   Matrix-fill = ""
   Fortran = "\
#SUBROUTINE ELECTRANIX_1to3 Electranix Single to Three Phase Converter
#STORAGE INTEGER:1
#STORAGE REAL:1011
#IF ( (SrcTyp1==0) && (SrcTyp2==0) )
! Voltage to Voltage Interface
      CALL ELECTRANIX_1to3($SS,$Br1,$BrA,$BrB,$BrC,$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
#ELSEIF ((SrcTyp1==0) && (SrcTyp2==1) )
! Voltage to Current Interface
 #IF View==0
      CALL ELECTRANIX_1to3($SS,$Br1,$A,$B,$C,$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
 #ELSE
      CALL ELECTRANIX_1to3($SS,$Br1,$N(1),$N(2),$N(3),$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
 #ENDIF
#ELSEIF ((SrcTyp1==1) && (SrcTyp2==0) )
! Current to Voltage Interface
      CALL ELECTRANIX_1to3($SS,$A1,$BrA,$BrB,$BrC,$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
#ELSEIF ((SrcTyp1==1) && (SrcTyp2==1) )
! Current to Current Interface
 #IF View==0
      CALL ELECTRANIX_1to3($SS,$A1,$A,$B,$C,$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
 #ELSE
      CALL ELECTRANIX_1to3($SS,$A1,$N(1),$N(2),$N(3),$F,$R1,$R2,$SrcTyp1,$SrcTyp2,$PhAdv1,$PhAdv2)
 #ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase to 3 Phase Converter

This model interfaces a single phase system to a three phase system:
     - An voltage or current source interface is created at each end
     - Measured current at side 1 is injected into side 2
     - Measured voltage from side 2 is used in a voltage source at side 1
     - Interface resistances are used (and compensated for) to improve numerical stability
     - Phase advance can be used to eliminate one time step delay in the interfacing
:A1
Single Phase Side Electrical Connection
:A
Phase A of 3 Phase Electrical Connection
:B
Phase B of 3 Phase Electrical Connection
:C
Phase C of 3 Phase Electrical Connection"
   }
  }
 Component("Electranix_singlephase_rms")
  {
  Desc = "Singe Phase RMS Meter Using Recursive DFT"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Input("VBase",5,4,288,12,2)
     {
     Desc = "Base Voltage (kV,L-L,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0
     }
    Input("FINIT",5,20,288,12,6)
     {
     Desc = "Frequency (Hz,can be a variable)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Text("REFPH",5,36,288,12,2)
     {
     Desc = "Name for Reference Angle (Deg - Sawtooth Synchronized to T=0.0)"
     Len = 15
     }
    Text("PHASE",5,52,288,12,2)
     {
     Desc = "Name for Measured Phase (Deg - Constant in Steady State)"
     Len = 15
     }
    Choice("View",5,72,141,36,2)
     {
     Style = 1
     Desc = "Connection Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *2 = "Single Phase"
     }
    }
   }

  Nodes = 
   {
   Input("V",-54,-18)
    {
    Cond = "View==2"
    Type = Real
    }
   Input("V",-54,-18)
    {
    Cond = "View!=2"
    Type = Real
    Dim  = [3]
    }
   Output("Angle",54,-18)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Pen(ByNode,,ByNode,V)
   Line(-41,-18,-47,-24)
   Pen(,ByNode)
   Line(54,-18,42,-18)
   Pen(,Solid)
   Line(-41,-18,-47,-11)
   Pen(,ByNode)
   Line(-54,-18,-40,-18)
   Pen(Black,Solid,0.2)
   Cond = "View!=2"
   Line(-52,-13,-49,-21)
   Text(-46,-22,"3")
   Cond = "true"
   Text(10,-13,"Angle(Deg)")
   Line(24,-24,24,-40)
   Line(1,-24,24,-40)
   Line(24,-24,37,-34)
   Line(1,-24,1,-40)
   Line(-21,-24,-21,-40)
   Line(-21,-24,1,-40)
   Text(-36,-31,"E")
   Line(-25,-37,-21,-40)
   Cond = "View==2"
   Text(1,-46,"1-Phase PLL")
   Cond = "View!=2"
   Text(1,-46,"3-Phase PLL")
   Pen(Blue,,0.4)
   Cond = "true"
   Rectangle(-41,-44,41,-10)
   }

  Section(EMTDC)
   {
   DSOUT = "\
#SUBROUTINE Electranix_RDFT - PLL using Recursive DFT Algorithm

#IF View==2
 #STORAGE STOR:4
! Storage for REAL should be NSAMP + 6
 #STORAGE REAL:106
 #STORAGE INTEGER:2
 #STORAGE COMPLEX:2
 #LOCAL REAL V_VREFPH
 #LOCAL REAL V_RMS
 #LOCAL REAL V_PHASE
! Get Fundamental of a Single Phase Voltage
      CALL Electranix_RDFT($V,$FINIT,0.005,0.0,100,V_RMS,V_PHASE,$Angle,V_VREFPH)
 #OUTPUT REAL REFPH 1 {V_VREFPH}
 #OUTPUT REAL PHASE 1 {V_PHASE}
#ELSE
 #STORAGE STOR:12
 #STORAGE REAL:318
 #STORAGE INTEGER:6
 #STORAGE COMPLEX:6
 #LOCAL REAL V_VREFPH
 #LOCAL REAL V_VANGLE
 #LOCAL REAL V_rmsA
 #LOCAL REAL V_PhaseA
 #LOCAL REAL V_rmsB
 #LOCAL REAL V_PhaseB
 #LOCAL REAL V_rmsC
 #LOCAL REAL V_PhaseC
 #LOCAL REAL PV_Phase
! Get Positive Sequence Fundamental of 3 Phase Voltages
      CALL Electranix_RDFT($V(1),$FINIT,0.005,0.0,100,V_rmsA,V_PhaseA,V_VANGLE,V_VREFPH)
      CALL Electranix_RDFT($V(2),$FINIT,0.005,0.0,100,V_rmsB,V_PhaseB,V_VANGLE,V_VREFPH)
      CALL Electranix_RDFT($V(3),$FINIT,0.005,0.0,100,V_rmsC,V_PhaseC,V_VANGLE,V_VREFPH)
 #STORAGE COMPLEX:4
      V_PhaseA = V_PhaseA*PI_BY180
      V_PhaseB = V_PhaseB*PI_BY180
      V_PhaseC = V_PhaseC*PI_BY180
      STORC(NSTORC+0)=V_rmsA*CMPLX(COS(V_PhaseA),SIN(V_PhaseA))
      STORC(NSTORC+1)=V_rmsB*CMPLX(COS(V_PhaseB),SIN(V_PhaseB))
      STORC(NSTORC+2)=V_rmsC*CMPLX(COS(V_PhaseC),SIN(V_PhaseC))
      STORC(NSTORC+3) = (STORC(NSTORC+0)+STORC(NSTORC+1)*CMPLX(-0.5,SQRT(0.75))+STORC(NSTORC+2)*CMPLX(-0.5,-SQRT(0.75)))/3.0
      IF ( (ABS(AIMAG(STORC(NSTORC+3))).LE.1.0E-10).AND.(ABS( REAL(STORC(NSTORC+3))).LE.1.0E-10) ) THEN
         PV_Phase = 0.0
      ELSE
         PV_Phase = ATAN2(AIMAG(STORC(NSTORC+3)),REAL(STORC(NSTORC+3)))*BY180_PI
      ENDIF
      $Angle = V_VREFPH + PV_Phase
      IF ( $Angle .GT. 360.0 ) $Angle = $Angle - 360.0
      IF ( $Angle .LE.   0.0 ) $Angle = $Angle + 360.0
      NSTORC = NSTORC + 4
 #OUTPUT REAL REFPH 1 {V_VREFPH}
 #OUTPUT REAL PHASE 1 {PV_Phase}
#ENDIF"
   Branch = ""
   Computations = ""
   Help = "E-TRAN\\E-TRAN008.htm#SubChapter_ETRAN_Measurements"
   }
  }
 Component("Electranix_NodeExport")
  {
  Desc = "Node Export -Circuit continues on another page"
  FileDate = 0
  Parameters = 
   {
   }

  Nodes = 
   {
   }

  Graphics = 
   {
   Pen(,,0.6)
   Line(9,4,12,12)
   Line(12,12,4,9)
   Line(0,0,12,12)
   }

  Section(EMTDC)
   {
   Fortran = ""
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_SwitchedShunt")
  {
  Desc = "PSSE Compatible Switched Shunt Model"
  FileDate = 0
  Parameters = 
   {
   Category("Parameters")
    {
    Text("Name",5,4,265,12,2)
     {
     Desc = "Switched Shunt Name"
     Def = "SwitchShunt 1"
     Len = 21
     }
    Input("PO",5,20,265,12,6)
     {
     Desc = "3 Phase Real Power (MW,can be a variable)"
     Def = "100"
     Data = Real
     Unit = "MW"
     Len = 15
     Min = 0
     }
    Input("QO",5,36,265,12,6)
     {
     Desc = "3 Phase Reactive Power (MVAR,+L,can be a variable)"
     Def = "25"
     Data = Real
     Unit = "MVAR"
     Len = 15
     }
    Input("FR",5,52,265,12,6)
     {
     Desc = "Fundamental Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VBO",5,68,265,12,2)
     {
     Desc = "Rated Load Voltage (kV,L-L,rms)"
     Def = "230"
     Data = Real
     Unit = "KV"
     Len = 15
     Min = 0
     }
    Input("VO",5,84,265,12,2)
     {
     Desc = "Initial Load Voltage for initialization(p.u.)"
     Def = "1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Choice("Enable",5,100,102,42,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("View",119,100,151,56,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    }
   Category("Outputs")
    {
    Text("PL",5,4,265,12,2)
     {
     Desc = "Name for Total Load P (MW,3 Phase)"
     Len = 24
     }
    Text("QL",5,20,265,12,2)
     {
     Desc = "Name for Total Load Q (MVAR,3 Phase,+L)"
     Len = 24
     }
    Text("INAME",5,36,265,12,2)
     {
     Desc = "Name for Load Currents (kA,Instantaneous)"
     Len = 24
     }
    }
   Category("Animated States")
    {
    Text("Pdisplay",5,4,269,12,2)
     {
     Desc = "Animated Display of P (Auto-updated)"
     Def = "0.0"
     Len = 24
     }
    Text("Qdisplay",5,20,269,12,2)
     {
     Desc = "Animated Display of Q (Auto-updated)"
     Def = "0.0"
     Len = 24
     }
    }
   }

  Nodes = 
   {
   Electrical("Gnd",90,0)
    {
    Cond = "Enable==1"
    Type = Ground
    }
   Electrical("IA",0,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("IC",0,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("IB",0,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("I",0,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("IA",0,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "(Enable==0)&&(View!=0)"
   Rectangle(0,-15,108,16)
   Cond = "(Enable==0)&&(View==0)"
   Rectangle(-1,-19,108,22)
   Cond = "true"
   Line(99,8,99,-9)
   Line(103,5,103,-5)
   Line(106,2,106,-2)
   Line(91,0,99,0)
   Line(34,-3,40,0)
   Line(40,0,34,3)
   Font(,,Left)
   Text(0,-3,"$Pdisplay")
   Text(0,12,"$Qdisplay")
   Font(,,Centre)
   Text(66,0,"Switched")
   Text(75,10,"Shunt")
   Text(46,10,"E")
   Cond = "View==0"
   Line(0,-18,28,-18)
   Line(28,-18,34,0)
   Line(28,18,34,0)
   Line(0,18,28,18)
   Cond = "View!=1"
   Line(0,0,42,0)
   Pen(,,0.6)
   Cond = "View==1"
   Line(0,0,42,0)
   Pen(,,0.2)
   Brush(Hollow)
   Cond = "View!=1"
   Rectangle(42,-12,91,12)
   Pen(,,0.6)
   Cond = "View==1"
   Rectangle(42,-12,91,12)
   }

  Section(EMTDC)
   {
   Computations = ""
   BRANCH = "\
#IF Enable==1
 #IF View==2
     BRA = $IA $Gnd BREAKER 1.0 /
     BLA = $IA $Gnd BREAKER 1.0 /
     BCA = $IA $Gnd BREAKER 1.0 /
 #ELSEIF View==1
     BRA = $I(1) $Gnd BREAKER 1.0 /
     BLA = $I(1) $Gnd BREAKER 1.0 /
     BCA = $I(1) $Gnd BREAKER 1.0 /
     BRB = $I(2) $Gnd BREAKER 1.0 /
     BLB = $I(2) $Gnd BREAKER 1.0 /
     BCB = $I(2) $Gnd BREAKER 1.0 /
     BRC = $I(3) $Gnd BREAKER 1.0 /
     BLC = $I(3) $Gnd BREAKER 1.0 /
     BCC = $I(3) $Gnd BREAKER 1.0 /
 #ELSE
     BRA = $IA $Gnd BREAKER 1.0 /
     BLA = $IA $Gnd BREAKER 1.0 /
     BCA = $IA $Gnd BREAKER 1.0 /
     BRB = $IB $Gnd BREAKER 1.0 /
     BLB = $IB $Gnd BREAKER 1.0 /
     BCB = $IB $Gnd BREAKER 1.0 /
     BRC = $IC $Gnd BREAKER 1.0 /
     BLC = $IC $Gnd BREAKER 1.0 /
     BCC = $IC $Gnd BREAKER 1.0 /
 #ENDIF
#ENDIF"
   DSDYN = "\
#IF Enable==1
#SUBROUTINE Electranix_1Load - Electranix Single Phase Load Model/Switched Shunt Model
      IF ( FIRSTSTEP ) THEN
         IF ( $PO < 0.0 ) THEN
            WRITE(6,*) \"Warning in E-TRAN Load Data - Load Power must be > 0 - $PO was entered.\"
            #IF View==2
               WRITE(6,*) \"E-TRAN Load Data at nodes $IA in subsystem $SS .\"
            #ELSEIF (View==1)
               WRITE(6,*) \"E-TRAN Load Data at nodes $I(1), $I(2), $I(3) in subsystem $SS .\"
            #ELSE
               WRITE(6,*) \"E-TRAN Load Data at nodes $IA, $IB, $IC in subsystem $SS .\"
            #ENDIF
            CALL EMTDC_QUIT(\"Elect_1Load \",0)
         ENDIF
         IF ( $VBO < 0.0 ) THEN
            WRITE(6,*) \"Warning in E-TRAN Load Data - Base Voltage must be > 0 - $VBO was entered.\"
            #IF View==2
               WRITE(6,*) \"E-TRAN Load Data at nodes $IA in subsystem $SS .\"
            #ELSEIF (View==1)
               WRITE(6,*) \"E-TRAN Load Data at nodes $I(1), $I(2), $I(3) in subsystem $SS .\"
            #ELSE
               WRITE(6,*) \"E-TRAN Load Data at nodes $IA, $IB, $IC in subsystem $SS .\"
            #ENDIF
            CALL EMTDC_QUIT(\"Elect_1Load \",0)
         ENDIF
      ENDIF
#IF View==2
 #STORAGE STOR:159
 #STORAGE REAL:63
 #STORAGE INTEGER:6
 #STORAGE COMPLEX:4
#ELSE
 #STORAGE STOR:477
 #STORAGE REAL:189
 #STORAGE INTEGER:18
 #STORAGE COMPLEX:12
#ENDIF
#LOCAL REAL E_Volts
#LOCAL REAL E_Curr
#LOCAL REAL E_CurrLC
#LOCAL REAL E_R
#LOCAL REAL E_L
#LOCAL REAL E_C
#LOCAL REAL E_PA
#LOCAL REAL E_QA
#IF View!=2
#LOCAL REAL E_PB
#LOCAL REAL E_QB
#LOCAL REAL E_PC
#LOCAL REAL E_QC
#ENDIF
#LOCAL REAL VARR_I

#IF View==2
      E_Volts  = VDC($IA,$SS)
      E_Curr   = CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)
      E_CurrLC = CBR($BLA,$SS)+CBR($BCA,$SS)
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,3,1,E_R,E_L,E_C,E_PA,E_QA)
      CALL EMTDC_VARRLC10( $BRA , $SS , 0 , VARR_I , E_R , 0.0 )
      CALL EMTDC_VARRLC10( $BLA , $SS , 1 , VARR_I , E_L , 0.0 )
      CALL EMTDC_VARRLC10( $BCA , $SS , 2 , VARR_I , E_C , 0.0 )
 #OUTPUT REAL PL    {E_PA}
 #OUTPUT REAL QL    {E_QA}

      IF ( TIMEZERO ) THEN
        CALL PSCAD_AGRG($#Component,$PO*$VO*$VO,\"Pdisplay\")
        CALL PSCAD_AGRG($#Component,$QO*$VO*$VO,\"Qdisplay\")
      ELSEIF ( UPDATE_AG ) THEN
        CALL PSCAD_AGRG($#Component,E_PA,\"Pdisplay\")
        CALL PSCAD_AGRG($#Component,E_QA,\"Pdisplay\")
      ENDIF

#ELSE
! Load A
 #IF View==1
      E_Volts  = VDC($I(1),$SS)
 #ELSE
      E_Volts  = VDC($IA,$SS)
 #ENDIF
      E_Curr   = CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)
      E_CurrLC = CBR($BLA,$SS)+CBR($BCA,$SS)
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,3,1,E_R,E_L,E_C,E_PA,E_QA)
      CALL EMTDC_VARRLC10( $BRA , $SS , 0 , VARR_I , E_R , 0.0 )
      CALL EMTDC_VARRLC10( $BLA , $SS , 1 , VARR_I , E_L , 0.0 )
      CALL EMTDC_VARRLC10( $BCA , $SS , 2 , VARR_I , E_C , 0.0 )
! Load B
 #IF View==1
      E_Volts  = VDC($I(2),$SS)
 #ELSE
      E_Volts  = VDC($IB,$SS)
 #ENDIF
      E_Curr   = CBR($BRB,$SS)+CBR($BLB,$SS)+CBR($BCB,$SS)
      E_CurrLC = CBR($BLB,$SS)+CBR($BCB,$SS)
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,3,1,E_R,E_L,E_C,E_PB,E_QB)
      CALL EMTDC_VARRLC10( $BRB , $SS , 0 , VARR_I , E_R , 0.0 )
      CALL EMTDC_VARRLC10( $BLB , $SS , 1 , VARR_I , E_L , 0.0 )
      CALL EMTDC_VARRLC10( $BCB , $SS , 2 , VARR_I , E_C , 0.0 )
! Load C
 #IF View==1
      E_Volts  = VDC($I(3),$SS)
 #ELSE
      E_Volts  = VDC($IC,$SS)
 #ENDIF
      E_Curr   = CBR($BRC,$SS)+CBR($BLC,$SS)+CBR($BCC,$SS)
      E_CurrLC = CBR($BLC,$SS)+CBR($BCC,$SS)
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,3,1,E_R,E_L,E_C,E_PC,E_QC)
      CALL EMTDC_VARRLC10( $BRC , $SS , 0 , VARR_I , E_R , 0.0 )
      CALL EMTDC_VARRLC10( $BLC , $SS , 1 , VARR_I , E_L , 0.0 )
      CALL EMTDC_VARRLC10( $BCC , $SS , 2 , VARR_I , E_C , 0.0 )
#ENDIF
#OUTPUT REAL PL     {(E_PA+E_PB+E_PC)/3.0}
#OUTPUT REAL QL     {(E_QA+E_QB+E_QC)/3.0}

      IF ( TIMEZERO ) THEN
        CALL PSCAD_AGRG($#Component,$PO*$VO*$VO,\"Pdisplay\")
        CALL PSCAD_AGRG($#Component,$QO*$VO*$VO,\"Qdisplay\")
      ELSEIF ( UPDATE_AG ) THEN
#LOCAL REAL EPSUMVAL
#LOCAL REAL EQSUMVAL
         EPSUMVAL = (E_PA + E_PB + E_PC)/3.0
         EQSUMVAL = (E_QA + E_QB + E_QC)/3.0
         CALL PSCAD_AGRG($#Component,EPSUMVAL,\"Pdisplay\")
         CALL PSCAD_AGRG($#Component,EQSUMVAL,\"Qdisplay\")
      ENDIF
#ELSE
#IF View==2
 #OUTPUT REAL PL    {0.0}
 #OUTPUT REAL QL    {0.0}
#ELSE
 #OUTPUT REAL PL    {0.0}
 #OUTPUT REAL QL    {0.0}
#ENDIF




#ENDIF"
   HELP = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Switched_Shunts"
   Checks = ""
   DSOUT = "\
#IF Enable==1
 #IF View==2
  #OUTPUT REAL INAME  1 {CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)}
 #ELSE
  #OUTPUT REAL INAME  3 {CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)} {CBR($BRB,$SS)+CBR($BLB,$SS)+CBR($BCB,$SS)} {CBR($BRC,$SS)+CBR($BLC,$SS)+CBR($BCC,$SS)}
 #ENDIF
#ELSE
 #IF View==2
  #OUTPUT REAL INAME  1 {0.0}
 #ELSE
  #OUTPUT REAL INAME  3 {0.0} {0.0} {0.0}
 #ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Single Phase Switched Shunt Model

Load Model Features:
     - Dynamically computes load RLC based on fundamental frequency RMS voltage
     - Changes RLC values on current zeroes using VARRLC10 model
     - Load impedances can be frozen using a 0 or 1 \"Hold\" signal
Modes of Operation:
     - Constant P,Q Power
     - Constant Current
     - Constant Impedance (R,Xl or Xc is constant)
     - Constant RLC (R, L or C is constant)
:IA
Single Phase Electrical Connection"
   }
  }
 Component("Electranix_DCLink")
  {
  Desc = "DC Link"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration and DC Data")
    {
    Text("Name",5,4,289,12,2)
     {
     Desc = "DC Link Name"
     Def = "DC1"
     Len = 15
     }
    Input("VDCRATED",5,20,289,12,2)
     {
     Desc = "Rated DC Line Voltage (kV for all groups)"
     Def = "100"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("IDCRATED",5,36,289,12,2)
     {
     Desc = "Rated DC Current (kA)"
     Def = "1"
     Data = Real
     Unit = "kA"
     Len = 15
     }
    Input("DCR",5,52,289,12,2)
     {
     Desc = "DC Line Resistance (ohms - may be 0.0)"
     Def = "1"
     Data = Real
     Unit = "ohm"
     Len = 15
     }
    Input("DCL",5,68,288,12,2)
     {
     Desc = "DC Line Inductance (Henries - may be 0.0)"
     Def = "0.0"
     Data = Real
     Unit = "Henries"
     Len = 15
     }
    Input("BLOCK",5,84,288,12,6)
     {
     Desc = "Run Control (0 to Block, 1 to Run, can be a variable)"
     Def = "1"
     Data = Integer
     Len = 15
     }
    Input("DIR",5,100,288,12,6)
     {
     Desc = "Direction of Power (1 for 1-->2, -1 for 2-->1, can be a variable)"
     Def = "1"
     Data = Integer
     Len = 15
     }
    Choice("PLOC",5,116,128,36,2)
     {
     Style = 1
     Desc = "Are Ratings Specified at Rect or Inv?"
     Def = "0"
     Len = 15
     *0 = "Rectifier"
     *1 = "Inverter"
     }
    Choice("FastInit",146,116,160,36,2)
     {
     Style = 1
     Desc = "Use Fast Initialization?"
     Def = "1"
     Len = 15
     *0 = "No (use Initial Firing Angles After Deblock)"
     *1 = "Yes (Auto-calc of Initial Firing Angles)"
     }
    Choice("Control",5,160,128,48,2)
     {
     Style = 1
     Desc = "Use Internal or External Controls?"
     Def = "0"
     Len = 15
     *0 = "Use Internal Controls"
     *1 = "Use External Controls"
     *2 = "Infinite Bus at Each AC Terminal"
     }
    Choice("View",146,160,160,48,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    Choice("Enable",5,216,128,36,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("AUNITS",146,216,160,36,2)
     {
     Style = 1
     Desc = "Input Alpha in Degrees or Radians?"
     Def = "0"
     Len = 15
     Cond = "Control==1"
     *0 = "Degrees"
     *1 = "Radians"
     }
    }
   Category("Converter 1 Data")
    {
    Input("FR1",5,4,306,12,2)
     {
     Desc = "Converter 1 Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VBASE1",5,20,306,12,2)
     {
     Desc = "Converter 1 Rated Primary AC Voltage (kV,L-L,RMS)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("VVBASE1",5,36,306,12,2)
     {
     Desc = "Converter 1 Rated Valve Side AC Voltage (kV, L-L, RMS)"
     Def = "40"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("NG1",5,52,306,12,2)
     {
     Desc = "Converter 1 Number of Series Valve Groups"
     Def = "2"
     Data = Integer
     Len = 15
     }
    Input("X1",5,68,306,12,2)
     {
     Desc = "Converter 1 Leakage Reactance (pu on Transformer Base MVA)"
     Def = ".1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("TMVA1",5,84,306,12,2)
     {
     Desc = "Converter 1 Transformer Base MVA (3 phase MVA)"
     Def = "60"
     Data = Real
     Unit = "MVA"
     Len = 15
     }
    Input("TAP1",5,100,306,12,6)
     {
     Desc = "Converter 1 Tap Setting (pu, valve side/primary side)"
     Def = "1"
     Data = Real
     Len = 15
     }
    Input("TAUV1",5,116,306,12,6)
     {
     Desc = "Converter 1 DC Voltage Transducer Time Constant (sec) - Suggest 0.01 sec"
     Def = ".01"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("TAUI1",5,132,306,12,6)
     {
     Desc = "Converter 1 DC Current Transducer Time Constant (sec) - Suggest 0.01 sec"
     Def = ".01"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("SR1",5,148,306,12,2)
     {
     Desc = "Converter 1 Smoothing Reactor (Henries - may be 0.0)"
     Def = "0.1"
     Data = Real
     Unit = "H"
     Len = 15
     }
    Input("ACMAG1",5,164,306,12,6)
     {
     Desc = "Converter 1 Initial AC Bus Volts (pu)"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("ACPHASE1",5,180,306,12,6)
     {
     Desc = "Converter 1 Initial AC Bus Phase (deg)"
     Def = "0.0"
     Data = Real
     Unit = "°"
     Len = 15
     }
    }
   Category("Converter 2 Data")
    {
    Input("FR2",5,4,306,12,2)
     {
     Desc = "Converter 2 Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VBASE2",5,20,306,12,2)
     {
     Desc = "Converter 2 Rated Primary AC Voltage (kV,L-L,RMS)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("VVBASE2",5,36,306,12,2)
     {
     Desc = "Converter 2 Rated Valve Side AC Voltage (kV, L-L, RMS)"
     Def = "40"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("NG2",5,52,306,12,2)
     {
     Desc = "Converter 2 Number of Series Valve Groups"
     Def = "2"
     Data = Integer
     Len = 15
     }
    Input("X2",5,68,306,12,2)
     {
     Desc = "Converter 2 Leakage Reactance (pu on Transformer Base MVA)"
     Def = ".1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("TMVA2",5,84,306,12,2)
     {
     Desc = "Converter 2 Transformer Base MVA (3 phase MVA)"
     Def = "60"
     Data = Real
     Unit = "MVA"
     Len = 15
     }
    Input("TAP2",5,100,306,12,6)
     {
     Desc = "Converter 2 Tap Setting (pu, valve side/primary side)"
     Def = "1"
     Data = Real
     Len = 15
     }
    Input("TAUV2",5,116,306,12,6)
     {
     Desc = "Converter 2 DC Voltage Transducer Time Constant (sec) - Suggest 0.01 sec"
     Def = ".01"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("TAUI2",5,132,306,12,6)
     {
     Desc = "Converter 2 DC Current Transducer Time Constant (sec) - Suggest 0.01 sec"
     Def = ".01"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("SR2",5,148,306,12,2)
     {
     Desc = "Converter 2 Smoothing Reactor (Henries - may be 0.0)"
     Def = "0.1"
     Data = Real
     Unit = "H"
     Len = 15
     }
    Input("ACMAG2",5,164,306,12,6)
     {
     Desc = "Converter 2 Initial AC Bus Volts (pu)"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("ACPHASE2",5,180,306,12,6)
     {
     Desc = "Converter 2 Initial AC Bus Phase (deg)"
     Def = "0.0"
     Data = Real
     Unit = "°"
     Len = 15
     }
    }
   Category("Master Power/Current/VDCL Controls")
    {
    Cond = "Control==0"
    Choice("PORI",5,4,120,42,2)
     {
     Style = 1
     Desc = "Control DC Power or DC Current?"
     Def = "0"
     Len = 15
     *0 = "DC Power Control"
     *1 = "DC Current Control"
     }
    Input("PILEVEL",5,52,315,24,6)
     {
     Desc = "Master Controller Set-Point (either pu power or current - see above) - Suggest 1.0 pu"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("SCHEDDCV",5,80,315,12,6)
     {
     Desc = "Scheduled DC Voltage (pu, always +ve) - Suggest 1.0 pu"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("TAUVMEAS",5,96,315,12,6)
     {
     Desc = "Time Constant for DC Volts Meas. in Master Controls (sec) - Suggest 1.0 sec"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("VDCLVHI",5,112,315,12,6)
     {
     Desc = "VDCL DC Volts High Point (pu) - Suggest 0.8 pu"
     Def = ".8"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VDCLVLO",5,128,315,12,6)
     {
     Desc = "VDCL DC Volts Low Point (pu) - Suggest 0.4 pu"
     Def = ".4"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VDCLILO",5,144,315,12,6)
     {
     Desc = "VDCL DC Current Low Point (pu) - Suggest 0.3 pu"
     Def = ".3"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VDCLRATE",5,160,315,12,6)
     {
     Desc = "VDCL Maximum +ve Ramp Rate (pu/sec) - Suggest 5.0 pu/sec"
     Def = "5"
     Data = Real
     Unit = "pu/sec"
     Len = 15
     }
    Input("VDCLOFFSET",5,176,315,28,6)
     {
     Desc = "Rect. Transient I-Order Increase (pu) (Builds up DC Volts faster during recovery - suggest 0.2)"
     Def = ".2"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    }
   Category("Rectifier Control Parameters")
    {
    Cond = "Control==0"
    Input("GPR",5,4,288,12,6)
     {
     Desc = "Proportional Gain (Input-pu, Output-rad) - Suggest 0.2"
     Def = ".2"
     Data = Real
     Len = 15
     }
    Input("TIR",5,20,288,12,6)
     {
     Desc = "Integral Time Constant (Input-pu, Output-rad) - Suggest 0.05"
     Def = ".05"
     Data = Real
     Len = 15
     }
    Input("ALPHAMINR",5,36,288,12,6)
     {
     Desc = "Minimum Alpha (deg) - Suggest 0 deg"
     Def = "0"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("ALPHAMAXR",5,52,288,12,6)
     {
     Desc = "Maximum Alpha (deg) - Suggest 140 deg"
     Def = "140"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("IMARGINR",5,76,288,12,6)
     {
     Desc = "Current Margin (pu) - Normally 0.0 pu for DC Current Control"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VMARGINR",5,92,288,12,6)
     {
     Desc = "DC Voltage Margin (pu) - Suggest 0.1 pu"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("ALINITR",5,116,288,12,6)
     {
     Desc = "Initial Firing Angle After Deblock (deg) - Suggest 90 deg"
     Def = "90"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("RGAINIR",5,140,288,12,6)
     {
     Desc = "Relative Gain of DC Current Controller - Suggest 1.0 or 0.0 to disable"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("RGAINVR",5,156,288,12,6)
     {
     Desc = "Relative Gain of DC Voltage Controller - Suggest 1.0 or 0.0 to disable"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    }
   Category("Inverter Control Parameters")
    {
    Cond = "Control==0"
    Input("GPI",5,4,288,12,6)
     {
     Desc = "Proportional Gain (Input-pu or rad, Output-rad) - Suggest 0.2"
     Def = ".2"
     Data = Real
     Len = 15
     }
    Input("TII",5,20,288,12,6)
     {
     Desc = "Integral Time Constant (Input-pu or rad, Output-rad) - Suggest 0.05"
     Def = ".05"
     Data = Real
     Len = 15
     }
    Input("ALPHAMINI",5,36,288,12,6)
     {
     Desc = "Minimum Alpha (deg) - Suggest 90 Deg"
     Def = "90"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("ALPHAMAXI",5,52,288,12,6)
     {
     Desc = "Maximum Alpha (deg) - Suggest 160 Deg"
     Def = "160"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("GAMMANOMI",5,64,288,12,6)
     {
     Desc = "Nominal Inverter Extinction Angle (deg) - Suggest 18 deg"
     Def = "18"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("IMARGINI",5,88,288,12,6)
     {
     Desc = "Current Margin (pu) - Suggest 0.1 pu"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VMARGINI",5,104,288,12,6)
     {
     Desc = "DC Voltage Margin (pu) - Normally 0.0 for DC Voltage Control"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("GMARGINI",5,120,288,12,6)
     {
     Desc = "Gamma Margin (deg) - Suggest 5 deg"
     Def = "5"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("ALINITI",5,144,288,12,6)
     {
     Desc = "Initial Firing Angle After Deblock (deg) - Suggest 90 deg"
     Def = "90"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("RGAINII",5,168,288,12,6)
     {
     Desc = "Relative Gain of DC Current Controller - Suggest 1.0 or 0.0 to disable"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("RGAINVI",5,184,288,12,6)
     {
     Desc = "Relative Gain of DC Voltage Controller - Suggest 1.0 or 0.0 to disable"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("RGAINGI",5,200,288,12,6)
     {
     Desc = "Relative Gain of Gamma Controller - Suggest 1.0 or 0.0 to disable"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    }
   Category("Commutation Failure Modeling")
    {
    Cond = "Control!=2"
    Choice("COMFAIL",5,4,204,60,2)
     {
     Style = 1
     Desc = "Represent Commutation Failures at the Inverter?"
     Len = 15
     *0 = "No, Do Not Model Com-Fails"
     *1 = "Com-Fail Occurs When Inverter AC Voltage is Low"
     *2 = "Com-Fail"
     }
    Input("CFVLEVEL",5,68,297,12,6)
     {
     Desc = "AC Voltage Level at Which Com-Fail Occurs (pu) - Suggest 0.5 pu"
     Def = "0.5"
     Data = Real
     Unit = "pu"
     Len = 15
     Cond = "COMFAIL==1"
     }
    Input("CFGLEVEL",5,84,297,12,6)
     {
     Desc = "Gamma Level at Which Com-Fail Occurs (deg) - Suggest 8 deg"
     Def = "8"
     Data = Real
     Unit = "°"
     Len = 15
     Cond = "COMFAIL==2"
     }
    Input("CFDUR",5,100,297,12,6)
     {
     Desc = "Duration of Com-Fail (sec) - Suggest 0.02 sec"
     Def = "0.02"
     Data = Real
     Unit = "sec"
     Len = 15
     Cond = "COMFAIL==2"
     }
    }
   Category("Outputs")
    {
    Text("PAC1",5,4,290,12,2)
     {
     Desc = "Name for Converter 1 AC P (MW, from 1 to 2)"
     Len = 15
     }
    Text("QAC1",5,20,290,12,2)
     {
     Desc = "Name for Converter 1 AC Q (MVAR, from 1 to 2)"
     Len = 15
     }
    Text("VDC1",5,36,290,12,2)
     {
     Desc = "Name for Converter 1 DC Volts (pu)"
     Len = 15
     }
    Text("IDC1",5,52,290,12,2)
     {
     Desc = "Name for Converter 1 DC Current (pu)"
     Len = 15
     }
    Text("GAMMA1",5,68,290,12,2)
     {
     Desc = "Name for Converter 1 Gamma (deg)"
     Len = 15
     }
    Text("U1",5,84,290,12,2)
     {
     Desc = "Name for Converter 1 Overlap Angle (deg)"
     Len = 15
     }
    Text("ALPHAOUT1",5,100,290,12,2)
     {
     Desc = "Name for Converter 1 Firing Angle (deg)"
     Len = 15
     }
    Text("IORDER1",5,116,290,12,2)
     {
     Desc = "Name for Converter 1 Current Order (pu)"
     Len = 15
     }
    Text("MODE1",5,132,290,12,2)
     {
     Desc = "Name for Converter 1 Control Mode (0: Blocked,1:IDC,2:VDC,3:Gamma)"
     Len = 15
     }
    Text("PAC2",5,156,290,12,2)
     {
     Desc = "Name for Converter 2 AC P (MW, from 1 to 2)"
     Len = 15
     }
    Text("QAC2",5,172,290,12,2)
     {
     Desc = "Name for Converter 2 AC Q (MVAR, from 1 to 2)"
     Len = 15
     }
    Text("VDC2",5,188,290,12,2)
     {
     Desc = "Name for Converter 2 DC Volts (pu)"
     Len = 15
     }
    Text("IDC2",5,204,290,12,2)
     {
     Desc = "Name for Converter 2 DC Current (pu)"
     Len = 15
     }
    Text("GAMMA2",5,220,290,12,2)
     {
     Desc = "Name for Converter 2 Gamma (deg)"
     Len = 15
     }
    Text("U2",5,236,290,12,2)
     {
     Desc = "Name for Converter 2 Overlap Angle (deg)"
     Len = 15
     }
    Text("ALPHAOUT2",5,252,290,12,2)
     {
     Desc = "Name for Converter 2 Firing Angle (deg)"
     Len = 15
     }
    Text("IORDER2",5,268,290,12,2)
     {
     Desc = "Name for Converter 2 Current Order (pu)"
     Len = 15
     }
    Text("MODE2",5,284,290,12,2)
     {
     Desc = "Name for Converter 2 Control Mode (1:IDC,2:VDC,3:Gamma)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("G",0,0)
    {
    Cond = "Enable==1"
    Type = Ground
    }
   Electrical("NA2",54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("NA1",-54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("NA2",54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("NB2",54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("NC2",54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N1",-54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("NA1",-54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N2",54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("NB1",-54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("NC1",-54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Input("ALPHA1",-36,18)
    {
    Cond = "Control==1"
    Type = Real
    }
   Input("ALPHA2",36,18)
    {
    Cond = "Control==1"
    Type = Real
    }
   }

  Graphics = 
   {
   Brush(Solid,Silver)
   Cond = "(Enable==0)&&(View!=1)"
   Rectangle(12,-12,36,10)
   Pen(,,0.6)
   Cond = "(Enable==0)&&(View==1)"
   Rectangle(12,-12,36,10)
   Rectangle(-36,-12,-12,10)
   Pen(,,0.2)
   Cond = "(Enable==0)&&(View!=1)"
   Rectangle(-36,-12,-12,10)
   Pen(,,0.6)
   Cond = "(Enable==0)&&(View==1)"
   Ellipse(-46,-4,-37,4)
   Ellipse(-51,-4,-42,4)
   Brush(Hollow)
   Cond = "(Enable==1)&&(View==1)"
   Ellipse(-51,-4,-42,4)
   Ellipse(-46,-4,-37,4)
   Pen(,,0.2)
   Brush(Solid)
   Cond = "(Enable==0)&&(View!=1)"
   Ellipse(-51,-4,-42,4)
   Ellipse(-46,-4,-37,4)
   Brush(Hollow)
   Cond = "(Enable==1)&&(View!=1)"
   Ellipse(-51,-4,-42,4)
   Ellipse(-46,-4,-37,4)
   Cond = "true"
   Text(40,-6,"2")
   Line(-24,-12,-24,-19)
   Line(24,-12,24,-19)
   Line(24,-19,-24,-19)
   Cond = "Control==1"
   Line(36,12,33,10)
   Line(33,10,31,13)
   Line(-36,12,-33,10)
   Line(-33,10,-31,13)
   Line(-36,18,-33,10)
   Line(36,18,33,10)
   Text(24,21,"A2")
   Cond = "View==0"
   Line(51,0,54,18)
   Line(-51,0,-54,18)
   Line(54,-18,51,0)
   Line(-54,-18,-51,0)
   Cond = "View!=1"
   Line(-37,0,-36,0)
   Line(-54,0,-51,0)
   Pen(,,0.6)
   Cond = "View==1"
   Line(-54,0,-51,0)
   Line(-37,0,-36,0)
   Brush(Solid)
   Cond = "(Enable==0)&&(View==1)"
   Ellipse(37,-4,46,4)
   Ellipse(42,-4,51,4)
   Brush(Hollow)
   Cond = "(Enable==1)&&(View==1)"
   Ellipse(42,-4,51,4)
   Ellipse(37,-4,46,4)
   Pen(,,0.2)
   Brush(Solid)
   Cond = "(Enable==0)&&(View!=1)"
   Ellipse(42,-4,51,4)
   Ellipse(37,-4,46,4)
   Brush(Hollow)
   Cond = "(Enable==1)&&(View!=1)"
   Ellipse(42,-4,51,4)
   Ellipse(37,-4,46,4)
   Cond = "View!=1"
   Line(37,0,36,0)
   Line(54,0,51,0)
   Pen(,,0.6)
   Cond = "View==1"
   Line(37,0,36,0)
   Line(54,0,51,0)
   Pen(,,0.2)
   Cond = "(Enable==1)&&(View!=1)"
   Rectangle(-36,-12,-12,10)
   Pen(,,0.6)
   Cond = "(Enable==1)&&(View==1)"
   Rectangle(-36,-12,-12,10)
   Pen(,,0.2)
   Cond = "(Enable==1)&&(View!=1)"
   Rectangle(12,-12,36,10)
   Cond = "Control==1"
   Text(-24,21,"A1")
   Pen(,,0.6)
   Cond = "(Enable==1)&&(View==1)"
   Rectangle(12,-12,36,10)
   Pen(,,0.4)
   Cond = "true"
   Line(-24,-10,-24,-7)
   Line(-33,-7,-15,-7)
   Line(-33,6,-24,-7)
   Line(-15,6,-24,-7)
   Line(-33,6,-15,6)
   Line(-24,6,-24,9)
   Line(24,-10,24,-7)
   Line(33,-7,15,-7)
   Line(15,-7,24,6)
   Line(33,-7,24,6)
   Line(33,6,15,6)
   Line(24,6,24,9)
   Text(-6,-1,"E")
   Text(-40,-9,"1")
   Text(1,-19,"$Name")
   Pen(,,0.2)
   Cond = "DIR!=1"
   Line(-9,-15,-4,-18)
   Line(-4,-12,-9,-15)
   Cond = "DIR==1"
   Line(10,-15,6,-18)
   Line(6,-12,10,-15)
   Cond = "true"
   Line(-9,-15,10,-15)
   }

  Section(EMTDC)
   {
   Computations = ""
   Checks = ""
   Branch = "\
#IF Enable==1
  #IF Control==2
   #IF View==0
    BA1 =  $G  $NA1     SOURCE  0.0001 0.0 0.0  /
    BB1 =  $G  $NB1     SOURCE  0.0001 0.0 0.0  /
    BC1 =  $G  $NC1     SOURCE  0.0001 0.0 0.0  /
    BA2 =  $G  $NA2     SOURCE  0.0001 0.0 0.0  /
    BB2 =  $G  $NB2     SOURCE  0.0001 0.0 0.0  /
    BC2 =  $G  $NC2     SOURCE  0.0001 0.0 0.0  /
   #ELSEIF View==1
    BA1 =  $G  $N1(1)     SOURCE  0.0001 0.0 0.0  /
    BB1 =  $G  $N1(2)     SOURCE  0.0001 0.0 0.0  /
    BC1 =  $G  $N1(3)     SOURCE  0.0001 0.0 0.0  /
    BA2 =  $G  $N2(1)     SOURCE  0.0001 0.0 0.0  /
    BB2 =  $G  $N2(2)     SOURCE  0.0001 0.0 0.0  /
    BC2 =  $G  $N2(3)     SOURCE  0.0001 0.0 0.0  /
   #ELSE
    BA1 =  $G  $NA1     SOURCE  0.0001 0.0 0.0  /
    BA2 =  $G  $NA2     SOURCE  0.0001 0.0 0.0  /
   #ENDIF
  #ENDIF
#ENDIF"
   Dsdyn = "\
#IF Enable==1

#IF Control<=1
! Electranix Simple DC Link Model
#SUBROUTINE ELECTRANIX_HVDC - PSSE Compatible HVDC Link

#LOCAL REAL    VDC_1
#LOCAL REAL    PDC_1
#LOCAL REAL    PAC_1
#LOCAL REAL    QAC_1
#LOCAL REAL    GAMMA_1
#LOCAL REAL    U_1
#LOCAL REAL    ALPHA_1
#LOCAL REAL    VDCMEAS_1
#LOCAL REAL    IORDER_1
#LOCAL INTEGER MODE_1

#LOCAL REAL    VDC_2
#LOCAL REAL    PDC_2
#LOCAL REAL    PAC_2
#LOCAL REAL    QAC_2
#LOCAL REAL    GAMMA_2
#LOCAL REAL    U_2
#LOCAL REAL    ALPHA_2
#LOCAL REAL    VDCMEAS_2
#LOCAL REAL    IORDER_2
#LOCAL INTEGER MODE_2

#LOCAL REAL    IDC_
#LOCAL REAL    IDCMEAS_
#LOCAL REAL    I_ORDER
#LOCAL REAL    RCOMP_pu
#LOCAL INTEGER NSTORF_SAVE
   #STORAGE STOR:232
   #STORAGE REAL:95
   #STORAGE INTEGER:13
   #STORAGE LOGICAL:1
   #STORAGE COMPLEX:4
#IF View!=2
   #STORAGE STOR:296
   #STORAGE REAL:128
   #STORAGE INTEGER:16
   #STORAGE COMPLEX:8
#ENDIF

! Restore Measured Input Signals for DC Controls
      NSTORF_SAVE = NSTORF
      VDC_1   = STORF(NSTORF_SAVE + 0)
      VDC_2   = STORF(NSTORF_SAVE + 1)
      IDC_    = STORF(NSTORF_SAVE + 2)
      GAMMA_1 = STORF(NSTORF_SAVE + 3)
      GAMMA_2 = STORF(NSTORF_SAVE + 4)
      NSTORF  = NSTORF + 5
#IF Control==0
! Internal DC Controls
      VDCMEAS_1 = VDC_1 / $VDCRATED
      VDCMEAS_2 = VDC_2 / $VDCRATED
      IDCMEAS_  = IDC_  / $IDCRATED
      RCOMP_pu  = $DCR / ($VDCRATED/$IDCRATED)


 #LOCAL REAL    AORDINI_R
 #LOCAL REAL    AORDINI_I


! Master Power Controls
      CALL ELECTRANIX_HVDC_Master_Controls($DIR,$PLOC,$BLOCK,
     &    $PORI,$PILEVEL,VDCMEAS_1,VDCMEAS_2,$SCHEDDCV,$TAUVMEAS,I_ORDER)
! Initialization
 #IF FastInit==1
      IF ( TIME .LE. 0.15 ) THEN
         CALL ELECTRANIX_HVDC_Initialize($DIR,$PLOC,
     &   I_ORDER*$IDCRATED,$SCHEDDCV*$VDCRATED,
     &   $NG1,$X1,$TMVA1,$ACMAG1,$VVBase1,$TAP1,
     &   $NG2,$X2,$TMVA2,$ACMAG2,$VVBase2,$TAP2,
     &   $ALPHAMINR,$ALPHAMAXR,$ALPHAMINI,$ALPHAMAXI,
     &   $DCR,
     &   AORDINI_R,AORDINI_I)
      ELSE
         AORDINI_R = $ALINITR
         AORDINI_I = $ALINITI
      ENDIF
 #ELSE
      AORDINI_R = $ALINITR
      AORDINI_I = $ALINITI
 #ENDIF
      IF ( $DIR .EQ. 1 ) THEN
! Converter 1 is a Rectifier
         CALL ELECTRANIX_HVDC_Conv_Controls($BLOCK, 0, $DIR,$PLOC,
     &   $FastInit,IDCMEAS_, VDCMEAS_1, GAMMA_1,
     &   I_ORDER, $SCHEDDCV, 0.0,
     &   $IMARGINR,$VMARGINR,0.0,
     &   $RGAINIR,$RGAINVR,1.0,
     &   $ALPHAMINR,$ALPHAMAXR,RCOMP_pu,
     &   $FR1,$GPR,$TIR,
     &   $TAUV1,$TAUI1,AORDINI_R,$SCHEDDCV,
     &   $VDCLVLO,$VDCLVHI,$VDCLILO,$VDCLRATE,$VDCLOFFSET,
     &   MODE_1, IORDER_1, ALPHA_1)
! Converter 2 is an Inverter
         CALL ELECTRANIX_HVDC_Conv_Controls($BLOCK, 1, $DIR,$PLOC,
     &   $FastInit,IDCMEAS_, VDCMEAS_2, GAMMA_2,
     &   I_ORDER, $SCHEDDCV, $GAMMANOMI,
     &   $IMARGINI,$VMARGINI,$GMARGINI,
     &   $RGAINII,$RGAINVI,$RGAINGI,
     &   $ALPHAMINI,$ALPHAMAXI,RCOMP_pu,
     &   $FR2,$GPI,$TII,
     &   $TAUV2,$TAUI2,AORDINI_I,$SCHEDDCV,
     &   $VDCLVLO,$VDCLVHI,$VDCLILO,$VDCLRATE,$VDCLOFFSET,
     &   MODE_2, IORDER_2, ALPHA_2)
      ELSE
! Converter 1 is an Inverter
         CALL ELECTRANIX_HVDC_Conv_Controls($BLOCK, 1, $DIR,$PLOC,
     &   $FastInit,IDCMEAS_, VDCMEAS_1, GAMMA_1,
     &   I_ORDER, $SCHEDDCV, $GAMMANOMI,
     &   $IMARGINI,$VMARGINI,$GMARGINI,
     &   $RGAINII,$RGAINVI,$RGAINGI,
     &   $ALPHAMINI,$ALPHAMAXI,RCOMP_pu,
     &   $FR1,$GPI,$TII,
     &   $TAUV1,$TAUI1,AORDINI_I,$SCHEDDCV,
     &   $VDCLVLO,$VDCLVHI,$VDCLILO,$VDCLRATE,$VDCLOFFSET,
     &   MODE_1, IORDER_1, ALPHA_1)
! Converter 2 is a Rectifier
         CALL ELECTRANIX_HVDC_Conv_Controls($BLOCK, 0, $DIR,$PLOC,
     &   $FastInit,IDCMEAS_, VDCMEAS_2, GAMMA_2,
     &   I_ORDER, $SCHEDDCV, 0.0,
     &   $IMARGINR,$VMARGINR,0.0,
     &   $RGAINIR,$RGAINVR,1.0,
     &   $ALPHAMINR,$ALPHAMAXR,RCOMP_pu,
     &   $FR2,$GPR,$TIR,
     &   $TAUV2,$TAUI2,AORDINI_R,$SCHEDDCV,
     &   $VDCLVLO,$VDCLVHI,$VDCLILO,$VDCLRATE,$VDCLOFFSET,
     &   MODE_2, IORDER_2, ALPHA_2)
      ENDIF


#ELSE
! External DC Controls
      IF ( $AUNITS .EQ. 0 ) THEN
         ALPHA_1 = $ALPHA1
         ALPHA_2 = $ALPHA2
      ELSE
! Convert from Radians to Degrees
         ALPHA_1 = $ALPHA1*BY180_PI
         ALPHA_2 = $ALPHA2*BY180_PI
      ENDIF
      MODE_1=-1
      MODE_2=-1
      IORDER_1=-1.0
      IORDER_2=-1.0
#ENDIF


! HVDC Converter Equations
      CALL ELECTRANIX_HVDC($DIR,$BLOCK,$DCR,$DCL,
#IF View==0
     & $NA1,$NB1,$NC1,$SS,$FR1,$SR1,
     & $NA2,$NB2,$NC2,$SS,$FR2,$SR2,
#ELSEIF View==1
     & $N1(1),$N1(2),$N1(3),$SS,$FR1,$SR1,
     & $N2(1),$N2(2),$N2(3),$SS,$FR2,$SR2,
#ELSE
     & $NA1,0,0,$SS,$FR1,$SR1,
     & $NA2,0,0,$SS,$FR2,$SR2,
#ENDIF
     & $NG1,$X1,$TMVA1,$VBase1,$VVBase1,$TAP1,ALPHA_1,
     & $NG2,$X2,$TMVA2,$VBase2,$VVBase2,$TAP2,ALPHA_2,
     & $COMFAIL,~
#CASE COMFAIL {~0.0,0.0,} {~$CFVLEVEL,0.0,} {~$CFGLEVEL,$CFDUR,}
     & IDC_,VDC_1,PDC_1,PAC_1,QAC_1,GAMMA_1,U_1,
     &      VDC_2,PDC_2,PAC_2,QAC_2,GAMMA_2,U_2)

! Save Quantities for HVDC Controls
      STORF(NSTORF_SAVE+0)=VDC_1
      STORF(NSTORF_SAVE+1)=VDC_2
      STORF(NSTORF_SAVE+2)=IDC_
      STORF(NSTORF_SAVE+3)=GAMMA_1
      STORF(NSTORF_SAVE+4)=GAMMA_2

#OUTPUT REAL IDC1   1 {IDC_ / $IDCRATED}
#OUTPUT REAL VDC1   1 {VDC_1 / $VDCRATED}
#OUTPUT REAL PAC1   1 {PAC_1}
#OUTPUT REAL QAC1   1 {QAC_1}
#OUTPUT REAL GAMMA1 1 {GAMMA_1}
#OUTPUT REAL U1     1 {U_1}
#OUTPUT REAL ALPHAOUT1 1 {ALPHA_1}
#OUTPUT REAL IORDER1   1 {IORDER_1}
#OUTPUT INTEGER MODE1  1 {MODE_1}

#OUTPUT REAL IDC2   1 {IDC_ / $IDCRATED}
#OUTPUT REAL VDC2   1 {VDC_2 / $VDCRATED}
#OUTPUT REAL PAC2   1 {PAC_2}
#OUTPUT REAL QAC2   1 {QAC_2}
#OUTPUT REAL GAMMA2 1 {GAMMA_2}
#OUTPUT REAL U2     1 {U_2}
#OUTPUT REAL ALPHAOUT2 1 {ALPHA_2}
#OUTPUT REAL IORDER2   1 {IORDER_2}
#OUTPUT INTEGER MODE2  1 {MODE_2}

#ELSE
! Simple Sources for DC Link
#SUBROUTINE EMTDC_1PVSRC Single-Phase Source model
!  DC Link: $Name
! Converter 1: $VBASE1 kV, $ACMAG1 pu, $FR1 Hz, $ACPHASE1 deg
! Converter 2: $VBASE2 kV, $ACMAG2 pu, $FR2 Hz, $ACPHASE2 deg
#LOCAL REAL E_MAG
#LOCAL REAL E_PHASE
#LOCAL REAL E_W


#IF ((View==0)||(View==1))
#STORAGE INTEGER:36
#STORAGE LOGICAL:6
#STORAGE REAL:48
      E_W     = $FR1*TWO_PI
      E_MAG   = $ACMAG1*$VBASE1*SQRT_2*SQRT_1BY3
      E_PHASE = $ACPHASE1*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BA1,0.05,1,E_MAG,E_W,E_PHASE)

      E_PHASE = ($ACPHASE1-120.0)*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BB1,0.05,1,E_MAG,E_W,E_PHASE)

      E_PHASE = ($ACPHASE1+120.0)*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BC1,0.05,1,E_MAG,E_W,E_PHASE)

      E_W     = $FR2*TWO_PI
      E_MAG   = $ACMAG2*$VBASE2*SQRT_2*SQRT_1BY3
      E_PHASE = $ACPHASE2*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BA2,0.05,1,E_MAG,E_W,E_PHASE)

      E_PHASE = ($ACPHASE2-120.0)*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BB2,0.05,1,E_MAG,E_W,E_PHASE)

      E_PHASE = ($ACPHASE2+120.0)*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BC2,0.05,1,E_MAG,E_W,E_PHASE)
#ELSE
#STORAGE INTEGER:12
#STORAGE LOGICAL:2
#STORAGE REAL:16
      E_W     = $FR1*TWO_PI
      E_MAG   = $ACMAG1*$VBASE1*SQRT_2*SQRT_1BY3
      E_PHASE = $ACPHASE1*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BA1,0.05,1,E_MAG,E_W,E_PHASE)

      E_W     = $FR2*TWO_PI
      E_MAG   = $ACMAG2*$VBASE2*SQRT_2*SQRT_1BY3
      E_PHASE = $ACPHASE2*PI_BY180
      CALL EMTDC_1PVSRC($SS,$BA2,0.05,1,E_MAG,E_W,E_PHASE)
#ENDIF



















#ENDIF
#ENDIF
#IF ( (Enable!=1) || (Control==2) )
! Converter is Disabled
#OUTPUT REAL IDC1   1 {0.0}
#OUTPUT REAL VDC1   1 {0.0}
#OUTPUT REAL PAC1   1 {0.0}
#OUTPUT REAL QAC1   1 {0.0}
#OUTPUT REAL GAMMA1 1 {0.0}
#OUTPUT REAL U1     1 {0.0}
#OUTPUT REAL ALPHAOUT1 1 {0.0}
#OUTPUT REAL IORDER1   1 {0.0}
#OUTPUT INTEGER MODE1  1 {-1}

#OUTPUT REAL IDC2   1 {0.0}
#OUTPUT REAL VDC2   1 {0.0}
#OUTPUT REAL PAC2   1 {0.0}
#OUTPUT REAL QAC2   1 {0.0}
#OUTPUT REAL GAMMA2 1 {0.0}
#OUTPUT REAL U2     1 {0.0}
#OUTPUT REAL ALPHAOUT2 1 {0.0}
#OUTPUT REAL IORDER2   1 {0.0}
#OUTPUT INTEGER MODE2  1 {-1}
#ENDIF"
   Help = "\
E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_DC_Links
"
   Dsout = ""
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase Generator Model

Features:
     - Infinite Bus or Series R,X Voltage Source
     - Source E,delta or V,theta (at bus) can be entered
     - Source E,delta can be calculated given bus values and P,Q
:NA
Single Phase Electrical Connection"
   }
  }
 Component("Electranix_SeriesCapacitor")
  {
  Desc = "Series Capacitor"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Text("Name",5,4,242,12,2)
     {
     Desc = "BRANCH NAME"
     Def = "Br1"
     Len = 21
     }
    Input("MVA2",5,20,242,12,2)
     {
     Desc = "Rated MVA (3 Phase)"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 0
     }
    Input("F",5,36,242,12,2)
     {
     Desc = "Line Rated Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VR2",5,52,242,12,2)
     {
     Desc = "Rated Voltage (kV,L-L,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0
     }
    Input("RPUP2",5,68,242,12,2)
     {
     Desc = "R - +ve Seq. Resistance (pu)"
     Def = ".00336786"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Cond = "Ideal==0"
     }
    Input("XLPUP2",5,84,242,12,2)
     {
     Desc = "X - +ve Seq. Reactance (pu - enter -ve for capacitors)"
     Def = ".0593346"
     Data = Real
     Unit = "p.u."
     Len = 15
     Cond = "Ideal==0"
     }
    Choice("Ideal",5,104,123,40,2)
     {
     Style = 1
     Desc = "Is this an Ideal Branch (R=0.0)?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("Enable",146,104,101,40,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("View",5,152,242,56,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    }
   Category("Shunt Admittance")
    {
    Input("GI",5,4,242,12,2)
     {
     Desc = "GI - Real Shunt Admittance on bus I (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BI",5,20,242,12,2)
     {
     Desc = "BI - Imag. Shunt Admittance on bus I (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("GJ",5,36,242,12,2)
     {
     Desc = "GJ - Real Shunt Admittance on bus J (pu)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     }
    Input("BJ",5,52,242,12,2)
     {
     Desc = "BJ - Imag. Shunt Admittance on bus J (pu, -ve for L)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("Ground",0,0)
    {
    Cond = "Enable==1"
    Type = Ground
    }
   Electrical("A2",54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("C1",-54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("C2",54,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A1",-54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("A1",-54,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("B1",-54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("N1",-54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("B2",54,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("A2",54,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("N2",54,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-46,-12,46,10)
   Cond = "(Ideal==0)&&(View!=1)"
   Line(3,0,54,0)
   Cond = "true"
   Text(-40,-1,"E")
   Cond = "View==0"
   Line(-46,0,-54,18)
   Line(-54,-18,-46,0)
   Line(46,0,54,18)
   Line(54,-18,46,0)
   Cond = "((ABS(GI)>0)||(ABS(BI)>0))"
   Line(-42,7,-42,0)
   Line(-42,22,-42,19)
   Text(-42,18,"I")
   Brush(Hollow)
   Rectangle(-45,7,-39,19)
   Cond = "((ABS(GJ)>0)||(ABS(BJ)>0))"
   Line(42,7,42,0)
   Line(42,22,42,19)
   Rectangle(39,7,45,19)
   Text(42,18,"J")
   Cond = "Ideal==1"
   Text(1,0,"Ideal (R=0)")
   Cond = "(Ideal==0)&&(View!=1)"
   Line(3,-7,3,7)
   Line(-4,-7,-4,7)
   Line(-54,0,-4,0)
   Cond = "(Ideal==1)&&(View!=1)"
   Line(-54,0,54,0)
   Pen(,,0.6)
   Cond = "(Ideal==0)&&(View==1)"
   Line(3,0,54,0)
   Line(3,-7,3,7)
   Line(-4,-7,-4,7)
   Line(-54,0,-4,0)
   Cond = "(Ideal==1)&&(View==1)"
   Line(-54,0,54,0)
   }

  Section(EMTDC)
   {
   Computations = "\
REAL   W       = 2*PI*F
REAL   ZBASE   = (VR2*VR2)/MVA2
REAL   YBASE   = MVA2/(VR2*VR2)
REAL   RSeries = RPUP2*ZBASE
REAL   LSeries = XLPUP2>0 ?    XLPUP2*ZBASE/W : 0.0
REAL   CSeries = XLPUP2>0 ?    0.0 : 1.0e6/(W*(-XLPUP2*ZBASE))
REAL   RShuntI  = ((GI>1.0e-10)||(GI<(-1.0e-10)))  ? 1.0/(GI*YBASE) : 0.0
REAL   CShuntI  = BI>0  ? (1.0e6)*BI/(ZBASE*W)   : 0.0
REAL   LShuntI  = BI<0  ? (ZBASE/(-BI))/W        : 0.0
REAL   RShuntJ  = ((GJ>1.0e-10)||(GJ<(-1.0e-10)))  ? 1.0/(GJ*YBASE) : 0.0
REAL   CShuntJ  = BJ>0  ? (1.0e6)*BJ/(ZBASE*W)   : 0.0
REAL   LShuntJ  = BJ<0  ? (ZBASE/(-BJ))/W        : 0.0
"
   Checks = "\
#IF Enable==1
WARNING -ve Resistance Encountered - Numerical instabilities are possible! : RSeries>=0
#ENDIF"
   Branch = "\
#IF Enable==1
 #IF Ideal==0
  #IF View==2
   $A1 $A2   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ELSEIF View==1
   $N1(1) $N2(1)   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $N1(2) $N2(2)   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $N1(3) $N2(3)   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ELSE
   $A1 $A2   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $B1 $B2   $RSeries $LSeries $CSeries    / Pi-Section $Name
   $C1 $C2   $RSeries $LSeries $CSeries    / Pi-Section $Name
  #ENDIF
 #ELSE
  #IF View==2
   $A1 $A2   0.0    / Pi-Section $Name - Ideal R=0 branch
  #ELSEIF View==1
   $N1(1) $N2(1)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $N1(2) $N2(2)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $N1(3) $N2(3)   AMMETER    / Pi-Section $Name - Ideal R=0 branch
  #ELSE
   $A1 $A2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $B1 $B2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
   $C1 $C2   AMMETER    / Pi-Section $Name - Ideal R=0 branch
  #ENDIF
 #ENDIF

 #IF ((RShuntI>1.0e-10)||(RShuntI<(-1.0e-10)))
  #IF View==2
   $A1 $Ground     $RShuntI
  #ELSEIF View==1
   $N1(1) $Ground     $RShuntI
   $N1(2) $Ground     $RShuntI
   $N1(3) $Ground     $RShuntI
  #ELSE
   $A1 $Ground     $RShuntI
   $B1 $Ground     $RShuntI
   $C1 $Ground     $RShuntI
  #ENDIF
 #ENDIF
 #IF CShuntI>0
  #IF View==2
   $A1 $Ground     0.0 0.0 $CShuntI
  #ELSEIF View==1
   $N1(1) $Ground     0.0 0.0 $CShuntI
   $N1(2) $Ground     0.0 0.0 $CShuntI
   $N1(3) $Ground     0.0 0.0 $CShuntI
  #ELSE
   $A1 $Ground     0.0 0.0 $CShuntI
   $B1 $Ground     0.0 0.0 $CShuntI
   $C1 $Ground     0.0 0.0 $CShuntI
  #ENDIF
 #ELSE
   #IF LShuntI>0
    #IF View==2
     $A1 $Ground     0.0 $LShuntI
    #ELSEIF View==1
     $N1(1) $Ground     0.0 $LShuntI
     $N1(2) $Ground     0.0 $LShuntI
     $N1(3) $Ground     0.0 $LShuntI
    #ELSE
     $A1 $Ground     0.0 $LShuntI
     $B1 $Ground     0.0 $LShuntI
     $C1 $Ground     0.0 $LShuntI
    #ENDIF
   #ENDIF
 #ENDIF

 #IF ((RShuntJ>1.0e-10)||(RShuntJ<(-1.0e-10)))
  #IF View==2
   $A2 $Ground     $RShuntJ
  #ELSEIF View==1
   $N2(1) $Ground     $RShuntJ
   $N2(2) $Ground     $RShuntJ
   $N2(3) $Ground     $RShuntJ
  #ELSE
   $A2 $Ground     $RShuntJ
   $B2 $Ground     $RShuntJ
   $C2 $Ground     $RShuntJ
  #ENDIF
 #ENDIF
 #IF CShuntJ>0
  #IF View==2
   $A2 $Ground     0.0 0.0 $CShuntJ
  #ELSEIF View==1
   $N2(1) $Ground     0.0 0.0 $CShuntJ
   $N2(2) $Ground     0.0 0.0 $CShuntJ
   $N2(3) $Ground     0.0 0.0 $CShuntJ
  #ELSE
   $A2 $Ground     0.0 0.0 $CShuntJ
   $B2 $Ground     0.0 0.0 $CShuntJ
   $C2 $Ground     0.0 0.0 $CShuntJ
  #ENDIF
 #ELSE
   #IF LShuntJ>0
    #IF View==2
     $A2 $Ground     0.0 $LShuntJ
    #ELSEIF View==1
     $N2(1) $Ground     0.0 $LShuntJ
     $N2(2) $Ground     0.0 $LShuntJ
     $N2(3) $Ground     0.0 $LShuntJ
    #ELSE
     $A2 $Ground     0.0 $LShuntJ
     $B2 $Ground     0.0 $LShuntJ
     $C2 $Ground     0.0 $LShuntJ
    #ENDIF
   #ENDIF
 #ENDIF

#ENDIF"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Series_Capacitors"
   Matrix-fill = "\
#IF Enable==1
 #IF View==2
  $A1 $A2
 #ELSEIF View==1
  $N1(1) $N2(1)
  $N1(2) $N2(2)
  $N1(3) $N2(3)
 #ELSE
  $A1 $A2
  $B1 $B2
  $C1 $C2
 #ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase PI Line Section

Generates PI Model for Short Transmission Lines or Cables.
     - R and L added as a series branch
     - C/2 added as a shunt branch at each end (only if B is entered)
     - It is assumed R,X and B have already been corrected for \"long line\" effects
     - The Bergeron travelling wave model should be used for \"long\" lines
       (where the travel time is > 1 time step)
:A1
Single Phase Electrical Connection
:A2
Single Phase Electrical Connection"
   }
  }
 Component("Electranix_volt_stab_detect")
  {
  Desc = "Detector of Voltage Instabilities"
  FileDate = 0
  Parameters = 
   {
   Category("Parameters")
    {
    Input("VTHRESH",5,4,192,12,2)
     {
     Desc = "Voltage Instability Threshold"
     Def = "1.0E5"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0
     }
    Input("ITHRESH",5,20,192,12,2)
     {
     Desc = "Current Instability Threshold"
     Def = "1.0E5"
     Data = Real
     Unit = "kA"
     Len = 15
     Min = 0
     }
    }
   }

  Nodes = 
   {
   }

  Graphics = 
   {
   Rectangle(-29,-29,29,29)
   Text(0,-7,"Numerical")
   Text(0,4,"Instability")
   Text(0,15,"Detector")
   }

  Section(EMTDC)
   {
   Fortran = "\
#LOCAL INTEGER SS_xx,I_xx
      DO SS_xx=1,ND2
         DO I_xx=1,MBUS(SS_xx)
            IF ( ABS(VDC(I_xx,SS_xx)) .GT. $VTHRESH ) THEN
               WRITE(6,*) \"***ERROR: V at node \", I_xx, \" in SS \", SS_xx, \" is > $VTHRESH\"
               WRITE(6,*) \"   This occured at time \", TIME
               STOP
            ENDIF
         ENDDO
!         DO I_xx=1,ND15
!            IF ( ABS(CBR(I_xx,SS_xx)) .GT. $ITHRESH ) THEN
!               WRITE(6,*) \"***ERROR: I in branch \", I_xx, \" in SS \", SS_xx, \" is > $ITHRESH\"
!               WRITE(6,*) \"   This branch is at nodes \", IEF(I_xx,SS_xx), \" and \", IET(I_xx,SS_xx)
!               WRITE(6,*) \"   This occured at time \", TIME
!               STOP
!            ENDIF
!         ENDDO
      ENDDO"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_Common_Set")
  {
  Desc = "Transfer of Information between Pages (set)"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("Name",5,4,192,12,2)
     {
     Desc = "Parameter Name (for display only)"
     Def = "X1"
     Len = 15
     }
    Choice("Type",5,20,73,48,2)
     {
     Style = 1
     Desc = "Variable Type"
     Def = "0"
     Len = 15
     *0 = "Integer"
     *1 = "Real"
     *2 = "Boolean"
     }
    Input("Dim",5,80,164,12,2)
     {
     Desc = "Array Dimension (1-100)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 1
     Max = 100
     }
    Input("Index",5,96,164,12,2)
     {
     Desc = "Variable Index (1-1000)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 1
     Max = 1000
     Cond = "Com==0"
     }
    Choice("Com",5,116,278,44,2)
     {
     Style = 1
     Desc = "Is this a com Interface to another process (requires E-TRAN Plus runtime license)?"
     Def = "0"
     Len = 15
     *0 = "No (communicates with local PSCAD program only)"
     *1 = "Yes (communicate with another PSCAD program or PSS/E)"
     }
    Input("Port",5,168,278,12,2)
     {
     Desc = "TCP/IP Port of other end"
     Def = "2000"
     Data = Integer
     Len = 15
     Cond = "Com==1"
     }
    Input("TStart",5,184,278,12,6)
     {
     Desc = "Start Time of Interface (sec, only for coms to PSS/E)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Cond = "Com==1"
     }
    }
   }

  Nodes = 
   {
   Input("INI:Dim",-54,0)
    {
    Cond = "Type==0"
    Type = Integer
    Dim  = [0]
    }
   Input("INR:Dim",-54,0)
    {
    Cond = "Type==1"
    Type = Real
    Dim  = [0]
    }
   Input("INB:Dim",-54,0)
    {
    Cond = "Type==2"
    Type = Logical
    Dim  = [0]
    }
   }

  Graphics = 
   {
   Pen(ByNode,Real,ByNode,INI:Dim)
   Cond = "Type==0"
   Line(-38,0,-44,-6)
   Line(-38,0,-44,6)
   Pen(,,,INR:Dim)
   Cond = "Type==1"
   Line(-38,0,-44,-6)
   Line(-38,0,-44,6)
   Pen(,,,INB:Dim)
   Cond = "Type==2"
   Line(-38,0,-44,-6)
   Line(-38,0,-44,6)
   Pen(,,,INI:Dim)
   Cond = "Type==0"
   Line(-54,0,-38,0)
   Pen(,,,INR:Dim)
   Cond = "Type==1"
   Line(-54,0,-38,0)
   Pen(,,,INB:Dim)
   Cond = "Type==2"
   Line(-54,0,-38,0)
   Cond = "true"
   Text(33,-6,"E")
   Pen(Blue,Solid,0.4)
   Rectangle(-37,-18,37,18)
   Font(,,Left)
   Text(-36,-4,"$Name")
   Cond = "Type==0"
   Text(30,13,"I")
   Cond = "Type==1"
   Text(27,13,"R")
   Cond = "Com==0"
   Text(-36,13,"$Index")
   Cond = "Type==2"
   Text(27,13,"B")
   Font(,,Centre)
   Cond = "true"
   Text(16,13,"Set")
   Pen(Integer,Real,ByNode,INI:Dim)
   Cond = "Dim>1"
   Line(-43,-4,-49,2)
   Font(,,Left)
   Text(-62,-6,"$Dim")
   Cond = "Com==1"
   Text(-32,14,"$Port")
   }

  Section(EMTDC)
   {
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_GetSet"
   DSOUT = "\
#STORAGE REAL:1000
#STORAGE INTEGER:2
#STORAGE LOGICAL:1
#IF Com==0
! Electranix Common Transfer - Set
#IF Dim==1
#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_SET_I($Index,$INI)
#ELSEIF Type==1
! Real
      CALL ELECTRANIX_COMMON_SET_R($Index,$INR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_SET_B($Index,$INB)
#ENDIF
#ELSE

#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_SET_In($Index,$Dim,0,0.0,0.0,$INI)
#ELSEIF Type==1
! Real
      CALL ELECTRANIX_COMMON_SET_Rn($Index,$Dim,0,0.0,0.0,$INR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_SET_Bn($Index,$Dim,0,0.0,0.0,$INB)
#ENDIF

#ENDIF

#ELSE
! Electranix Common Transfer - Set
#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_SET_In(1,$Dim,$Port,0.0,$TStart,$INI)
#ELSEIF Type==1
! Real
      CALL ELECTRANIX_COMMON_SET_Rn(1,$Dim,$Port,0.0,$TStart,$INR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_SET_Bn(1,$Dim,$Port,0.0,$TStart,$INB)
#ENDIF
#ENDIF"
   DSDYN = "\
#STORAGE LOGICAL:1
#IF Com!=0
! Electranix Common Transfer - Get one value to coordinate coms
#IF Type==0
! Integer
#LOCAL INTEGER TEST_I
      CALL ELECTRANIX_COMMON_GET_In(1,1,$Port,0.0,$TStart,TEST_I)
#ELSEIF Type==1
! Real
#LOCAL REAL TEST_R
      CALL ELECTRANIX_COMMON_GET_Rn(1,1,$Port,0.0,$TStart,TEST_R)
#ELSEIF Type==2
! Boolean
#LOCAL LOGICAL TEST_B
      CALL ELECTRANIX_COMMON_GET_Bn(1,1,$Port,0.0,$TStart,TEST_B)
#ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Common Block Transfer - Input

Transfers Information from one page to another
     - Integer, Real or Boolean Variables Supported
     - Multiple Inputs or Outputs allowed
     - Can transfer up to 1000 quantities of each type (I,R or B)"
   }
  }
 Component("Electranix_Common_Get")
  {
  Desc = "Transfer of Information between Pages (Get)"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("Name",5,4,192,12,2)
     {
     Desc = "Parameter Name (for display only)"
     Def = "X1"
     Len = 15
     }
    Choice("Type",5,20,73,55,2)
     {
     Style = 1
     Desc = "Variable Type"
     Def = "0"
     Len = 15
     *0 = "Integer"
     *1 = "Real"
     *2 = "Boolean"
     }
    Input("Dim",5,80,164,12,2)
     {
     Desc = "Array Dimension (1-100)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 1
     Max = 100
     }
    Input("Index",5,96,164,12,2)
     {
     Desc = "Variable Index (1-1000)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 1
     Max = 1000
     Cond = "Com==0"
     }
    Choice("Com",5,116,278,44,2)
     {
     Style = 1
     Desc = "Is this a com Interface to another process (requires E-TRAN Plus runtime license)?"
     Def = "0"
     Len = 15
     *0 = "No (communicates with local PSCAD program only)"
     *1 = "Yes (communicate with another PSCAD program or PSS/E)"
     }
    Input("Port",5,168,278,12,2)
     {
     Desc = "TCP/IP Port of other end"
     Def = "2000"
     Data = Integer
     Len = 15
     Cond = "Com==1"
     }
    Input("TStart",5,184,278,12,6)
     {
     Desc = "Start Time of Interface (sec, only for coms to PSS/E)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Cond = "Com==1"
     }
    Choice("Interp",5,200,205,44,2)
     {
     Style = 1
     Desc = "Use Extrap/Interp-olation? (use for analog values only!)"
     Def = "0"
     Len = 15
     Cond = "(Com==1)&&(Type==1)"
     *0 = "No (Do Not Use)"
     *1 = "Yes (Use Extrap/Interp-olation)"
     }
    }
   }

  Nodes = 
   {
   Output("OUTB:Dim",54,0)
    {
    Cond = "Type==2"
    Type = Logical
    Dim  = [0]
    }
   Output("OUTI:Dim",54,0)
    {
    Cond = "Type==0"
    Type = Integer
    Dim  = [0]
    }
   Output("OUTR:Dim",54,0)
    {
    Cond = "Type==1"
    Type = Real
    Dim  = [0]
    }
   }

  Graphics = 
   {
   Pen(ByNode,Real,ByNode,OUTI:Dim)
   Cond = "Type==0"
   Line(37,0,53,0)
   Pen(,,,OUTB:Dim)
   Cond = "Type==2"
   Line(37,0,53,0)
   Pen(,,,OUTR:Dim)
   Cond = "Type==1"
   Line(37,0,53,0)
   Cond = "true"
   Text(-33,-6,"E")
   Pen(Blue,Solid,0.4)
   Rectangle(-37,-18,37,18)
   Font(,,Right)
   Text(36,-4,"$Name")
   Font(,,Left)
   Cond = "Type==0"
   Text(-12,13,"I")
   Cond = "Type==1"
   Text(-15,13,"R")
   Cond = "Type==2"
   Text(-15,13,"B")
   Font(,,Right)
   Cond = "Com==0"
   Text(34,13,"$Index")
   Font(,,Centre)
   Cond = "true"
   Text(-25,13,"Get")
   Font(,,Left)
   Cond = "Dim>1"
   Text(35,-6,"$Dim")
   Pen(Integer,Real,ByNode)
   Line(48,-4,42,2)
   Font(,,Right)
   Cond = "Com==1"
   Text(29,13,"$Port")
   }

  Section(EMTDC)
   {
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_GetSet"
   DSDYN = "\
#STORAGE LOGICAL:1
#IF Com==0
! Electranix Common Transfer - Get
#IF Dim==1

#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_GET_I($Index,$OUTI)
#ELSEIF Type==1
! Real
      CALL ELECTRANIX_COMMON_GET_R($Index,$OUTR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_GET_B($Index,$OUTB)
#ENDIF

#ELSE

#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_GET_In($Index,$Dim,0,0.0,0.0,$OUTI)
#ELSEIF Type==1
! Real
      CALL ELECTRANIX_COMMON_GET_Rn($Index,$Dim,0,0.0,0.0,$OUTR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_GET_Bn($Index,$Dim,0,0.0,0.0,$OUTB)
#ENDIF

#ENDIF

#ELSE
! Electranix Common Transfer - Get
#IF Type==0
! Integer
      CALL ELECTRANIX_COMMON_GET_In(1,$Dim,$Port,0.0,$TStart,$OUTI)
#ELSEIF Type==1
! Real
#IF (Interp == 1)
      IF ( FIRSTSTEP ) CALL Electranix_GetSet_AddInterpolation($Port)
#ENDIF
 
      CALL ELECTRANIX_COMMON_GET_Rn(1,$Dim,$Port,0.0,$TStart,$OUTR)
#ELSEIF Type==2
! Boolean
      CALL ELECTRANIX_COMMON_GET_Bn(1,$Dim,$Port,0.0,$TStart,$OUTB)
#ENDIF

#ENDIF"
   DSOUT = "\
#STORAGE REAL:1000
#STORAGE INTEGER:2
#STORAGE LOGICAL:1
#IF Com!=0
! Electranix Common Transfer - Set one value for com coordination
#IF Type==0
! Integer
#LOCAL INTEGER TEST_I
      TEST_I = 0
      CALL ELECTRANIX_COMMON_SET_In(1,1,$Port,0.0,$TStart,TEST_I)
#ELSEIF Type==1
! Real
#LOCAL REAL TEST_R
      TEST_R = 0.0
      CALL ELECTRANIX_COMMON_SET_Rn(1,1,$Port,0.0,$TStart,TEST_R)
#ELSEIF Type==2
! Boolean
#LOCAL LOGICAL TEST_B
      TEST_B = .FALSE.
      CALL ELECTRANIX_COMMON_SET_Bn(1,1,$Port,0.0,$TStart,TEST_B)
#ENDIF
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Common Block Transfer - Output

Transfers Information from one page to another
     - Integer, Real or Boolean Variables Supported
     - Multiple Inputs or Outputs allowed
     - Can transfer up to 1000 quantities of each type (I,R or B)"
   }
  }
 Component("Electranix_Init_Conditions")
  {
  Desc = "Initial Conditions from Loadflow"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Choice("Type",5,4,141,76,2)
     {
     Style = 1
     Desc = "Branch Type/Initial Conditions Location"
     Def = "0"
     Len = 15
     *0 = "Branch to Ground"
     *-1 = "Series Device, Left Side"
     *1 = "Series Device, Right Side"
     *2 = "Machine to Ground"
     *3 = "3 Winding Xfmr, Tertiary"
     }
    Choice("Shift",160,4,110,52,2)
     {
     Style = 1
     Desc = "Phase Shift of this Bus"
     Def = "0"
     Len = 15
     *-1 = "- 30 degree phase shift"
     *0 = "No phase shift"
     *1 = "30 degree phase shift"
     }
    Input("NumMac",5,88,265,12,2)
     {
     Desc = "Number of Parallel Machines"
     Def = "1"
     Data = Real
     Len = 15
     Cond = "Type==2"
     }
    Input("Volts",5,104,265,12,2)
     {
     Desc = "Bus Voltage Magnitude from Loadflow (pu)"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("Phase",5,120,265,12,2)
     {
     Desc = "Bus Phase Angle from Loadflow (deg)"
     Def = "0.0"
     Data = Real
     Unit = "°"
     Len = 15
     }
    Input("P",5,136,265,12,2)
     {
     Desc = "Bus P Power Flow from Loadflow (total MW out of this bus)"
     Def = "0.0"
     Data = Real
     Unit = "MW"
     Len = 15
     }
    Input("Q",5,152,265,12,2)
     {
     Desc = "Bus Q Power Flow from Loadflow (total MVAR out of this bus)"
     Def = "0.0"
     Data = Real
     Unit = "MVAR"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Output("VOut",72,-36)
    {
    Type = Real
    }
   Output("QOut",72,18)
    {
    Type = Real
    }
   Output("AOut",72,-18)
    {
    Type = Real
    }
   Output("POut",72,0)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Pen(ByNode,Real,ByNode)
   Cond = "Type==0"
   Line(55,-36,71,-36)
   Cond = "Type==2"
   Line(55,-36,71,-36)
   Cond = "Type==0"
   Line(55,-18,71,-18)
   Cond = "Type==2"
   Line(55,-18,71,-18)
   Cond = "Type==0"
   Line(55,0,71,0)
   Cond = "Type==2"
   Line(55,0,71,0)
   Cond = "Type==0"
   Line(55,18,71,18)
   Cond = "Type==2"
   Line(55,18,71,18)
   Pen(Fuchsia,Solid,0.4)
   Cond = "true"
   Rectangle(-88,-69,55,30)
   Pen(ByNode,Real,ByNode,VOut)
   Line(55,-36,72,-36)
   Pen(,,,AOut)
   Line(55,-18,72,-18)
   Pen(,,,POut)
   Line(55,0,72,0)
   Pen(,,,QOut)
   Line(55,18,72,18)
   Font(,,Right)
   Text(54,-13,"Angle(deg)")
   Text(54,4,"Pout(MW)")
   Text(54,22,"Qout(MVAR)")
   Font(,,Left)
   Text(-87,-13,"$Phase")
   Text(-87,4,"$P")
   Text(-87,22,"$Q")
   Font(,,Centre)
   Text(-16,42,"Initial Conditions from Loadflow")
   Font(,,Right)
   Cond = "Shift==1"
   Text(-7,-13,"(+30)")
   Font(,,Left)
   Cond = "Type==-1"
   Text(-30,-58,"Left Bus")
   Cond = "Type==1"
   Text(-30,-58,"Right Bus")
   Font(,,Centre)
   Cond = "true"
   Text(-82,-58,"E")
   Font(,,Right)
   Cond = "Shift==-1"
   Text(-7,-13,"(-30)")
   Cond = "true"
   Text(54,-31,"Volts(pu)")
   Font(,,Left)
   Text(-87,-31,"$Volts")
   Cond = "Type==2"
   Text(-42,3," / $NumMac")
   Text(-42,22," / $NumMac")
   Cond = "Type==3"
   Text(-42,-58,"Tertiary Bus")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Electranix Initialization Component
      $VOut = $Volts
#IF ( Shift==1 )
      $AOut = $Phase + 30.0
#ELSEIF ( Shift==-1 )
      $AOut = $Phase - 30.0
#ELSE
      $AOut = $Phase
#ENDIF
#IF ( Type==2 )
      $POut = $P/$NumMac
      $QOut = $Q/$NumMac
#ELSE
      $POut = $P
      $QOut = $Q
#ENDIF
"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Initialize"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Initial Conditions

- Transfers Loadflow Terminal Conditions to this component
so it can be used to initialize custom models.
- E-TRAN also reads in the phase shift (-30,0 or +30)
(the offset is added to the loadflow angle before it is
written to the machine model - this handles the phase shifts
from wye-delta transformers)"
   }
  }
 Component("Electranix_Init_Tap")
  {
  Desc = "Transformer Tap Setting from Loadflow"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Choice("TapSide",5,4,246,64,2)
     {
     Style = 1
     Desc = "Which side of the Transformer has the Tap Changer?"
     Def = "0"
     Len = 15
     *-1 = "Left Side"
     *0 = "No Tap Changer"
     *1 = "Right Side"
     }
    Input("Tap",5,72,246,12,2)
     {
     Desc = "Transformer Tap (E-TRAN sets this from Loadflow)"
     Def = "1.0"
     Data = Real
     Len = 15
     Cond = "TapSide!=0"
     }
    }
   }

  Nodes = 
   {
   Output("TapOut",72,0)
    {
    Cond = "TapSide!=0"
    Type = Real
    }
   }

  Graphics = 
   {
   Pen(Fuchsia,,0.4)
   Rectangle(-88,-17,55,14)
   Pen(Real,Real,ByNode,TapOut)
   Cond = "TapSide!=0"
   Line(55,0,72,0)
   Cond = "true"
   Text(-15,27,"Transformer Tap Settings from Loadflow")
   Text(-83,-6,"E")
   Font(,,Right)
   Cond = "TapSide!=0"
   Text(54,3,"(pu)")
   Font(,,Left)
   Text(-88,4,"$Tap")
   Cond = "TapSide==0"
   Text(-36,4,"No Tap Changer")
   Cond = "TapSide==-1"
   Text(-32,3,"Tap on Left")
   Cond = "TapSide==1"
   Text(-39,3,"Tap on Right")
   }

  Section(EMTDC)
   {
   Fortran = "\
#IF ( TapSide != 0 )
      $TapOut = $Tap
#ENDIF
"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Initialize"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Common Block Transfer - Output

Transfers Information from one page to another
     - Integer, Real or Boolean Variables Supported
     - Multiple Inputs or Outputs allowed
     - Can transfer up to 1000 quantities of each type (I,R or B)"
   }
  }
 Component("Electranix_Init_DCLink")
  {
  Desc = "Initialization of DC Links"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Choice("RTapSide",5,4,265,44,2)
     {
     Style = 1
     Desc = "Which winding is the Rectifier tap changer on? (E-TRAN reads in this data)"
     Def = "0"
     Len = 15
     *0 = "Primary (AC Side) (this is the PSS/E default)"
     *1 = "Secondary (Valve Side)"
     }
    Choice("ITapSide",5,48,264,44,2)
     {
     Style = 1
     Desc = "Which winding is the Inverter tap changer on? (E-TRAN reads in this data)"
     Def = "0"
     Len = 15
     *0 = "Primary (AC Side) (this is the PSS/E default)"
     *1 = "Secondary (Valve Side)"
     }
    Input("TapR",5,96,265,12,2)
     {
     Desc = "Rectifier DC Tap (E-TRAN sets this from Loadflow)"
     Def = "1.0"
     Data = Real
     Len = 15
     }
    Input("TapI",5,112,265,12,2)
     {
     Desc = "Inverter DC Tap (E-TRAN sets this from Loadflow)"
     Def = "1.0"
     Data = Real
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Output("TapIOut",72,0)
    {
    Type = Real
    }
   Output("TapROut",72,-18)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Pen(Real,Real,ByNode,TapROut)
   Line(55,0,72,0)
   Line(55,-18,72,-18)
   Pen(Fuchsia,Solid,0.4)
   Rectangle(-88,-39,55,7)
   Font(,,Right)
   Cond = "RTapSide==0"
   Text(54,-15,"Rect Tap (Prim)")
   Cond = "ITapSide==0"
   Text(54,2,"Inv Tap (Prim)")
   Font(,,Centre)
   Cond = "true"
   Text(-15,18,"DC Link Tap Settings from Loadflow")
   Text(-82,-27,"E")
   Font(,,Left)
   Text(-87,2,"$TapI")
   Text(-87,-15,"$TapR")
   Font(,,Right)
   Cond = "RTapSide==1"
   Text(54,-15,"Rect Tap (Sec)")
   Cond = "ITapSide==1"
   Text(54,2,"Inv Tap (Sec)")
   }

  Section(EMTDC)
   {
   Fortran = "\
      $TapROut = $TapR
      $TapIOut = $TapI
"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Initialize"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Common Block Transfer - Output

Transfers Information from one page to another
     - Integer, Real or Boolean Variables Supported
     - Multiple Inputs or Outputs allowed
     - Can transfer up to 1000 quantities of each type (I,R or B)"
   }
  }
 Component("Electranix_xfmr_3w")
  {
  Desc = "PSSE Compatible 3 winding transformer"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("Name",5,4,261,12,2)
     {
     Desc = "Transformer Name"
     Def = "T1"
     Len = 15
     }
    Input("Tmva3",5,20,261,12,2)
     {
     Desc = "Transformer MVA (3 phase)"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 1e-006
     }
    Input("f",5,36,261,12,2)
     {
     Desc = "Base Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0.0001
     }
    Choice("Enable",5,56,155,40,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    Choice("V5Format",5,100,154,44,2)
     {
     Style = 1
     Desc = "Use new PSCAD V5 Transformer Format?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    }
   Category("Winding Data")
    {
    Input("V1LL",5,4,261,12,2)
     {
     Desc = "Winding #1 Volts (kV,L-L,rms)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("V2LL",5,20,261,12,2)
     {
     Desc = "Winding #2 Volts (kV,L-L,rms)"
     Def = "115"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("V3LL",5,36,261,12,2)
     {
     Desc = "Tertiary Winding #3 Volts (kV,L-L,rms)"
     Def = "13.8"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("Rw12",5,56,261,12,2)
     {
     Desc = "R12 - Winding Resistance (pu)"
     Def = "0.01"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Xl12",5,72,261,12,2)
     {
     Desc = "X12 - Leakage Reactance (pu)"
     Def = "0.1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Rw23",5,92,261,12,2)
     {
     Desc = "R23 - Winding Resistance (pu)"
     Def = "0.01"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Xl23",5,108,261,12,2)
     {
     Desc = "X23 - Leakage Reactance (pu)"
     Def = "0.1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Rw13",5,128,261,12,2)
     {
     Desc = "R13 - Winding Resistance (pu)"
     Def = "0.01"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Xl13",5,144,260,12,2)
     {
     Desc = "X13 - Leakage Reactance (pu)"
     Def = "0.1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 1
     }
    Choice("Config1",5,164,88,56,2)
     {
     Style = 1
     Desc = "Winding 1 Config"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "Star"
     *1 = "Delta-Lag"
     *2 = "Delta-Lead"
     }
    Choice("Config2",101,164,78,56,2)
     {
     Style = 1
     Desc = "Winding 2 Config"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "Star"
     *1 = "Delta-Lag"
     *2 = "Delta-Lead"
     }
    Choice("Config3",187,164,80,56,2)
     {
     Style = 1
     Desc = "Winding 3 Config"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "Star"
     *1 = "Delta-Lag"
     *2 = "Delta-Lead"
     }
    }
   Category("Tap, Shunt Phase Shifter Data")
    {
    Choice("Tap",5,4,109,40,2)
     {
     Style = 1
     Desc = "Tap Changer Enabled?"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Tap1",5,48,261,12,2)
     {
     Desc = "Tap on Winding 1 (0.8<Tap1<1.2)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.8
     Max = 1.2
     Cond = "Tap!=0"
     }
    Input("Tap2",5,64,261,12,2)
     {
     Desc = "Tap on Winding 2 (0.8<Tap2<1.2)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.8
     Max = 1.2
     Cond = "Tap!=0"
     }
    Input("Tap3",5,80,261,12,2)
     {
     Desc = "Tap on Winding 3 (0.8<Tap3<1.2)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.8
     Max = 1.2
     Cond = "Tap!=0"
     }
    Input("XlTable",5,96,261,12,2)
     {
     Desc = "Winding 1 Impedance Correction Table #"
     Def = "0"
     Data = Integer
     Len = 15
     Min = 0
     Max = 100000
     Cond = "(Tap!=0)"
     }
    Input("XlFactor",5,112,261,24,2)
     {
     Desc = "Winding 1 Real Impedance Correction Factor (obtained from Tables)"
     Def = "1.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Input("XlFactj",5,140,260,24,2)
     {
     Desc = "Winding 1 Imag. Impedance Correction Factor (obtained from Tables)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Input("XlTable2",5,168,261,12,2)
     {
     Desc = "Winding 2 Impedance Correction Table #"
     Def = "0"
     Data = Integer
     Len = 15
     Min = 0
     Max = 100000
     Cond = "(Tap!=0)"
     }
    Input("XlFact2",5,184,261,24,2)
     {
     Desc = "Winding 2 Real Impedance Correction Factor (obtained from Tables)"
     Def = "1.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Input("XlFact2j",5,212,260,24,2)
     {
     Desc = "Winding 2 Imag. Impedance Correction Factor (obtained from Tables)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Input("XlTable3",5,240,261,12,2)
     {
     Desc = "Winding 3 Impedance Correction Table #"
     Def = "0"
     Data = Integer
     Len = 15
     Min = 0
     Max = 100000
     Cond = "(Tap!=0)"
     }
    Input("XlFact3",5,256,261,24,2)
     {
     Desc = "Winding 3 Real Impedance Correction Factor (obtained from Tables)"
     Def = "1.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Input("XlFact3j",5,284,260,24,2)
     {
     Desc = "Winding 3 Imag. Impedance Correction Factor (obtained from Tables)"
     Def = "0.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Max = 2
     Cond = "(Tap!=0)"
     }
    Choice("ZCOD",5,310,260,11,2)
     {
     Style = 0
     Desc = "Impedance Correction Method"
     Def = "1"
     Len = 25
     Cond = "(Tap!=0)"
     *0 = "Apply to Windings"
     *1 = "Apply to Bus-to-Bus"
     }
    }
   Category("Saturation")
    {
    Choice("Enab",5,4,146,56,2)
     {
     Style = 1
     Desc = "Enable Saturation?"
     Def = "0"
     Len = 15
     *0 = "No (can be enabled from a snapshot)"
     *1 = "Yes"
     }
    Choice("Sat",165,4,105,56,2)
     {
     Style = 1
     Desc = "Place saturation on winding:"
     Def = "1"
     Len = 15
     *1 = "#1"
     *2 = "#2"
     *3 = "#3"
     }
    Input("Xair",5,64,265,12,2)
     {
     Desc = "Air core reactance (pu)"
     Def = "0.2"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0.001
     Max = 10
     }
    Input("Tdc",5,80,265,12,2)
     {
     Desc = "Inrush decay time constant (sec)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0.001
     }
    Input("Xknee",5,96,265,12,2)
     {
     Desc = "Knee voltage(pu)"
     Def = "1.25"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("Txk",5,112,265,12,2)
     {
     Desc = "Time to release flux clipping"
     Def = "0.1"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0
     Max = 1e+006
     }
    Input("Im1",5,128,265,12,2)
     {
     Desc = "Magnetizing current"
     Def = "0.4"
     Data = Real
     Unit = "%"
     Len = 15
     Min = 0.0001
     Max = 50
     }
    }
   Category("Monitoring of Currents and Flux")
    {
    Text("IL1",5,4,261,24,2)
     {
     Desc = "Name for winding #1 line currents (kA,into winding, not including inrush current)"
     Len = 23
     }
    Text("IL2",5,32,261,24,2)
     {
     Desc = "Name for winding #2 line currents (kA,into winding, not including inrush current)"
     Len = 23
     }
    Text("IL3",5,60,261,24,2)
     {
     Desc = "Name for winding #3 line currents (kA,into winding, not including inrush current)"
     Len = 23
     }
    Text("IMAG",5,88,261,12,2)
     {
     Desc = "Name for magnetizing currents (kA)"
     Len = 23
     }
    Text("FLUX",5,104,261,12,2)
     {
     Desc = "Name for flux linkages (kWb-N)"
     Len = 23
     }
    }
   }

  Nodes = 
   {
   Electrical("N22",54,0)
    {
    Cond = "Enable==1"
    Dim  = [3]
    }
   Electrical("N11",-54,0)
    {
    Cond = "Enable==1"
    Dim  = [3]
    }
   Electrical("N2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   Electrical("N1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   Electrical("N33",0,18)
    {
    Cond = "Enable==1"
    Dim  = [3]
    }
   Electrical("N3",0,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   Electrical("N1",-18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   Electrical("N3",0,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   Electrical("N2",18,0)
    {
    Cond = "(Enable==1)&&(((ABS(Rw12)>0.0)||(ABS(Rw23)>0.0)||(ABS(Rw13)>0.0))&&(V5Format==0))"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-27,-12,27,10)
   Brush(Hollow)
   Ellipse(-4,-10,16,10)
   Ellipse(-16,-10,4,10)
   Line(-54,0,-16,0)
   Line(16,0,54,0)
   Cond = "(Config1!=0)"
   Line(-12,6,-9,1)
   Line(-6,6,-12,6)
   Cond = "(Config2!=0)"
   Line(6,6,9,1)
   Line(12,6,6,6)
   Cond = "(Config1!=0)"
   Line(-9,1,-6,6)
   Cond = "(Config2!=0)"
   Line(9,1,12,6)
   Pen(,,0.6)
   Cond = "true"
   Line(-54,0,-16,0)
   Ellipse(-16,-10,4,10)
   Ellipse(-4,-10,16,10)
   Line(16,0,54,0)
   Line(0,18,0,7)
   Pen(,,0.2)
   Cond = "(Config3!=0)"
   Line(2,16,5,11)
   Line(8,16,2,16)
   Line(5,11,8,16)
   Cond = "true"
   Text(24,-12,"$V2LL")
   Text(-24,-12,"$V1LL")
   Text(0,-12,":")
   Text(-8,1,"1")
   Text(-5,19,"3")
   Text(10,1,"2")
   Text(-29,17,"$V3LL")
   Text(20,12,"E")
   Cond = "(Config3==0)"
   Line(5,18,10,13)
   Line(5,18,1,12)
   Line(5,24,5,18)
   Line(5,18,9,18)
   Line(9,15,9,21)
   Line(10,16,10,20)
   Line(11,17,11,19)
   Cond = "(Config2==0)"
   Line(7,6,12,1)
   Line(7,6,3,0)
   Line(7,12,7,6)
   Line(7,6,11,6)
   Line(11,3,11,9)
   Line(12,4,12,8)
   Line(13,5,13,7)
   Cond = "(Config1==0)"
   Line(-11,5,-6,0)
   Line(-11,5,-15,-1)
   Line(-11,11,-11,5)
   Line(-11,5,-7,5)
   Line(-7,2,-7,8)
   Line(-6,3,-6,7)
   Line(-5,4,-5,6)
   }

  Section(EMTDC)
   {
   Computations = "\
INTEGER Type1=Config1
INTEGER Type2=Config2
INTEGER Type3=Config3
INTEGER Ideal=1
INTEGER NCW = -3
REAL    V1=(Type1==0) ? V1LL/sqrt(3.0) : V1LL
REAL    V2=(Type2==0) ? V2LL/sqrt(3.0) : V2LL
REAL    V3=(Type3==0) ? V3LL/sqrt(3.0) : V3LL
REAL    Tmva=Tmva3/3.0
REAL    Xlcorr= (Tap!=0) ? XlFactor : 1.0
REAL    Xlcorrj= (Tap!=0) ? XlFactj : 1.0
REAL    Xlcorr2= (Tap!=0) ? XlFact2 : 1.0
REAL    Xlcorr2j= (Tap!=0) ? XlFact2j : 1.0
REAL    Xlcorr3= (Tap!=0) ? XlFact3 : 1.0
REAL    Xlcorr3j= (Tap!=0) ? XlFact3j : 1.0
REAL    I_m1= Im1*0.01
REAL    I_m2= I_m1
REAL    I_m3= I_m1
REAL    w   = 2*pi*f
REAL    ib1 = Tmva/(V1*Tap1)
REAL    ib2 = Tmva/(V2*Tap2)
REAL    ib3 = Tmva/(V3*Tap3)
REAL    zb1 = (V1*Tap1)/ib1
REAL    zb2 = (V2*Tap2)/ib2
REAL    zb3 = (V3*Tap3)/ib3
REAL    A12 = (V1*Tap1)/(V2*Tap2)
REAL    A13 = (V1*Tap1)/(V3*Tap3)
REAL    A22 = A12*A12
REAL    A23 = A12*A13
REAL    A33 = A13*A13
REAL    ZBASE1   = (V1LL*Tap1*V1LL*Tap1)/Tmva3
REAL    ZBASE2   = (V2LL*Tap2*V2LL*Tap2)/Tmva3
REAL    ZBASE3   = (V3LL*Tap3*V3LL*Tap3)/Tmva3
REAL    Xl12C = (ZCOD==1) ? (Xl12*Xlcorr  + Rw12*Xlcorrj ) : Xl12
REAL    Xl23C = (ZCOD==1) ? (Xl23*Xlcorr2 + Rw23*Xlcorr2j) : Xl23
REAL    Xl13C = (ZCOD==1) ? (Xl13*Xlcorr3 + Rw13*Xlcorr3j) : Xl13
REAL    Rw12C = (ZCOD==1) ? (Rw12*Xlcorr  - Xl12*Xlcorrj ) : Rw12
REAL    Rw23C = (ZCOD==1) ? (Rw23*Xlcorr2 - Xl23*Xlcorr2j) : Rw23
REAL    Rw13C = (ZCOD==1) ? (Rw13*Xlcorr3 - Xl13*Xlcorr3j) : Rw13
REAL    XX1temp = (Xl13C-Xl23C+Xl12C)/2
REAL    XX2temp = (Xl23C-Xl13C+Xl12C)/2
REAL    XX3temp = (Xl13C-Xl12C+Xl23C)/2
REAL    Rw1temp = (Rw13C-Rw23C+Rw12C)/2
REAL    Rw2temp = (Rw23C-Rw13C+Rw12C)/2
REAL    Rw3temp = (Rw13C-Rw12C+Rw23C)/2
REAL    XX1  = (ZCOD==1) ? XX1temp        : (XX1temp*Xlcorr  + Rw1temp*Xlcorrj )
REAL    XX2  = (ZCOD==1) ? XX2temp        : (XX2temp*Xlcorr2 + Rw2temp*Xlcorr2j)
REAL    XX3  = (ZCOD==1) ? XX3temp        : (XX3temp*Xlcorr3 + Rw3temp*Xlcorr2j)
REAL    Rw1t = (ZCOD==1) ? Rw1temp*ZBASE1 : (Rw1temp*Xlcorr  - XX1temp*Xlcorrj )*ZBASE1
REAL    Rw2t = (ZCOD==1) ? Rw2temp*ZBASE2 : (Rw2temp*Xlcorr2 - XX2temp*Xlcorr2j)*ZBASE2
REAL    Rw3t = (ZCOD==1) ? Rw3temp*ZBASE3 : (Rw3temp*Xlcorr3 - XX3temp*Xlcorr3j)*ZBASE3
REAL    Rw1  = Rw1t>=1.0E-6 ? Rw1t : 0.0
REAL    Rw2  = Rw2t>=1.0E-6 ? Rw2t : 0.0
REAL    Rw3  = Rw3t>=1.0E-6 ? Rw3t : 0.0
REAL    LL1 = XX1*zb1/w
REAL    LL2 = XX2*zb1/w
REAL    LL3 = XX3*zb1/w
REAL    LL  = LL1*LL2 + LL2*LL3 + LL1*LL3
REAL    L1  = (LL2+LL3)/LL
REAL    L2  = (LL1+LL3)*A22/LL
REAL    L3  = (LL1+LL2)*A33/LL
REAL    L12 = -A12*LL3/LL
REAL    L13 = -A13*LL2/LL
REAL    L23 = -A23*LL1/LL
REAL    YBASE1   = Tmva3/(V1LL*Tap1*V1LL*Tap1)
REAL    YBASE2   = Tmva3/(V2LL*Tap2*V2LL*Tap2)
REAL    YBASE3   = Tmva3/(V3LL*Tap3*V3LL*Tap3)
REAL    RSHD1    = V1LL*V1LL/(0.0005*Tmva)
REAL    RSHD2    = V2LL*V2LL/(0.0005*Tmva)
REAL    RSHD3    = V3LL*V3LL/(0.0005*Tmva)
REAL    Rw1V5    = Rw1>=1.0E-6 ? (Type1==0 ? Rw1 : (3.0*Rw1)) : 0.0
REAL    Rw2V5    = Rw2>=1.0E-6 ? (Type2==0 ? Rw2 : (3.0*Rw2)) : 0.0
REAL    Rw3V5    = Rw3>=1.0E-6 ? (Type3==0 ? Rw3 : (3.0*Rw3)) : 0.0"
   Transformers = "\
#IF Enable==1
C   PSSE Compatible Single Phase Transformer:   $Tmva3 MVA, $V1LL kV,LL : $V2LL kV,LL : $V3LL kV,LL
C Normal Transformer (not phase shifters) 
 #TRANSFORMERS 3
 #WINDINGS 3
 #IF ( ( (ABS(Rw12)>0.0) || (ABS(Rw23)>0.0) || (ABS(Rw13)>0.0) ) && (V5Format==0) )
C Winding R > 0.0 and old format
C 3 Phase SLD
   $NCW / Number of windings...
   #IF Type1==0
    $N1(1) 0      $L1 /
   #ELSEIF Type1==1
    $N1(1) $N1(2)    $L1 /
   #ELSEIF Type1==2
    $N1(1) $N1(3)    $L1 /
   #ENDIF
   #IF Type2==0
    $N2(1) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N2(1) $N2(2)    $L12   $L2 /
   #ELSEIF Type2==2
    $N2(1) $N2(3)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N3(1) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N3(1) $N3(2)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N3(1) $N3(3)    $L13   $L23   $L3 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N1(2) 0      $L1 /
   #ELSEIF Type1==1
    $N1(2) $N1(3)    $L1 /
   #ELSEIF Type1==2
    $N1(2) $N1(1)    $L1 /
   #ENDIF
   #IF Type2==0
    $N2(2) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N2(2) $N2(3)    $L12   $L2 /
   #ELSEIF Type2==2
    $N2(2) $N2(1)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N3(2) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N3(2) $N3(3)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N3(2) $N3(1)    $L13   $L23   $L3 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N1(3) 0      $L1 /
   #ELSEIF Type1==1
    $N1(3) $N1(1)    $L1 /
   #ELSEIF Type1==2
    $N1(3) $N1(2)    $L1 /
   #ENDIF
   #IF Type2==0
    $N2(3) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N2(3) $N2(1)    $L12   $L2 /
   #ELSEIF Type2==2
    $N2(3) $N2(2)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N3(3) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N3(3) $N3(1)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N3(3) $N3(2)    $L13   $L23   $L3 /
   #ENDIF
 #ELSE
  #IF (V5Format==0)
C Winding R = 0.0 - old format
C 3 Phase SLD
   $NCW / Number of windings...
   #IF Type1==0
    $N11(1) 0      $L1 /
   #ELSEIF Type1==1
    $N11(1) $N11(2)    $L1 /
   #ELSEIF Type1==2
    $N11(1) $N11(3)    $L1 /
   #ENDIF
   #IF Type2==0
    $N22(1) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N22(1) $N22(2)    $L12   $L2 /
   #ELSEIF Type2==2
    $N22(1) $N22(3)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N33(1) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N33(1) $N33(2)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N33(1) $N33(3)    $L13   $L23   $L3 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N11(2) 0      $L1 /
   #ELSEIF Type1==1
    $N11(2) $N11(3)    $L1 /
   #ELSEIF Type1==2
    $N11(2) $N11(1)    $L1 /
   #ENDIF
   #IF Type2==0
    $N22(2) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N22(2) $N22(3)    $L12   $L2 /
   #ELSEIF Type2==2
    $N22(2) $N22(1)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N33(2) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N33(2) $N33(3)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N33(2) $N33(1)    $L13   $L23   $L3 /
   #ENDIF
   $NCW / Number of windings...
   #IF Type1==0
    $N11(3) 0      $L1 /
   #ELSEIF Type1==1
    $N11(3) $N11(1)    $L1 /
   #ELSEIF Type1==2
    $N11(3) $N11(2)    $L1 /
   #ENDIF
   #IF Type2==0
    $N22(3) 0      $L12   $L2 /
   #ELSEIF Type2==1
    $N22(3) $N22(1)    $L12   $L2 /
   #ELSEIF Type2==2
    $N22(3) $N22(2)    $L12   $L2 /
   #ENDIF
   #IF Type3==0
    $N33(3) 0      $L13   $L23   $L3 /
   #ELSEIF Type3==1
    $N33(3) $N33(1)    $L13   $L23   $L3 /
   #ELSEIF Type3==2
    $N33(3) $N33(2)    $L13   $L23   $L3 /
   #ENDIF
  #ELSE
C new format
C 3 Phase SLD
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(1) 0     $Rw1V5 $L1 /
   #ELSEIF Type1==1
    $N11(1) $N11(2)    $Rw1V5 $L1 /
   #ELSEIF Type1==2
    $N11(1) $N11(3)    $Rw1V5 $L1 /
   #ENDIF
   #IF Type2==0
    $N22(1) 0      0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==1
    $N22(1) $N22(2)    0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==2
    $N22(1) $N22(3)    0.0 $L12   $Rw2V5 $L2 /
   #ENDIF
   #IF Type3==0
    $N33(1) 0      0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==1
    $N33(1) $N33(2)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==2
    $N33(1) $N33(3)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(2) 0      $Rw1V5 $L1 /
   #ELSEIF Type1==1
    $N11(2) $N11(3)    $Rw1V5 $L1 /
   #ELSEIF Type1==2
    $N11(2) $N11(1)    $Rw1V5 $L1 /
   #ENDIF
   #IF Type2==0
    $N22(2) 0      0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==1
    $N22(2) $N22(3)    0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==2
    $N22(2) $N22(1)    0.0 $L12   $Rw2V5 $L2 /
   #ENDIF
   #IF Type3==0
    $N33(2) 0      0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==1
    $N33(2) $N33(3)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==2
    $N33(2) $N33(1)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ENDIF
   $NCW -1/ Number of windings...
   #IF Type1==0
    $N11(3) 0      $Rw1V5 $L1 /
   #ELSEIF Type1==1
    $N11(3) $N11(1)    $Rw1V5 $L1 /
   #ELSEIF Type1==2
    $N11(3) $N11(2)    $Rw1V5 $L1 /
   #ENDIF
   #IF Type2==0
    $N22(3) 0      0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==1
    $N22(3) $N22(1)    0.0 $L12   $Rw2V5 $L2 /
   #ELSEIF Type2==2
    $N22(3) $N22(2)    0.0 $L12   $Rw2V5 $L2 /
   #ENDIF
   #IF Type3==0
    $N33(3) 0      0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==1
    $N33(3) $N33(1)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ELSEIF Type3==2
    $N33(3) $N33(2)    0.0 $L13   0.0 $L23   $Rw3V5 $L3 /
   #ENDIF
  #ENDIF
 #ENDIF
#ENDIF
"
   Matrix-fill = "\
#IF Enable==1
 #IF ( ( (ABS(Rw12)>0.0) || (ABS(Rw23)>0.0) || (ABS(Rw13)>0.0) ) && (V5Format==0) )
   $N1(1) $N11(1)
   $N2(1) $N22(1)
   $N1(2) $N11(2)
   $N2(2) $N22(2)
   $N1(3) $N11(3)
   $N2(3) $N22(3)
   #IF (Type1==0)&&(Type2==0)
    $N1(1) $N2(1)
    $N1(2) $N2(2)
    $N1(3) $N2(3)
   #ELSE
    $N1(1) $N2(1) $N1(2) $N2(2) $N1(3) $N2(3)
   #ENDIF
 #ELSE
    #IF (Type1==0)&&(Type2==0)&&(Type3==0)
     $N11(1) $N22(1) $N33(1)
     $N11(2) $N22(2) $N33(2)
     $N11(3) $N22(3) $N33(3)
    #ELSE
     $N11(1) $N22(1) $N33(1) $N11(2) $N22(2) $N33(2) $N11(3) $N22(3) $N33(3)
    #ENDIF
 #ENDIF
#ENDIF"
   Dsdyn = "\
#IF Enable==1

#STORAGE STOR:63


!  TRANSFORMER SATURATION SUBROUTINE
#SUBROUTINE TSAT21 Transformer Saturation Subroutine
#LOCAL REAL X_KNEE
#If Txk>0
      IF (TIME.GT.$Txk) THEN
         X_KNEE = $Xknee
      ELSE
         X_KNEE = -$Xknee
      ENDIF
#ELSE
      X_KNEE = $Xknee
#ENDIF
#IF Sat==1
     #IF Type1==0
      CALL TSAT21($N11(1),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),0, 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==1
      CALL TSAT21($N11(1),$N11(2), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),$N11(3), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),$N11(1), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ELSEIF Type1==2
      CALL TSAT21($N11(1),$N11(3), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(2),$N11(1), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
      CALL TSAT21($N11(3),$N11(2), 0,0, 0,0, $SS,
     +     $Tmva,$V1,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
    #ENDIF
    #OUTPUT REAL IMAG 3 {-STOR(NEXC-21+17)} {-STOR(NEXC-21*2+17)} {-STOR(NEXC-21*3+17)}
    #OUTPUT REAL FLUX 3 { STOR(NEXC-21+11)} { STOR(NEXC-21*2+11)} { STOR(NEXC-21*3+11)}
#ELSE IF Sat==2
     #IF Type2==0
      CALL TSAT21($N22(1),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),0, 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==1
      CALL TSAT21($N22(1),$N22(2), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),$N22(3), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),$N22(1), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ELSEIF Type2==2
      CALL TSAT21($N22(1),$N22(3), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(2),$N22(1), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
      CALL TSAT21($N22(3),$N22(2), 0,0, 0,0, $SS,
     +     $Tmva,$V2,$Xair,X_KNEE,$f,$Tdc,$I_m2, 0.0, $Enab)
     #ENDIF
    #OUTPUT REAL IMAG 3 {-STOR(NEXC-21+17)} {-STOR(NEXC-21*2+17)} {-STOR(NEXC-21*3+17)}
    #OUTPUT REAL FLUX 3 { STOR(NEXC-21+11)} { STOR(NEXC-21*2+11)} { STOR(NEXC-21*3+11)}
#ELSE
     #IF Type3==0
      CALL TSAT21($N33(1),0, 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(2),0, 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(3),0, 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
     #ELSEIF Type3==1
      CALL TSAT21($N33(1),$N33(2), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(2),$N33(3), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(3),$N33(1), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
     #ELSEIF Type3==2
      CALL TSAT21($N33(1),$N33(3), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(2),$N33(1), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
      CALL TSAT21($N33(3),$N33(2), 0,0, 0,0, $SS,
     +     $Tmva,$V3,$Xair,X_KNEE,$f,$Tdc,$I_m3, 0.0, $Enab)
     #ENDIF
    #OUTPUT REAL IMAG 3 {-STOR(NEXC-21+17)} {-STOR(NEXC-21*2+17)} {-STOR(NEXC-21*3+17)}
    #OUTPUT REAL FLUX 3 { STOR(NEXC-21+11)} { STOR(NEXC-21*2+11)} { STOR(NEXC-21*3+11)}
#ENDIF
!
#ELSE
    #OUTPUT REAL IMAG 3 {0.0} {0.0} {0.0}
    #OUTPUT REAL FLUX 3 {0.0} {0.0} {0.0}
#ENDIF


"
   Dsout = "\
#IF Enable==1
    #IF Type1==0
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])} {CDCTR(1,$#[2])} {CDCTR(1,$#[3])}
    #ELSEIF Type1==1
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])-CDCTR(1,$#[3])} {CDCTR(1,$#[2])-CDCTR(1,$#[1])} {CDCTR(1,$#[3])-CDCTR(1,$#[2])}
    #ELSE
     #OUTPUT REAL IL1 3 {CDCTR(1,$#[1])-CDCTR(1,$#[2])} {CDCTR(1,$#[2])-CDCTR(1,$#[3])} {CDCTR(1,$#[3])-CDCTR(1,$#[1])}
    #ENDIF

    #IF Type2==0
     #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])} {CDCTR(2,$#[2])} {CDCTR(2,$#[3])}
    #ELSEIF Type2==1
     #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])-CDCTR(2,$#[3])} {CDCTR(2,$#[2])-CDCTR(2,$#[1])} {CDCTR(2,$#[3])-CDCTR(2,$#[2])}
    #ELSE
     #OUTPUT REAL IL2 3 {CDCTR(2,$#[1])-CDCTR(2,$#[2])} {CDCTR(2,$#[2])-CDCTR(2,$#[3])} {CDCTR(2,$#[3])-CDCTR(2,$#[1])}
    #ENDIF

    #IF Type3==0
     #OUTPUT REAL IL3 3 {CDCTR(3,$#[1])} {CDCTR(3,$#[2])} {CDCTR(3,$#[3])}
    #ELSEIF Type2==1
     #OUTPUT REAL IL3 3 {CDCTR(3,$#[1])-CDCTR(3,$#[3])} {CDCTR(3,$#[2])-CDCTR(3,$#[1])} {CDCTR(3,$#[3])-CDCTR(3,$#[2])}
    #ELSE
     #OUTPUT REAL IL3 3 {CDCTR(3,$#[1])-CDCTR(3,$#[2])} {CDCTR(3,$#[2])-CDCTR(3,$#[3])} {CDCTR(3,$#[3])-CDCTR(3,$#[1])}
    #ENDIF

#ELSE
    #OUTPUT REAL IL1 3  {0.0} {0.0} {0.0}
    #OUTPUT REAL IL2 3  {0.0} {0.0} {0.0}
    #OUTPUT REAL IL3 3  {0.0} {0.0} {0.0}
#ENDIF

"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Transformers"
   Branch = "\
#IF Enable==1
  #IF ( ( (ABS(Rw12)>0.0) || (ABS(Rw23)>0.0) || (ABS(Rw13)>0.0) ) && (V5Format==0) )
   #IF (Rw1>1.0E-8)
    $N11(1)  $N1(1)  $Rw1 0.0 0.0
    $N11(2)  $N1(2)  $Rw1 0.0 0.0
    $N11(3)  $N1(3)  $Rw1 0.0 0.0
   #ELSE
    $N11(1)  $N1(1)  AMMETER
    $N11(2)  $N1(2)  AMMETER
    $N11(3)  $N1(3)  AMMETER
   #ENDIF
   #IF (Rw2>1.0E-8)
    $N22(1)  $N2(1)  $Rw2 0.0 0.0
    $N22(2)  $N2(2)  $Rw2 0.0 0.0
    $N22(3)  $N2(3)  $Rw2 0.0 0.0
   #ELSE
    $N22(1)  $N2(1)  AMMETER
    $N22(2)  $N2(2)  AMMETER
    $N22(3)  $N2(3)  AMMETER
   #ENDIF
   #IF (Rw3>1.0E-8)
    $N33(1)  $N3(1)  $Rw3 0.0 0.0
    $N33(2)  $N3(2)  $Rw3 0.0 0.0
    $N33(3)  $N3(3)  $Rw3 0.0 0.0
   #ELSE
    $N33(1)  $N3(1)  AMMETER
    $N33(2)  $N3(2)  AMMETER
    $N33(3)  $N3(3)  AMMETER
   #ENDIF
  #ENDIF
  #IF ( Config1 != 0 )
    $N11(1)  0  $RSHD1 0.0 0.0
    $N11(2)  0  $RSHD1 0.0 0.0
    $N11(3)  0  $RSHD1 0.0 0.0
  #ENDIF
  #IF ( Config2 != 0 )
    $N22(1)  0  $RSHD2 0.0 0.0
    $N22(2)  0  $RSHD2 0.0 0.0
    $N22(3)  0  $RSHD2 0.0 0.0
  #ENDIF
  #IF ( Config3 != 0 )
    $N33(1)  0  $RSHD3 0.0 0.0
    $N33(2)  0  $RSHD3 0.0 0.0
    $N33(3)  0  $RSHD3 0.0 0.0
  #ENDIF
#ENDIF
"
   Checks = "\
#IF Enable==1
WARNING -ve R,X Encountered - Numerical instabilities are possible! : Rw12>=0 && Xl12>=0
WARNING -ve R,X Encountered - Numerical instabilities are possible! : Rw23>=0 && Xl23>=0
WARNING -ve R,X Encountered - Numerical instabilities are possible! : Rw13>=0 && Xl13>=0
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase Transformer Model

Features:
     - Transformer modelled with linear coupled inductances
     - Winding resistance modelled as resistors in series at winding terminals
     - Saturation implemented as a delayed current injection (TSAT21)
     - Phase Shifter Option:
          - Phase Shifter Angle can be changed dynamically during the run
          - Varying frequency supported

:A11
Terminal 1 Electrical Connection
:A22
Terminal 2 Electrical Connection
:A33
Terminal 3 Electrical Connection"
   }
  }
 Component("Electranix_Error")
  {
  Desc = ""
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Choice("Type",5,4,88,38,2)
     {
     Style = 1
     Desc = "Type of Message:"
     Def = "1"
     Len = 15
     *1 = "Warning"
     *2 = "Error (and Stop)"
     }
    Choice("Write1",5,48,248,44,2)
     {
     Style = 1
     Desc = "Write Duplicate Warnings?"
     Def = "0"
     Len = 15
     Cond = "Type==1"
     *0 = "No (write warnings only once)"
     *1 = "Yes (write duplicate warnings each time the input is 1)"
     }
    Text("Message",5,96,301,28,2)
     {
     Desc = "Enter Text for Warning/Error:"
     Def = "Message Text"
     Len = 150
     }
    }
   }

  Nodes = 
   {
   Input("IN",-54,0)
    {
    Type = Integer
    }
   }

  Graphics = 
   {
   Rectangle(-39,-17,69,18)
   Pen(ByNode,ByNode,ByNode,IN)
   Line(-54,0,-39,0)
   Pen(,Solid)
   Line(-39,0,-44,-5)
   Line(-39,0,-44,5)
   Text(-34,17,"E")
   Text(16,-4,"1 to Write Message")
   Cond = "Type==1"
   Text(12,7,"Warning")
   Cond = "Type==2"
   Text(12,8,"Error")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Electranix E-TRAN Warning/Message
      CALL Electranix_WarningError($IN,$Type,$Write1,\"$Message\")"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_remote_vmeas_set")
  {
  Desc = "Measures RMS Voltage for Global Availability"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Input("VBase",5,4,178,12,2)
     {
     Desc = "Base Voltage (kV,L-L,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0
     }
    Input("FINIT",5,20,178,12,6)
     {
     Desc = "Initial Frequency (Hz)"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("BUS",5,36,178,12,2)
     {
     Desc = "PSS/E Bus Index (1-99999)"
     Def = "1"
     Data = Integer
     Len = 15
     Min = 1
     Max = 99999
     }
    Choice("Enable",5,56,101,42,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    }
   }

  Nodes = 
   {
   Input("V",-36,0)
    {
    Type = Real
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-38,-18,32,18)
   Pen(ByNode,,ByNode,V)
   Cond = "true"
   Line(-23,0,-29,-6)
   Line(-23,0,-29,7)
   Pen(,ByNode)
   Line(-36,0,-22,0)
   Pen(Black,Solid,0.2)
   Line(-34,5,-31,-3)
   Pen(Green,,0.4)
   Brush(Hollow)
   Rectangle(-23,-17,32,17)
   Text(-18,-6,"E")
   Text(3,5,"Remote V")
   Text(-28,-4,"3")
   Text(3,-7,"Set")
   Text(4,15,"$BUS")
   }

  Section(EMTDC)
   {
   DSOUT = "\
      #IF Enable==1
       #STORAGE STOR:387
       #STORAGE REAL:153
       #STORAGE INTEGER:18
       #STORAGE COMPLEX:12
       CALL Electranix_Remote_VMeas_Set($BUS,$V,$FINIT,$VBase)
      #ENDIF"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Measurements"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase RMS Meter

Measurement of the following Fundamental Frequency Quantities:
     - Voltage Magnitude (kV,L-L,rms)
     - Current Magnitude (kA,rms)
     - Voltage and Current Phase (Deg)
     - P and Q (MW,MVAR,3 Phase)
     - Bus Frequency (Hz)
:V
Voltage Input (kV,L-G,Instantaneous)
:I
Current Input (kA,Instantaneous)
(Note sign of current will determine direction of P and Q)
:Vrms
Fundamental Frequency Voltage Magnitude (kV,L-L,rms)
:Phase
Fundamental Frequency Voltage Phase (Deg)
:P
Fundamental Frequency Real Power (MW,3 phase)
:Q
Fundamental Frequency Reactive Power (MVAR,3 phase)
"
   }
  }
 Component("Electranix_remote_vmeas_get")
  {
  Desc = "Get RMS Voltage from Remote Bus"
  FileDate = 0
  Parameters = 
   {
   Category("Main Configuration")
    {
    Input("BUS",5,4,155,12,2)
     {
     Desc = "PSS/E Bus Index (1-99999)"
     Def = "1"
     Data = Integer
     Len = 12
     Min = 1
     Max = 99999
     }
    Choice("Enable",5,24,101,42,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    }
   }

  Nodes = 
   {
   Output("VO",36,0)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "Enable==0"
   Rectangle(-30,-18,38,17)
   Pen(Green,,0.4)
   Brush(Hollow)
   Cond = "true"
   Rectangle(-30,-17,25,17)
   Pen(Black,,0.2)
   Line(25,0,36,0)
   Text(-25,-6,"E")
   Text(-1,15,"$BUS")
   Text(-2,5,"Remote V")
   Text(-2,-7,"Get")
   }

  Section(EMTDC)
   {
   DSOUT = "\
      #IF Enable==1
       #STORAGE STOR:387
       #STORAGE REAL:153
       #STORAGE INTEGER:18
       #STORAGE COMPLEX:12
       CALL Electranix_Remote_VMeas_Get($BUS,$VO)
      #ENDIF"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Measurements"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Singe Phase RMS Meter

Measurement of the following Fundamental Frequency Quantities:
     - Voltage Magnitude (kV,L-L,rms)
     - Current Magnitude (kA,rms)
     - Voltage and Current Phase (Deg)
     - P and Q (MW,MVAR,3 Phase)
     - Bus Frequency (Hz)
:V
Voltage Input (kV,L-G,Instantaneous)
:I
Current Input (kA,Instantaneous)
(Note sign of current will determine direction of P and Q)
:Vrms
Fundamental Frequency Voltage Magnitude (kV,L-L,rms)
:Phase
Fundamental Frequency Voltage Phase (Deg)
:P
Fundamental Frequency Real Power (MW,3 phase)
:Q
Fundamental Frequency Reactive Power (MVAR,3 phase)
"
   }
  }
 Component("Electranix_PSSE_Exciter_Models")
  {
  Desc = "PSSE Compatible Exciter Models"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,274,24,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "..\\inputfile.dyr"
     Len = 150
     }
    Choice("Model",5,32,274,11,2)
     {
     Style = 0
     Desc = "Exciter Model"
     Def = "48"
     Len = 15
     *48 = "AC7B"
     *50 = "AC8B"
     *52 = "DC3A"
     *53 = "DC4B"
     *54 = "EMAC1T"
     *0 = "ESAC1A"
     *1 = "ESAC2A"
     *2 = "ESAC3A"
     *3 = "ESAC4A"
     *4 = "ESAC5A"
     *5 = "ESAC6A"
     *6 = "ESAC8B"
     *7 = "ESDC1A"
     *8 = "ESDC2A"
     *9 = "ESST1A"
     *10 = "ESST2A"
     *11 = "ESST3A"
     *12 = "ESST4B"
     *13 = "EX2000"
     *14 = "EXAC1"
     *15 = "EXAC1A"
     *16 = "EXAC2"
     *17 = "EXAC3"
     *18 = "EXAC4"
     *19 = "EXBAS"
     *20 = "EXDC2"
     *21 = "EXELI"
     *22 = "EXPIC1"
     *23 = "EXST1"
     *24 = "EXST2"
     *25 = "EXST2A"
     *26 = "EXST3"
     *27 = "IEEET1"
     *28 = "IEET1A"
     *29 = "IEET1B"
     *30 = "IEEET2"
     *31 = "IEEET3"
     *32 = "IEEET4"
     *33 = "IEEET5"
     *34 = "IEET5A"
     *35 = "IEEEX1"
     *36 = "IEEEX2"
     *37 = "IEEX2A"
     *38 = "IEEEX3"
     *39 = "IEEEX4"
     *44 = "OEX3T"
     *45 = "REXSYS"
     *46 = "REXSY1"
     *40 = "SCRX"
     *41 = "SEXS"
     *49 = "ST5B"
     *47 = "ST6B"
     *51 = "ST7B"
     *42 = "URST5B"
     *43 = "URST5T"
     }
    Input("Bus",5,48,274,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,64,274,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Choice("VUEL",9,80,270,12,2)
     {
     Style = 0
     Desc = "Under Excitation Limiter?"
     Def = "0"
     Len = 15
     *0 = "none "
     *1 = "MNLEX1"
     *2 = "MNLEX2"
     *3 = "MNLEX3"
     }
    Choice("VOEL",5,96,274,12,2)
     {
     Style = 0
     Desc = "Over Excitation Limiter?"
     Def = "0"
     Len = 15
     Cond = "Model!=13"
     *0 = "none "
     *1 = "MAXEX1"
     *2 = "MAXEX2"
     }
    Choice("Comp",5,112,274,12,2)
     {
     Style = 0
     Desc = "Voltage Compounding Model:"
     Def = "0"
     Len = 40
     *0 = "none (control local VTerminal)"
     *1 = "COMP ( Vc = Vt + jX * I )"
     *2 = "COMPCC"
     *3 = "IEEEVC ( Vc = Vt + (R + jX) * I )"
     *4 = "REMCMP (Control a Remote Bus Voltage)"
     }
    Input("QELEC",9,128,270,12,6)
     {
     Desc = "QELEC (pu on Machine MVA - can be a variable)"
     Def = "Q"
     Data = Real
     Len = 15
     Cond = "Model==13"
     }
    Input("Wpu",5,144,274,12,6)
     {
     Desc = "Speed (pu - can be a variable)"
     Def = "Wpu"
     Data = Real
     Len = 15
     Cond = "Model==13"
     }
    }
   }

  Nodes = 
   {
   Input("Enab",-18,-54)
    {
    Type = Integer
    }
   Input("IFD",18,54)
    {
    Type = Real
    }
   Input("EF0",-54,18)
    {
    Type = Real
    }
   Output("EF",-18,54)
    {
    Type = Real
    }
   Input("VREF",18,-54)
    {
    Type = Real
    }
   Input("VIT",54,18)
    {
    Type = Real
    Dim  = [3]
    }
   Input("VS",-54,-18)
    {
    Type = Real
    }
   Output("VCOMP",-54,-54)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Line(-18,-37,-18,-53)
   Line(41,18,54,18)
   Line(47,13,41,18)
   Line(41,18,47,23)
   Line(61,47,63,47)
   Line(63,47,63,24)
   Line(63,24,61,24)
   Line(48,47,46,47)
   Line(46,47,46,24)
   Line(47,21,61,21)
   Line(50,38,58,38)
   Line(47,16,51,20)
   Line(18,36,18,54)
   Line(13,41,18,36)
   Line(18,36,23,41)
   Line(-18,36,-18,54)
   Line(-41,18,-54,18)
   Line(-47,13,-41,18)
   Line(-41,18,-47,23)
   Line(18,-36,18,-54)
   Line(13,-41,18,-36)
   Line(18,-36,23,-41)
   Line(-54,-18,-41,-18)
   Line(-47,-23,-41,-18)
   Line(-41,-18,-47,-12)
   Rectangle(-41,-36,41,36)
   Line(-23,-41,-18,-36)
   Line(-18,-36,-13,-41)
   Line(-54,-41,-41,-33)
   Line(-54,-53,-54,-41)
   Text(-36,34,"E")
   Text(-1,-41,"Enab")
   Text(55,36,"VT")
   Text(55,49,"IT")
   Text(51,21,"3")
   Text(30,50,"IF")
   Text(-28,49,"EF")
   Text(-53,31,"EF0")
   Text(34,-41,"Vref")
   Text(-53,-5,"VS")
   Cond = "Model==0"
   Text(-1,-17,"ESAC1A")
   Cond = "Model==1"
   Text(-1,-17,"ESAC2A")
   Cond = "Model==2"
   Text(-1,-17,"ESAC3A")
   Cond = "Model==3"
   Text(-1,-17,"ESAC4A")
   Cond = "Model==4"
   Text(-1,-17,"ESAC5A")
   Cond = "Model==5"
   Text(-1,-17,"ESAC6A")
   Cond = "Model==6"
   Text(-1,-17,"ESAC8B")
   Cond = "Model==7"
   Text(-1,-17,"ESDC1A")
   Cond = "Model==8"
   Text(-1,-17,"ESDC2A")
   Cond = "Model==9"
   Text(-1,-17,"ESST1A")
   Cond = "Model==10"
   Text(-1,-17,"ESST2A")
   Cond = "Model==11"
   Text(-1,-17,"ESST3A")
   Cond = "Model==12"
   Text(-1,-17,"ESST4B")
   Cond = "Model==13"
   Text(-1,-17,"EX2000")
   Cond = "Model==14"
   Text(-3,-17,"EXAC1")
   Cond = "Model==15"
   Text(-1,-17,"EXAC1A")
   Cond = "Model==16"
   Text(-3,-17,"EXAC2")
   Cond = "Model==17"
   Text(-3,-17,"EXAC3")
   Cond = "Model==18"
   Text(-3,-17,"EXAC4")
   Cond = "Model==19"
   Text(-3,-17,"EXBAS")
   Cond = "Model==20"
   Text(-3,-17,"EXDC2")
   Cond = "Model==21"
   Text(-3,-17,"EXELI")
   Cond = "Model==22"
   Text(-1,-17,"EXPIC1")
   Cond = "Model==23"
   Text(-3,-17,"EXST1")
   Cond = "Model==24"
   Text(-3,-17,"EXST2")
   Cond = "Model==25"
   Text(-1,-17,"EXST2A")
   Cond = "Model==26"
   Text(-3,-17,"EXST3")
   Cond = "Model==27"
   Text(-1,-17,"IEEET1")
   Cond = "Model==30"
   Text(-1,-17,"IEEET2")
   Cond = "Model==31"
   Text(-1,-17,"IEEET3")
   Cond = "Model==32"
   Text(-1,-17,"IEEET4")
   Cond = "Model==33"
   Text(-1,-17,"IEEET5")
   Cond = "Model==35"
   Text(-1,-17,"IEEEX1")
   Cond = "Model==36"
   Text(-1,-17,"IEEEX2")
   Cond = "Model==38"
   Text(-1,-17,"IEEEX3")
   Cond = "Model==39"
   Text(-1,-17,"IEEEX4")
   Cond = "Model==28"
   Text(-1,-17,"IEET1A")
   Cond = "Model==29"
   Text(-1,-17,"IEET1B")
   Cond = "Model==34"
   Text(-1,-17,"IEET5A")
   Cond = "Model==37"
   Text(-1,-17,"IEEX2A")
   Cond = "Model==40"
   Text(-4,-17,"SCRX")
   Cond = "Model==41"
   Text(-4,-17,"SEXS")
   Cond = "Model==42"
   Text(-1,-17,"URST5B")
   Cond = "Model==43"
   Text(-1,-17,"URST5T")
   Cond = "Model==44"
   Text(-3,-17,"OEX3T")
   Cond = "Model==45"
   Text(-1,-17,"REXSYS")
   Cond = "Model==46"
   Text(-1,-17,"REXSY1")
   Cond = "Model==47"
   Text(-4,-17,"ST6B")
   Cond = "Model==48"
   Text(-4,-17,"AC7B")
   Cond = "Model==49"
   Text(-4,-17,"ST5B")
   Cond = "Model==50"
   Text(-4,-17,"AC8B")
   Cond = "Model==51"
   Text(-4,-17,"ST7B")
   Cond = "Model==52"
   Text(-4,-17,"DC3A")
   Cond = "Model==53"
   Text(-4,-17,"DC4B")
   Cond = "Model==54"
   Text(-1,-17,"EMAC1T")
   Cond = "Comp==1"
   Text(1,-5,"COMP")
   Cond = "Comp==2"
   Text(0,-5,"COMPCC")
   Cond = "Comp==3"
   Text(-1,-5,"IEEEVC")
   Cond = "Comp==4"
   Text(-1,-5,"REMCMP")
   Cond = "true"
   Text(-38,-41,"VCT")
   Cond = "(VUEL==1)"
   Text(0,7,"MNLEX1")
   Cond = "(VUEL==2)"
   Text(-1,7,"MNLEX2")
   Cond = "(VUEL==3)"
   Text(-2,7,"MNLEX3")
   Cond = "(VOEL==1)&&((Model!=13)||(Model!=48))"
   Text(-1,19,"MAXEX1")
   Cond = "(VOEL==2)"
   Text(-2,19,"MAXEX2")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Call E-TRAN Subroutine to read in PSS/E Dynamics data and output to the DATA array...
#IF ( Model == 0 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:27
      CALL Electranix_PSSE_ESAC1A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 1 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:32
      CALL Electranix_PSSE_ESAC2A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 2 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:34
      CALL Electranix_PSSE_ESAC3A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 3 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:10
      CALL Electranix_PSSE_ESAC4A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 4 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:22
      CALL Electranix_PSSE_ESAC5A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 5 )
   #STORAGE STOR:19
   #STORAGE INTEGER:1
   #STORAGE REAL:30
      CALL Electranix_PSSE_ESAC6A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 6 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:19
      CALL Electranix_PSSE_ESAC8B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 7 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:24
      CALL Electranix_PSSE_ESDC1A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 8 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:24
      CALL Electranix_PSSE_ESDC2A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 9 )
   #STORAGE STOR:16
   #STORAGE INTEGER:1
   #STORAGE REAL:21
      CALL Electranix_PSSE_ESST1A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 10 )
   #STORAGE STOR:11
   #STORAGE INTEGER:1
   #STORAGE REAL:16
      CALL Electranix_PSSE_ESST2A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 11 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_ESST3A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 12 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_ESST4B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 13 )
   #STORAGE STOR:11
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:55
      CALL Electranix_PSSE_EX2000($Enab, $Bus, \"$Ckt\", $Comp, $VUEL,       $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, $Wpu, $QELEC, \"$FNAME\")
#ELSEIF ( Model == 14 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_EXAC1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 15 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_EXAC1A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 16 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:33
      CALL Electranix_PSSE_EXAC2($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 17 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:32
      CALL Electranix_PSSE_EXAC3($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 18 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:10
      CALL Electranix_PSSE_EXAC4($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 19 )
   #STORAGE STOR:22
   #STORAGE INTEGER:1
   #STORAGE REAL:29
      CALL Electranix_PSSE_EXBAS($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 20 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:24
      CALL Electranix_PSSE_EXDC2($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 21 )
      CALL Electranix_PSSE_EXELI($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 22 )
   #STORAGE STOR:18
   #STORAGE INTEGER:1
   #STORAGE REAL:39
   #STORAGE LOGICAL:4
      CALL Electranix_PSSE_EXPIC1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 23 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:13
      CALL Electranix_PSSE_EXST1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 24 )
   #STORAGE STOR:11
   #STORAGE INTEGER:1
   #STORAGE REAL:16
      CALL Electranix_PSSE_EXST2($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 25 )
   #STORAGE STOR:11
   #STORAGE INTEGER:1
   #STORAGE REAL:16
      CALL Electranix_PSSE_EXST2A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 26 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_EXST3($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 27 )
   #STORAGE STOR:14
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_IEEET1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 28 )
   #STORAGE STOR:9
   #STORAGE INTEGER:1
   #STORAGE REAL:19
      CALL Electranix_PSSE_IEET1A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 29 )
   #STORAGE STOR:15
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:28
      CALL Electranix_PSSE_IEET1B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 30 )
   #STORAGE STOR:16
   #STORAGE LOGICAL:2
   #STORAGE INTEGER:1
   #STORAGE REAL:22
      CALL Electranix_PSSE_IEEET2($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 31 )
   #STORAGE STOR:10
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:13
      CALL Electranix_PSSE_IEEET3($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 32 )
   #STORAGE STOR:7
   #STORAGE LOGICAL:2
   #STORAGE INTEGER:1
   #STORAGE REAL:17
      CALL Electranix_PSSE_IEEET4($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 33 )
   #STORAGE STOR:7
   #STORAGE LOGICAL:2
   #STORAGE INTEGER:1
   #STORAGE REAL:16
      CALL Electranix_PSSE_IEEET5($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 34 )
   #STORAGE STOR:11
   #STORAGE LOGICAL:2
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_IEET5A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 35 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:24
      CALL Electranix_PSSE_IEEEX1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 36 )
   #STORAGE STOR:19
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_IEEEX2($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 37 )
   #STORAGE STOR:17
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:22
      CALL Electranix_PSSE_IEEX2A($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 38 )
   #STORAGE STOR:10
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:13
      CALL Electranix_PSSE_IEEEX3($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 39 )
   #STORAGE STOR:10
   #STORAGE LOGICAL:1
   #STORAGE INTEGER:1
   #STORAGE REAL:18
      CALL Electranix_PSSE_IEEEX4($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 40 )
   #STORAGE STOR:8
   #STORAGE INTEGER:1
   #STORAGE REAL:8
      CALL Electranix_PSSE_SCRX($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 41 )
   #STORAGE STOR:8
   #STORAGE INTEGER:1
   #STORAGE REAL:6
      CALL Electranix_PSSE_SEXS($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 42 )
      CALL Electranix_PSSE_URST5B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 43 )
   #STORAGE STOR:14
   #STORAGE INTEGER:1
   #STORAGE REAL:10
      CALL Electranix_PSSE_URST5T($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 44 )
   #STORAGE STOR:17
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_OEX3T($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 45 )
   #STORAGE STOR:29
   #STORAGE INTEGER:1
   #STORAGE REAL:41
      CALL Electranix_PSSE_REXSYS($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 46 )
   #STORAGE STOR:29
   #STORAGE INTEGER:1
   #STORAGE REAL:41
      CALL Electranix_PSSE_REXSY1($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 47 )
   #STORAGE STOR:9
   #STORAGE INTEGER:1
   #STORAGE REAL:19
      CALL Electranix_PSSE_ST6B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 48 )
   #STORAGE STOR:18
   #STORAGE INTEGER:1
   #STORAGE REAL:35
      CALL Electranix_PSSE_AC7B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL,        $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSEIF ( Model == 49 )
   #STORAGE STOR:40
   #STORAGE INTEGER:1
   #STORAGE REAL:6
!      CALL GET_STOR_REQUIREMENTS(1)
      CALL Electranix_PSSE_ST5B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
!      CALL GET_STOR_REQUIREMENTS(0)
#ELSEIF ( Model == 50 )
   #STORAGE STOR:18
   #STORAGE INTEGER:1
   #STORAGE REAL:35
      CALL Electranix_PSSE_AC8B($Enab, $Bus, \"$Ckt\", $Comp, $VUEL, $VOEL, $Vref, $VIT, $VS, $EF0, $IFD, $EF, $VCOMP, \"$FNAME\")
#ELSE
      WRITE(6,*) \"***ERROR: - Unsupported Exciter, Model: $Model\"
      STOP
#ENDIF
#IF ( COMP == 1 )
   #STORAGE INTEGER:1
   #STORAGE REAL:1
#ELSEIF ( COMP == 3 )
   #STORAGE INTEGER:1
   #STORAGE REAL:2
#ELSEIF ( COMP == 4 )
   #STORAGE INTEGER:1
   #STORAGE REAL:1
#ENDIF

#IF ( VUEL == 1 )
   #STORAGE STOR:4
   #STORAGE INTEGER:1
   #STORAGE REAL:7
#ELSEIF ( VUEL == 2 )
   #STORAGE STOR:4
   #STORAGE INTEGER:1
   #STORAGE REAL:8
#ELSEIF ( VUEL == 3 )
   #STORAGE STOR:4
   #STORAGE INTEGER:1
   #STORAGE REAL:7
#ENDIF

#IF ( VOEL == 1 )
   #STORAGE INTEGER:1
   #STORAGE REAL:11
#ELSEIF ( VOEL == 2 )
   #STORAGE INTEGER:1
   #STORAGE REAL:13
#ENDIF"
   Branch = ""
   Computations = ""
   }
  Section(Help)
   {
   FlyBy = "\
Electranix PSS/E Compatible Exciters for PSCAD
:EF0
Initial Field Voltage (pu) - Should come from the Machine Model
:EF
Field Voltage (pu) - Output by this model
:VCOMP
Compensated Measured Voltage (pu) - Output by this model
:Enab
Initialization Signal
  0 - Use EF0 to Initialize this model
  1 - Enable this model
:VREF
Voltage Reference (pu) - Used by this model as input
- VRef usually comes from the E-TRAN Initialization component
  and is transferred from the loadflow
- It should be the desired initial voltage (pu)
:VIT
Array of Machine Terminal Voltage and Current (pu)
- Should come from the Machine Model
- VIT(1) = Machine Terminal Voltage (pu)
- VIT(2) = Real component of Machine Terminal Current
- VIT(3) - Imag component of Machine Terminal Current
- Note current phase angle is with respect to terminal voltage
:IFD
Machine Field Current (pu) - Should come from the Machine Model
:VS
Stabilizer Input Signal (pu) - Should come from a stabilizer model
- Can be set to 0.0 to disable all stabilizer functions"
   }
  }
 Component("Electranix_PSSE_Governors")
  {
  Desc = "PSSE Compatible Governor Models"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,251,24,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "..\\inputfile.dyr"
     Len = 150
     }
    Choice("Model",5,32,251,11,2)
     {
     Style = 0
     Desc = "Governor Model"
     Def = "20"
     Len = 15
     *0 = "CRCMGV"
     *1 = "DEGOV"
     *2 = "DEGOV1"
     *3 = "GAST"
     *4 = "GAST2A"
     *5 = "GASTWD"
     *20 = "GGOV1"
     *6 = "HYGOV"
     *7 = "IEEEG1"
     *8 = "IEEEG2"
     *9 = "IEEEG3"
     *10 = "IEESGO"
     *11 = "PIDGOV"
     *12 = "UNUSED"
     *13 = "TGOV1"
     *14 = "TGOV2"
     *15 = "TGOV3"
     *16 = "TGOV5"
     *17 = "WEHGOV"
     *18 = "WESGOV"
     *19 = "WPIDHY"
     *22 = "WSHYDD"
     *21 = "WSIEG1"
     *135 = "HYGOV2"
     }
    Input("Bus",5,48,251,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,64,251,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Input("TE",5,80,251,12,6)
     {
     Desc = "Electrical Torque (pu)"
     Def = "TE"
     Data = Real
     Len = 15
     Cond = "(Model==2)||(Model==4)||(Model==5)||(Model==11)||(Model==17)||(Model==18)||(Model==19)||(Model==20)||(Model==22)"
     }
    Input("MBASE",5,96,251,12,6)
     {
     Desc = "Machine Base MVA"
     Def = "120.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Cond = "(Model==2)||(Model==4)||(Model==5)||(Model==11)||(Model==17)||(Model==20)||(Model==22)"
     }
    Input("SBASE",5,112,251,12,6)
     {
     Desc = "System Base MVA"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Cond = "(Model==2)||(Model==4)||(Model==5)||(Model==11)||(Model==17)"
     }
    Input("TI",5,128,251,12,6)
     {
     Desc = "Time to Initiate Fast Valving (sec)"
     Def = "10000.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Cond = "(Model==14)||(Model==15)"
     }
    }
   }

  Nodes = 
   {
   Input("TM0",72,-18)
    {
    Type = Real
    }
   Input("ENAB",-36,18)
    {
    Type = Integer
    }
   Input("W",0,-54)
    {
    Type = Real
    }
   Input("WREF",0,54)
    {
    Type = Real
    }
   Output("TM",36,-54)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Line(59,-18,72,-18)
   Line(59,-18,63,-15)
   Line(59,-18,63,-21)
   Line(-36,18,-23,18)
   Line(-27,21,-23,18)
   Line(-27,15,-23,18)
   Line(0,-36,0,-54)
   Line(-5,-41,0,-36)
   Line(0,-36,6,-41)
   Line(0,54,0,36)
   Line(-5,41,0,36)
   Line(0,36,6,41)
   Line(36,-36,36,-54)
   Rectangle(-23,-36,59,36)
   Text(-19,34,"E")
   Cond = "Model==0"
   Text(22,2,"CRCMGV")
   Cond = "true"
   Text(46,-11,"TM0")
   Text(-5,22,"Enab")
   Text(0,-25,"W")
   Text(3,34,"Wref")
   Text(36,-25,"TM")
   Cond = "Model==1"
   Text(21,2,"DEGOV")
   Cond = "Model==2"
   Text(20,1,"DEGOV1")
   Cond = "Model==3"
   Text(19,1,"GAST")
   Cond = "Model==4"
   Text(19,1,"GAST2A")
   Cond = "Model==5"
   Text(20,1,"GASTWD")
   Cond = "Model==6"
   Text(20,1,"HYGOV")
   Cond = "Model==7"
   Text(20,1,"IEEEG1")
   Cond = "Model==8"
   Text(20,1,"IEEEG2")
   Cond = "Model==9"
   Text(20,1,"IEEEG3")
   Cond = "Model==10"
   Text(20,1,"IEESGO")
   Cond = "Model==11"
   Text(19,1,"PIDGOV")
   Cond = "Model==12"
   Text(20,1,"SHAF25")
   Cond = "Model==13"
   Text(19,1,"TGOV1")
   Cond = "Model==14"
   Text(20,1,"TGOV2")
   Cond = "Model==15"
   Text(20,1,"TGOV3")
   Cond = "Model==16"
   Text(20,1,"TGOV5")
   Cond = "Model==17"
   Text(20,1,"WEHGOV")
   Cond = "Model==18"
   Text(20,1,"WESGOV")
   Cond = "Model==19"
   Text(19,1,"WPIDHY")
   Cond = "Model==135"
   Text(17,0,"HYGOV2")
   Cond = "Model==20"
   Text(19,0,"GGOV1")
   Cond = "Model==21"
   Text(18,1,"WSIEG1")
   Cond = "Model==22"
   Text(21,1,"WSHYDD")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Call E-TRAN Subroutine to read in PSS/E Dynamics data and output to the DATA array...
!#STORAGE REAL:250
!#STORAGE INTEGER:1
#IF ( Model == 0 )
      CALL Electranix_PSSE_CRCMGV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 1 )
   #STORAGE STOR:137
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_DEGOV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 2 )
   #STORAGE STOR:147
   #STORAGE INTEGER:1
   #STORAGE REAL:24
      CALL Electranix_PSSE_DEGOV1($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, $SBASE, \"$FNAME\")
#ELSEIF ( Model == 3 )
   #STORAGE STOR:8
   #STORAGE INTEGER:1
   #STORAGE REAL:11
      CALL Electranix_PSSE_GAST($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 4 )
   #STORAGE STOR:329
   #STORAGE LOGICAL:3
   #STORAGE INTEGER:1
   #STORAGE REAL:35
      CALL Electranix_PSSE_GAST2A($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, $SBASE, \"$FNAME\")
#ELSEIF ( Model == 5 )
   #STORAGE STOR:331
   #STORAGE LOGICAL:3
   #STORAGE INTEGER:1
   #STORAGE REAL:36
      CALL Electranix_PSSE_GASTWD($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, $SBASE, \"$FNAME\")
#ELSEIF ( Model == 20 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:14
      CALL Electranix_PSSE_GGOV1($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, \"$FNAME\")
#ELSEIF ( Model == 6 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:14
      CALL Electranix_PSSE_HYGOV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 7 )
   #STORAGE STOR:17
   #STORAGE INTEGER:1
   #STORAGE REAL:23
      CALL Electranix_PSSE_IEEEG1($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 8 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:7
      CALL Electranix_PSSE_IEEEG2($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 9 )
   #STORAGE STOR:15
   #STORAGE INTEGER:1
   #STORAGE REAL:16
      CALL Electranix_PSSE_IEEEG3($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 10 )
   #STORAGE STOR:14
   #STORAGE INTEGER:1
   #STORAGE REAL:11
      CALL Electranix_PSSE_IEESGO($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 11 )
   #STORAGE STOR:22
   #STORAGE INTEGER:1
   #STORAGE REAL:22
      CALL Electranix_PSSE_PIDGOV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, $SBASE, \"$FNAME\")
#ELSEIF ( Model == 12 )
      WRITE(6,*) \"***ERROR: - Unsupported Governor, Model: $Model\"
      WRITE(6,*) \"SHAF25 is a separate non-governor model\"
      STOP
#ELSEIF ( Model == 13 )
   #STORAGE STOR:8
   #STORAGE INTEGER:1
   #STORAGE REAL:7
      CALL Electranix_PSSE_TGOV1($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 14 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:11
      CALL Electranix_PSSE_TGOV2($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TI, \"$FNAME\")
#ELSEIF ( Model == 15 )
   #STORAGE STOR:16
   #STORAGE INTEGER:1
   #STORAGE REAL:20
      CALL Electranix_PSSE_TGOV3($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TI, \"$FNAME\")
#ELSEIF ( Model == 16 )
      CALL Electranix_PSSE_TGOV5($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 17 )
   #STORAGE STOR:20
   #STORAGE INTEGER:1
   #STORAGE REAL:57
      CALL Electranix_PSSE_WEHGOV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, \"$FNAME\")
#ELSEIF ( Model == 18 )
   #STORAGE STOR:21
   #STORAGE INTEGER:1
   #STORAGE REAL:9
      CALL Electranix_PSSE_WESGOV($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, \"$FNAME\")
#ELSEIF ( Model == 19 )
   #STORAGE STOR:23
   #STORAGE INTEGER:1
   #STORAGE REAL:21
      CALL Electranix_PSSE_WPIDHY($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, \"$FNAME\")
#ELSEIF ( Model == 21 )
   #STORAGE STOR:19
   #STORAGE INTEGER:5
   #STORAGE REAL:40
      CALL Electranix_PSSE_WSIEG1($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSEIF ( Model == 22 )
   #STORAGE STOR:100
   #STORAGE INTEGER:20
   #STORAGE REAL:100
      CALL Electranix_PSSE_WSHYDD($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, $TE, $MBASE, \"$FNAME\")
#ELSEIF ( Model == 135 )
   #STORAGE STOR:19
   #STORAGE INTEGER:1
   #STORAGE REAL:19
      CALL Electranix_PSSE_HYGOV2($Enab, $Bus, \"$Ckt\", $Wref, $W, $TM0, $TM, \"$FNAME\")
#ELSE
      WRITE(6,*) \"***ERROR: - Unsupported Governor, Model: $Model\"
      STOP
#ENDIF
#IF(0)
! Test code to determine Storage Requirements
!       IF(TIMEZERO)WRITE(6,*) \"NEXC  = \",NEXC
!       IF(TIMEZERO)WRITE(6,*) \"NSTORF = \",NSTORF
!       IF(TIMEZERO)WRITE(6,*) \"NSTORI = \",NSTORI
!       IF(TIMEZERO)WRITE(6,*) \"NSTORC = \",NSTORC
!       IF(TIMEZERO)WRITE(6,*) \"NSTORL = \",NSTORL
!   Add call code here
!       IF(TIMEZERO)WRITE(6,*) \"2NEXC  = \",NEXC
!       IF(TIMEZERO)WRITE(6,*) \"2NSTORF = \",NSTORF
!       IF(TIMEZERO)WRITE(6,*) \"2NSTORI = \",NSTORI
!       IF(TIMEZERO)WRITE(6,*) \"2NSTORC = \",NSTORC
!       IF(TIMEZERO)WRITE(6,*) \"2NSTORL = \",NSTORL
#ENDIF"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_PSSE_Machine")
  {
  Desc = "PSSE Compatible Synchronous Machine"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("FName",5,4,242,24,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "inputfile.dyr"
     Len = 150
     }
    Choice("Model",5,36,242,12,2)
     {
     Style = 0
     Desc = "Machine Model"
     Def = "0"
     Len = 15
     *0 = "GENCLS"
     *1 = "GENDCO"
     *2 = "GENROE"
     *3 = "GENROU"
     *4 = "GENSAE"
     *5 = "GENSAL"
     *6 = "GENTRA"
     }
    Input("Bus",5,52,242,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,68,242,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Input("machsw",5,84,242,12,6)
     {
     Desc = "Source[0] -> Machine[1] transition"
     Def = "1"
     Data = Integer
     Unit = "0->1only"
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Enab",5,100,242,12,6)
     {
     Desc = "Lock-rotor[0]<->Normal mode[1] transition"
     Def = "1"
     Data = Integer
     Unit = "0or1"
     Len = 15
     }
    Input("Vbase",5,116,242,12,2)
     {
     Desc = "Rated RMS Voltage (kV,LL)"
     Def = "10.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.01
     }
    Input("MVA",5,132,242,12,2)
     {
     Desc = "Rated 3 Phase MVA"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 0.001
     }
    Input("Fbase",5,148,242,12,2)
     {
     Desc = "Base Angular Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Choice("MM",5,164,150,40,2)
     {
     Style = 1
     Desc = "Multimass interface:[Enables Speed Ctrl]"
     Def = "0"
     Len = 15
     *0 = "DISABLE"
     *1 = "ENABLE"
     }
    Choice("SAT",165,164,84,40,2)
     {
     Style = 1
     Desc = "Enable Saturation?"
     Def = "1"
     Len = 15
     Cond = "Model!=0"
     *0 = "No, Disable"
     *1 = "Yes, Enabled"
     }
    Input("RPU",5,212,242,12,2)
     {
     Desc = "Source Series R (pu on machine base mva)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "Model==0"
     }
    Input("XPU",5,228,242,12,2)
     {
     Desc = "Source Series X (pu on machine base mva, +ve for L)"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "Model==0"
     }
    }
   Category("Initial Conditions")
    {
    Input("VT",5,4,242,12,6)
     {
     Desc = "Initial Terminal Voltage Magnitude (pu)"
     Def = "1.0"
     Data = Real
     Unit = "p.u."
     Len = 15
     }
    Input("Pheta",5,20,242,12,6)
     {
     Desc = "Initial Terminal Voltage Phase (deg)"
     Def = "0.0"
     Data = Real
     Unit = "deg"
     Len = 15
     }
    Input("P0",5,36,242,12,6)
     {
     Desc = "Initial Terminal Real  Power ; Out + (MW)"
     Def = "0.0"
     Data = Real
     Unit = "MW"
     Len = 15
     }
    Input("Q0",5,52,242,12,6)
     {
     Desc = "Initial Terminal Reactive Power ; Out + (MVAR)"
     Def = "0.0"
     Data = Real
     Unit = "MVAR"
     Len = 15
     }
    Input("RAMPTIME",5,76,242,12,2)
     {
     Desc = "Time to Ramp Source During Startup (0.1 sec):"
     Def = "0.1"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    }
   Category("Output Variable Names")
    {
    Text("POut",5,4,242,12,2)
     {
     Desc = "Name: Real Power;  Out + (p.u.)"
     Len = 15
     }
    Text("QOut",5,20,242,12,2)
     {
     Desc = "Name: Reactive Power;  Out + (p.u.)"
     Len = 15
     }
    Text("Vneut",5,36,242,12,2)
     {
     Desc = "Name: Neutral Voltage (kV)"
     Len = 15
     Cond = "Model!=0"
     }
    Text("Cneut",5,52,242,12,2)
     {
     Desc = "Name: Neutral Current to Ground (kA)"
     Len = 15
     Cond = "Model!=0"
     }
    Text("Lang",5,68,242,12,2)
     {
     Desc = "Name: Load Angle; Gen. +  (rad)"
     Len = 15
     Cond = "Model!=0"
     }
    Text("Theta",5,84,242,12,2)
     {
     Desc = "Name: Rotor Mechanical Angle (rad)"
     Len = 15
     Cond = "Model!=0"
     }
    Text("Wang",5,100,242,12,2)
     {
     Desc = "Name: Internal Phase A Angle w.r.t. sin(wt)  (rad)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Output("telect",-72,0)
    {
    Type = Real
    }
   Output("speed",-36,72)
    {
    Type = Real
    }
   Output("tmeco",-72,36)
    {
    Type = Real
    }
   Output("efo",-72,-72)
    {
    Cond = "Model!=0"
    Type = Real
    }
   Output("mvit",36,-72)
    {
    Type = Real
    Dim  = [3]
    }
   Output("cfldn",0,-72)
    {
    Cond = "Model!=0"
    Type = Real
    }
   Input("efldn",-36,-72)
    {
    Cond = "Model!=0"
    Type = Real
    }
   Input("tmech",0,72)
    {
    Type = Real
    }
   Output("Tmstd",36,72)
    {
    Type = Real
    }
   Electrical("NS",36,0)
    {
    Dim  = [3]
    }
   Input("conspd",-72,-36)
    {
    Cond = "(MM==1)"
    Type = Real
    }
   Electrical("Gnd",-36,0)
    {
    Cond = "Model==0"
    Type = Ground
    }
   }

  Graphics = 
   {
   Ellipse(-54,-36,18,36)
   Arc(-28,-4,-19,9,0,180)
   Arc(-19,-4,-10,9,-180,180)
   Line(18,0,27,0)
   Line(16,-10,27,-10)
   Line(27,-15,27,15)
   Pen(,,0.6)
   Line(27,0,36,0)
   Pen(,,0.2)
   Cond = "Model!=0"
   Arc(-40,-55,-28,-44,-180,180)
   Arc(-29,-55,-18,-44,-180,180)
   Arc(-19,-55,-7,-44,-180,180)
   Arc(-8,-55,2,-44,-180,180)
   Line(3,-49,12,-49)
   Line(-49,-49,-40,-49)
   Cond = "true"
   Line(-55,36,-72,36)
   Line(-54,0,-72,0)
   Ellipse(19,-63,34,-49)
   Line(27,-63,27,-72)
   Line(28,-76,34,-67)
   Line(27,-72,36,-72)
   Ellipse(19,-49,34,-36)
   Pen(,Dashed)
   Line(27,-18,27,-24)
   Line(27,-27,27,-33)
   Pen(,Solid)
   Line(-16,56,-10,50)
   Line(21,72,36,72)
   Line(21,36,9,24)
   Line(21,72,21,36)
   Cond = "Model!=0"
   Line(-72,-72,-61,-72)
   Line(-61,-72,-61,-49)
   Line(-61,-49,-40,-28)
   Cond = "true"
   Line(-25,72,-25,51)
   Line(-10,72,-10,51)
   Line(-10,50,-4,56)
   Cond = "Model!=0"
   Line(-25,-72,-36,-72)
   Line(-25,-65,-25,-72)
   Line(-31,-70,-25,-65)
   Line(-25,-65,-20,-70)
   Line(-10,-72,-10,-65)
   Line(-10,-72,0,-72)
   Cond = "true"
   Line(-25,72,-36,72)
   Line(-10,72,0,72)
   Line(-55,36,-49,18)
   Cond = "(MM==1)"
   Line(-55,-36,-72,-36)
   Line(-55,-36,-60,-30)
   Line(-60,-41,-55,-36)
   Line(-49,-18,-55,-36)
   Cond = "true"
   Line(16,10,27,10)
   Cond = "Model==0"
   Line(-42,6,-42,-6)
   Line(-48,2,-48,-1)
   Line(-45,4,-45,-4)
   Line(-42,0,-36,0)
   Cond = "true"
   Text(-19,-23,"E")
   Text(-63,-3,"Te")
   Text(33,-75,"3")
   Text(27,-52,"A")
   Text(27,-39,"V")
   Text(-63,33,"Tm")
   Text(34,67,"Tm0")
   Cond = "Model!=0"
   Text(-70,-57,"Ef0")
   Cond = "true"
   Text(-9,48,"Tm")
   Text(-25,48,"w")
   Cond = "Model!=0"
   Text(-27,-51,"Ef")
   Text(-7,-51,"If")
   Cond = "true"
   Text(-54,62,"E")
   Cond = "(MM==1)"
   Text(-66,-39,"w")
   Cond = "Model==1"
   Text(-17,21,"GENDCO")
   Cond = "Model==2"
   Text(-16,21,"GENROE")
   Cond = "Model==3"
   Text(-17,21,"GENROU")
   Cond = "Model==4"
   Text(-17,22,"GENSAE")
   Cond = "Model==5"
   Text(-18,22,"GENSAL")
   Cond = "Model==6"
   Text(-16,22,"GENTRA")
   Cond = "Model==0"
   Text(-17,21,"GENCLS")
   }

  Section(EMTDC)
   {
   Dsdyn = "\
! E-TRAN Machine Subroutine
#SUBROUTINE ELECTRANIX_PSSE_MACHINE E-TRAN PSS/E Compatible Machine
#LOCAL REAL SP_IN
#IF (MM==0)
      SP_IN = $FBase * TWO_PI
#ELSE
      SP_IN = $conspd
      IF ($Enab .EQ. 0) SP_IN = $FBase * TWO_PI
#ENDIF


    #IF ( Model == 0 )
#STORAGE STOR:3
#STORAGE LOGICAL:3
#STORAGE INTEGER:22
#STORAGE REAL:291
#LOCAL REAL Pw_O
#LOCAL REAL Qva_O
#LOCAL REAL Vn_O
#LOCAL REAL Cn_O
#LOCAL REAL Wang_O
       CALL ELECTRANIX_PSSE_GENCLS($Bus, \"$Ckt\", $NS, $SS,
     &   $BA ,$BB, $BC,
     &   $MM, $Enab,
     &  $Vbase, $MVA, $FBase, $VT, $Pheta, $P0, $Q0, $RAMPTIME,
     &  $tmech,SP_IN,$RPU,$XPU,
     &  $mvit, $speed, $telect,
     &  Pw_O,Qva_O,Wang_O,
     &  \"$FName\")
        $Tmstd = $telect
        IF ( $Enab .EQ. 1 ) THEN
           $tmeco = $tmech
        ELSE
           $tmeco = $Tmstd
        ENDIF
#OUTPUT REAL POut  {Pw_O}
#OUTPUT REAL QOut  {Qva_O}
#OUTPUT REAL Wang  {Wang_O}


    #ELSE
#STORAGE STOR:375
#STORAGE INTEGER:4
#STORAGE REAL:281
#LOCAL REAL Pw_O
#LOCAL REAL Qva_O
#LOCAL REAL Vn_O
#LOCAL REAL Cn_O
#LOCAL REAL LdA_O
#LOCAL REAL Tht_O
#LOCAL REAL Wang_O
       CALL ELECTRANIX_PSSE_MACHINE($Model, $Bus, \"$Ckt\", $NS, $SS,
     &  $MM, $machsw, $Enab, $SAT,
     &  $Vbase, $MVA, $FBase, $VT, $Pheta, $P0, $Q0, $RAMPTIME,
     &  $efldn, $tmech,
     &  SP_IN,
     &  $mvit, $cfldn, $speed, $telect, $efo, $Tmstd,
     &  Pw_O,Qva_O,Vn_O,Cn_O,LdA_O,Tht_O,Wang_O,
     &  \"$FName\")
        IF ( $Enab .EQ. 1 ) THEN
           $tmeco = $tmech
        ELSE
           $tmeco = $Tmstd
        ENDIF
#OUTPUT REAL POut  {Pw_O}
#OUTPUT REAL QOut  {Qva_O}
#OUTPUT REAL Vneut {Vn_O}
#OUTPUT REAL Cneut {Cn_O}
#OUTPUT REAL Lang  {LdA_O}
#OUTPUT REAL Theta {Tht_O}
#OUTPUT REAL Wang  {Wang_O}
    #ENDIF
"
   Computations = "\
REAL   w       = 2*pi*Fbase
REAL   ZBASE   = Vbase*Vbase/MVA
REAL   R       = RPU*ZBASE
REAL   L       = XPU>0 ? XPU*ZBASE/w            : 0.0
REAL   C       = XPU<0 ? 1.0e6/(w*(-XPU)*ZBASE) : 0.0"
   Checks = "\
#IF (Model==0)
WARNING -ve R,L,C Encountered - Numerical instabilities are possible! : R>=0 && L>=0 && C>=0
#ENDIF"
   Model-Data = ""
   Branch = "\
#IF Model==0
     BA =  $Gnd  $NS(1)   SOURCE   $R $L $C  /
     BB =  $Gnd  $NS(2)   SOURCE   $R $L $C  /
     BC =  $Gnd  $NS(3)   SOURCE   $R $L $C  /
#ENDIF"
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Generators"
   }
  Section(Help)
   {
   FlyBy = "\
Synchronous Machine
:efo
initialized field voltage
(pu or normalized)
:efldn
field voltage
(pu or normalized)
:cfldn
field current
(pu or normalized)
:mvit
3 element array
terminal voltage (pu)
terminal current real (pu)
terminal current imaginary (pu)
:NS
3 Phase electrical connection
:Tmstd
initialized mechanical torque (pu)
:tmech
torque input (pu)
:speed
speed output (pu)
:tmeco
mechanical torque output (pu)
:telect
electrical torque output (pu)
:conspd
speed input (rad/s)
"
   }
  }
 Component("Electranix_PSSE_Stabilizers")
  {
  Desc = "PSSE Compatible Stabilizer Models"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,300,26,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "..\\inputfile.dyr"
     Len = 150
     }
    Choice("Model",5,36,213,11,2)
     {
     Style = 0
     Desc = "Exciter Model"
     Def = "0"
     Len = 15
     *0 = "IEE2ST"
     *1 = "IEEEST"
     *2 = "PSS2A"
     *9 = "PSS2B"
     *3 = "ST2CUT"
     *4 = "STAB1"
     *5 = "STAB2A"
     *6 = "STAB3"
     *7 = "STAB4"
     *8 = "STBSVC"
     }
    Input("Bus",5,52,213,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,68,213,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Input("VT",5,84,213,12,6)
     {
     Desc = "Input Signal for Measured Terminal Volts (pu)"
     Def = "VT"
     Data = Real
     Unit = "pu"
     Len = 15
     Cond = "Model==3"
     }
    Choice("NumIN",5,100,153,44,2)
     {
     Style = 1
     Desc = "Number of Stabilizer Inputs:"
     Def = "1"
     Len = 15
     Cond = "(Model==0)||(Model==2)||(Model==3)||(Model==8)||(Model==9)"
     *1 = "1"
     *2 = "2"
     }
    }
   }

  Nodes = 
   {
   Output("VS",72,18)
    {
    Type = Real
    }
   Input("IN2",-36,18)
    {
    Cond = "(NumIN>=2)&&((Model==0)||(Model==2)||(Model==3)||(Model==8)||(Model==9))"
    Type = Real
    }
   Input("IN1",-36,-18)
    {
    Type = Real
    }
   Input("VCT",72,-18)
    {
    Cond = "(Model==0)||(Model==1)||(Model==3)"
    Type = Real
    }
   Input("Enab",0,-54)
    {
    Type = Integer
    }
   }

  Graphics = 
   {
   Line(59,18,72,18)
   Cond = "(NumIN>=2)&&((Model==0)||(Model==2)||(Model==3)||(Model==8)||(Model==9))"
   Line(-36,18,-23,18)
   Line(-27,21,-23,18)
   Line(-27,15,-23,18)
   Cond = "true"
   Rectangle(-23,-36,59,36)
   Line(-36,-18,-23,-18)
   Line(-27,-15,-23,-18)
   Line(-27,-21,-23,-18)
   Cond = "(Model==0)||(Model==1)||(Model==3)"
   Line(59,-18,72,-18)
   Line(59,-18,63,-15)
   Line(59,-18,63,-21)
   Cond = "true"
   Line(0,-37,0,-53)
   Line(-5,-41,0,-36)
   Line(0,-36,5,-41)
   Text(-19,34,"E")
   Text(49,21,"VS")
   Cond = "(NumIN>=2)&&((Model==0)||(Model==2)||(Model==3)||(Model==8)||(Model==9))"
   Text(-11,22,"IN2")
   Cond = "Model==0"
   Text(18,3,"IEE2ST")
   Cond = "true"
   Text(-11,-14,"IN1")
   Cond = "Model==1"
   Text(17,2,"IEEEST")
   Cond = "Model==2"
   Text(15,2,"PSS2A")
   Cond = "Model==3"
   Text(15,2,"ST2CUT")
   Cond = "Model==4"
   Text(15,2,"STAB1")
   Cond = "Model==5"
   Text(15,2,"STAB2A")
   Cond = "Model==6"
   Text(15,2,"STAB3")
   Cond = "Model==7"
   Text(15,2,"STAB4")
   Cond = "Model==8"
   Text(16,2,"STBSVC")
   Cond = "(Model==0)||(Model==1)||(Model==3)"
   Text(46,-15,"VCT")
   Cond = "true"
   Text(17,-41,"Enab")
   Cond = "Model==9"
   Text(16,3,"PSS2B")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Call E-TRAN PSS/E Compatible Stabilizer - these models read in data from the .dyr file...
#IF ( Model == 0 )
   #STORAGE STOR:25
   #STORAGE INTEGER:1
   #STORAGE REAL:20
   #IF ( NumIN <= 1 )
      CALL Electranix_PSSE_IEE2ST($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , $VCT, $VS, \"$FNAME\")
   #ELSE
      CALL Electranix_PSSE_IEE2ST($Enab, $Bus, \"$Ckt\", $IN1, $IN2, $VCT, $VS, \"$FNAME\")
   #ENDIF
#ELSEIF ( Model == 1 )
   #STORAGE STOR:15
   #STORAGE INTEGER:3
   #STORAGE REAL:19
      CALL Electranix_PSSE_IEEEST($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , $VCT, $VS, \"$FNAME\")
#ELSEIF ( Model == 2 )
   #STORAGE STOR:100
   #STORAGE INTEGER:1
   #STORAGE REAL:23
   #IF ( NumIN <= 1 )
      CALL Electranix_PSSE_PSS2A($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
   #ELSE
      CALL Electranix_PSSE_PSS2A($Enab, $Bus, \"$Ckt\", $IN1, $IN2, 0.0, $VS, \"$FNAME\")
   #ENDIF
#ELSEIF ( Model == 3 )
   #STORAGE STOR:27
   #STORAGE INTEGER:1
   #STORAGE REAL:20
   #IF ( NumIN <= 1 )
      CALL Electranix_PSSE_ST2CUT($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , $VCT, $VT, $VS, \"$FNAME\")
   #ELSE
      CALL Electranix_PSSE_ST2CUT($Enab, $Bus, \"$Ckt\", $IN1, $IN2, $VCT, $VT, $VS, \"$FNAME\")
   #ENDIF
#ELSEIF ( Model == 4 )
   #STORAGE STOR:10
   #STORAGE INTEGER:1
   #STORAGE REAL:7
      CALL Electranix_PSSE_STAB1($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
#ELSEIF ( Model == 5 )
   #STORAGE STOR:12
   #STORAGE INTEGER:1
   #STORAGE REAL:8
      CALL Electranix_PSSE_STAB2A($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
#ELSEIF ( Model == 6 )
   #STORAGE STOR:6
   #STORAGE INTEGER:1
   #STORAGE REAL:5
      CALL Electranix_PSSE_STAB3($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
#ELSEIF ( Model == 7 )
   #STORAGE STOR:16
   #STORAGE INTEGER:1
   #STORAGE REAL:11
      CALL Electranix_PSSE_STAB4($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
#ELSEIF ( Model == 8 )
   #IF ( NumIN <= 1 )
      CALL Electranix_PSSE_STBSVC($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
   #ELSE
      CALL Electranix_PSSE_STBSVC($Enab, $Bus, \"$Ckt\", $IN1, $IN2, 0.0, $VS, \"$FNAME\")
   #ENDIF
#ELSEIF ( Model == 9 )
   #STORAGE STOR:100
   #STORAGE INTEGER:1
   #STORAGE REAL:29
   #IF ( NumIN <= 1 )      
      CALL Electranix_PSSE_PSS2B($Enab, $Bus, \"$Ckt\", $IN1, 0.0 , 0.0, $VS, \"$FNAME\")
   #ELSE
      CALL Electranix_PSSE_PSS2B($Enab, $Bus, \"$Ckt\", $IN1, $IN2, 0.0, $VS, \"$FNAME\")
   #ENDIF
#ELSE
      WRITE(6,*) \"***ERROR: - Unsupported Stabilizer, Model: $Model\"
      STOP
#ENDIF"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_ReadPSSEDYR")
  {
  Desc = ""
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,242,24,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "inputfile.dyr"
     Len = 150
     }
    Text("Model",5,36,242,12,2)
     {
     Desc = "Model Name"
     Def = "HYGOV"
     Len = 15
     }
    Input("Bus",5,52,242,12,2)
     {
     Desc = "Bus Number"
     Def = "11111"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,68,242,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Choice("USRMDL",5,84,144,46,2)
     {
     Style = 1
     Desc = "Is this a User Defined Model?"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("Dim",5,133,180,55,2)
     {
     Style = 1
     Desc = "Dimension of Variables Read (0=25, 1=250, 2=1024)"
     Def = "1"
     Len = 15
     *0 = "25"
     *1 = "250"
     *2 = "1024"
     }
    }
   }

  Nodes = 
   {
   Output("NUMDATA",54,0)
    {
    Type = Integer
    }
   Output("DATA",54,18)
    {
    Cond = "Dim==1"
    Type = Real
    Dim  = [250]
    }
   Output("DATA",54,18)
    {
    Cond = "Dim==0"
    Type = Real
    Dim  = [25]
    }
   Output("DATA",54,18)
    {
    Cond = "Dim==2"
    Type = Real
    Dim  = [1024]
    }
   }

  Graphics = 
   {
   Rectangle(-63,-11,39,27)
   Pen(ByNode,ByNode,ByNode,NUMDATA)
   Line(54,0,39,0)
   Pen(,,,DATA)
   Line(54,18,39,18)
   Pen(Black,Solid,0.2)
   Line(45,22,49,14)
   Text(-11,40,"Read PSSE DYR")
   Text(-6,4,"# of Parameters")
   Text(20,22,"DATA")
   Cond = "Dim==1"
   Text(54,12,"250")
   Cond = "true"
   Text(-57,23,"E")
   Text(-11,-17,"$Model")
   Cond = "Dim==0"
   Text(54,12,"25")
   Cond = "Dim==2"
   Text(54,12,"1024")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Call E-TRAN Subroutine to read in PSS/E Dynamics data and output to the DATA array...
#IF (Dim==0)
! Dimension 25
#STORAGE REAL:25
#STORAGE INTEGER:1
      CALL Electranix_Read_PSSE_Dyr_Dim(\"$FName\",\"$Model\",$Bus,\"$Ckt\",$USRMDL,25,$NUMDATA,$DATA)
#ELSEIF (Dim==1)
! Dimension 250
#STORAGE REAL:250
#STORAGE INTEGER:1
      CALL Electranix_Read_PSSE_Dyr_Dim(\"$FName\",\"$Model\",$Bus,\"$Ckt\",$USRMDL,250,$NUMDATA,$DATA)
#ELSE
! Dimension 1024
#STORAGE REAL:1024
#STORAGE INTEGER:1
      CALL Electranix_Read_PSSE_Dyr_Dim(\"$FName\",\"$Model\",$Bus,\"$Ckt\",$USRMDL,1024,$NUMDATA,$DATA)
#ENDIF"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_Compounding_VRef")
  {
  Desc = "Calculates Compounded VRef for Exciters"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,246,28,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "..\\inputfile.dyr"
     Len = 150
     }
    Choice("Comp",5,36,246,12,2)
     {
     Style = 0
     Desc = "Voltage Compounding Model:"
     Def = "0"
     Len = 30
     *0 = "none (control local VTerminal)"
     *1 = "COMP ( Vc = Vt - jX * I )"
     *2 = "COMPCC"
     *3 = "IEEEVC ( Vc = Vt + (R + jX) * I )"
     }
    Input("Bus",5,52,246,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,68,246,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Input("MVA",5,84,246,12,2)
     {
     Desc = "Rated 3 Phase Machine MVA Base"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 0.001
     }
    Input("NumMac",5,100,246,12,2)
     {
     Desc = "Number of Parallel Machines"
     Def = "1"
     Data = Real
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Input("VOut",-72,-36)
    {
    Type = Real
    }
   Input("QOut",-72,18)
    {
    Type = Real
    }
   Input("AOut",-72,-18)
    {
    Type = Real
    }
   Input("POut",-72,0)
    {
    Type = Real
    }
   Output("VREF",72,0)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Pen(ByNode,Real,ByNode)
   Line(-71,-36,-55,-36)
   Pen(Real,,,AOut)
   Line(-72,-18,-55,-18)
   Pen(ByNode)
   Line(-71,0,-55,0)
   Pen(Real,,,VREF)
   Line(55,0,71,0)
   Pen(ByNode)
   Line(-71,18,-55,18)
   Pen(Fuchsia,Solid,0.4)
   Rectangle(-55,-69,55,30)
   Pen(Real,Real,ByNode,VOut)
   Line(-72,-36,-55,-36)
   Pen(,,,POut)
   Line(-72,0,-55,0)
   Pen(,,,QOut)
   Line(-72,18,-55,18)
   Pen(Black,Solid,0.2)
   Line(-61,-41,-55,-36)
   Line(-55,-36,-61,-31)
   Line(-55,-18,-61,-13)
   Line(-61,-23,-55,-18)
   Line(-55,0,-61,5)
   Line(-61,-5,-55,0)
   Line(-55,18,-61,23)
   Line(-61,13,-55,18)
   Font(,,Left)
   Text(-51,-15,"Angle(deg)")
   Text(-51,2,"Pout(MW)")
   Text(-51,20,"Qout(MVAR)")
   Font(,,Centre)
   Text(4,42,"Calculate VREF")
   Font(,,Left)
   Text(-51,-33,"Volts(pu)")
   Font(,,Centre)
   Text(73,-5,"VREF")
   Cond = "Comp==1"
   Text(-1,-53,"COMP")
   Cond = "Comp==2"
   Text(0,-54,"COMPCC")
   Cond = "Comp==3"
   Text(-2,-55,"IEEEVC")
   Cond = "true"
   Text(-49,-57,"E")
   }

  Section(EMTDC)
   {
   Fortran = "\
! Electranix Compounded VRef
#IF ( Comp == 0 )
! No Compounding
      $VREF = $VOut
#ELSEIF ( Comp == 1)
! COMP Compounding
#STORAGE REAL:2
#STORAGE INTEGER:1
#LOCAL REAL DATA_LOCAL(250)
#LOCAL INTEGER NUMDATA_LOCAL
#LOCAL REAL XE_LOCAL
      CALL Electranix_Read_PSSE_Dyr(\"$FName\",\"COMP\",$Bus,\"$Ckt\",0,NUMDATA_LOCAL,DATA_LOCAL)
      IF ( FIRSTSTEP ) THEN
         STORF(NSTORF+0) = $VREF
         XE_LOCAL = DATA_LOCAL(1)
! VREF = VT-jXE.IT
         STORF(NSTORF+0) = ABS(CMPLX($VOut,0.0)-((CMPLX($POut,-$QOut)*$NumMac/$MVA)/$Vout)*CMPLX(0.0,XE_LOCAL))
      ENDIF
      $VREF = STORF(NSTORF+0)
      NSTORF = NSTORF + 1
#ELSEIF ( Comp == 2)
! COMPCC Compounding
      WRITE(6,*) \"*** ERROR: COMPCC Not supported (Electranix_Compounding_VRef)!\"
      STOP
#ELSEIF ( Comp == 3)
! IEEEVC Compounding
#STORAGE REAL:3
#STORAGE INTEGER:1
#LOCAL REAL DATA_LOCAL(250)
#LOCAL INTEGER NUMDATA_LOCAL
#LOCAL REAL RC_LOCAL
#LOCAL REAL XC_LOCAL
      CALL Electranix_Read_PSSE_Dyr(\"$FName\",\"IEEEVC\",$Bus,\"$Ckt\",0,NUMDATA_LOCAL,DATA_LOCAL)
      IF ( FIRSTSTEP ) THEN
         RC_LOCAL = DATA_LOCAL(1)
         XC_LOCAL = DATA_LOCAL(2)
! VREF = VT+(RC+jXC).IT
         STORF(NSTORF+0) = ABS(CMPLX($VOut,0.0)+((CMPLX($POut,-$QOut)*$NumMac/$MVA)/$Vout)*CMPLX(RC_LOCAL,XC_LOCAL))
      ENDIF
      $VREF = STORF(NSTORF+0)
      NSTORF = NSTORF + 1
#ENDIF
"
   Branch = ""
   Computations = ""
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Initialize"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Calculates Compunded VREF

Takes machine loadflow terminal voltage
- calculates machine current based on V and PQ
- reads RX from .dyr file for compounding models
- VREF = VT           (No Compounding)
- VREF = VT - I*(X)   (COMP)
- VREF = VT + I*(R+X) (IEEEVC)"
   }
  }
 Component("Electranix_PSSE_Shaf25")
  {
  Desc = "PSSE Compatible Multimass Torsional Model"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("FName",5,4,256,24,2)
     {
     Desc = "Full pathname of input .DYR file:"
     Def = "..\\inputfile.dyr"
     Len = 150
     }
    Input("Bus",5,36,187,12,2)
     {
     Desc = "Bus Number"
     Def = "1000"
     Data = Integer
     Len = 15
     }
    Text("Ckt",5,52,187,12,2)
     {
     Desc = "Circuit Number or Name"
     Def = "1"
     Len = 15
     }
    Input("FR",5,68,187,12,2)
     {
     Desc = "Rated Electrical Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     }
    Choice("Output",5,84,187,48,2)
     {
     Style = 1
     Desc = "Select Wg Output Units:"
     Def = "1"
     Len = 15
     *1 = "Output Wg in Rad/Sec for Sync Machine Model"
     *2 = "Output Wg in pu for Induction Machine Model"
     }
    }
   Category("Mutual Damping Factors")
    {
    Input("MD12",6,2,258,12,6)
     {
     Desc = "Mutual Damping - Mass 1 to 2 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD23",6,14,258,12,6)
     {
     Desc = "Mutual Damping - Mass 2 to 3 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD34",6,26,258,12,6)
     {
     Desc = "Mutual Damping - Mass 3 to 4 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD45",6,38,258,12,6)
     {
     Desc = "Mutual Damping - Mass 4 to 5 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD56",6,50,258,12,6)
     {
     Desc = "Mutual Damping - Mass 5 to 6 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD67",6,62,258,12,6)
     {
     Desc = "Mutual Damping - Mass 6 to 7 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD78",6,74,258,12,6)
     {
     Desc = "Mutual Damping - Mass 7 to 8 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD89",6,86,258,12,6)
     {
     Desc = "Mutual Damping - Mass 8 to 9 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD910",6,98,258,12,6)
     {
     Desc = "Mutual Damping - Mass 9 to 10 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1011",6,110,258,12,6)
     {
     Desc = "Mutual Damping - Mass 10 to 11 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1112",6,122,258,12,6)
     {
     Desc = "Mutual Damping - Mass 11 to 12 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1213",6,134,258,12,6)
     {
     Desc = "Mutual Damping - Mass 12 to 13 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1314",6,146,258,12,6)
     {
     Desc = "Mutual Damping - Mass 13 to 14 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1415",6,158,258,12,6)
     {
     Desc = "Mutual Damping - Mass 14 to 15 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1516",6,170,258,12,6)
     {
     Desc = "Mutual Damping - Mass 15 to 16 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1617",6,182,258,12,6)
     {
     Desc = "Mutual Damping - Mass 16 to 17 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1718",6,194,258,12,6)
     {
     Desc = "Mutual Damping - Mass 17 to 18 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1819",6,206,258,12,6)
     {
     Desc = "Mutual Damping - Mass 18 to 19 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD1920",6,218,258,12,6)
     {
     Desc = "Mutual Damping - Mass 19 to 20 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD2021",6,230,258,12,6)
     {
     Desc = "Mutual Damping - Mass 20 to 21 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD2122",6,242,258,12,6)
     {
     Desc = "Mutual Damping - Mass 21 to 22 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD2223",6,254,258,12,6)
     {
     Desc = "Mutual Damping - Mass 22 to 23 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD2324",6,266,258,12,6)
     {
     Desc = "Mutual Damping - Mass 23 to 24 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("MD2425",6,278,258,12,6)
     {
     Desc = "Mutual Damping - Mass 24 to 25 (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    }
   Category("Output Variables")
    {
    Text("W",5,4,256,12,2)
     {
     Desc = "Array Name: Output of Speed of 25 Masses (p.u.)"
     Len = 18
     }
    Text("Angle",5,20,256,12,2)
     {
     Desc = "Array Name: Output of Angle of 25 Masses (rad)"
     Len = 18
     }
    Text("TS",5,36,256,12,2)
     {
     Desc = "Array Name: Output of Torque of 24 Shafts (pu)"
     Len = 18
     }
    }
   }

  Nodes = 
   {
   Output("Wg",36,36)
    {
    Type = Real
    }
   Input("TM",-36,36)
    {
    Type = Real
    }
   Input("TE",0,36)
    {
    Type = Real
    }
   Input("Enab",-72,0)
    {
    Type = Integer
    }
   Output("W",-36,-54)
    {
    Type = Real
    Dim  = [25]
    }
   Output("Angle",0,-54)
    {
    Type = Real
    Dim  = [25]
    }
   Output("TS",36,-54)
    {
    Type = Real
    Dim  = [24]
    }
   }

  Graphics = 
   {
   Line(-49,-38,39,-38)
   Line(-49,22,39,22)
   Line(-58,-29,-58,13)
   Line(48,-29,48,13)
   Line(8,3,8,9)
   Line(5,6,8,3)
   Line(11,6,8,3)
   Line(-36,22,-42,28)
   Line(-31,28,-36,22)
   Line(-51,-32,-4,-32)
   Line(-4,-32,-4,-23)
   Line(-4,-23,-8,-26)
   Line(-4,-23,-1,-26)
   Line(-9,-23,-9,9)
   Line(-9,-23,-2,-16)
   Line(-9,8,-2,1)
   Line(-2,2,-2,-16)
   Line(-2,-9,5,-9)
   Line(-2,-5,5,-5)
   Rectangle(5,-16,23,2)
   Line(23,-9,32,-9)
   Line(23,-5,32,-5)
   Rectangle(32,-14,41,0)
   Line(14,3,14,9)
   Line(14,9,36,9)
   Line(-36,18,-36,36)
   Line(-44,-32,-44,-23)
   Line(-44,-23,-47,-26)
   Line(-44,-23,-41,-26)
   Line(-49,-23,-49,9)
   Line(-49,-23,-42,-16)
   Line(-49,9,-42,2)
   Line(-42,2,-42,-16)
   Line(-42,-9,-35,-9)
   Line(-42,-5,-35,-5)
   Line(-31,-32,-31,-23)
   Line(-31,-23,-34,-26)
   Line(-31,-23,-28,-26)
   Line(-35,-23,-35,9)
   Line(-35,-23,-29,-16)
   Line(-35,9,-29,2)
   Line(-29,2,-29,-16)
   Line(-29,-9,-22,-9)
   Line(-29,-5,-22,-5)
   Line(-18,-32,-18,-23)
   Line(-18,-23,-21,-26)
   Line(-18,-23,-15,-26)
   Line(-22,-23,-22,9)
   Line(-22,-23,-16,-16)
   Line(-22,9,-16,2)
   Line(-16,2,-16,-16)
   Line(-16,-9,-9,-9)
   Line(-16,-5,-9,-5)
   Line(-58,-29,-49,-38)
   Line(39,22,48,13)
   Line(39,-38,48,-29)
   Line(-58,13,-49,22)
   Line(36,9,36,36)
   Line(30,27,36,33)
   Line(36,33,41,27)
   Line(-51,-32,-51,18)
   Line(0,22,-6,28)
   Line(5,28,0,22)
   Line(0,9,0,36)
   Line(0,9,8,9)
   Line(-51,18,-36,18)
   Line(-72,0,-58,0)
   Line(-58,0,-63,5)
   Line(-63,-5,-58,0)
   Line(-36,-54,-36,-38)
   Line(0,-54,0,-38)
   Line(36,-54,36,-38)
   Text(26,20,"Wg")
   Text(-27,21,"TM")
   Text(14,-3,"g")
   Text(-8,20,"TE")
   Text(43,-18,"E")
   Text(-67,12,"Enab")
   Text(-29,-39,"Wi")
   Text(6,-39,"Ai")
   Text(42,-39,"TSi")
   }

  Section(EMTDC)
   {
   Dsdyn = "\
! Call E-TRAN PSS/E Compatible 25 Mass Multimass Shaft Model - these models read in data from the .dyr file...
   #STORAGE INTEGER:5
   #STORAGE REAL:150
   #LOCAL INTEGER I_1
   #LOCAL REAL MD_1(24)
      MD_1(1) = $MD12
      MD_1(2) = $MD23
      MD_1(3) = $MD34
      MD_1(4) = $MD45
      MD_1(5) = $MD56
      MD_1(6) = $MD67
      MD_1(7) = $MD78
      MD_1(8) = $MD89
      MD_1(9) = $MD910
      MD_1(10) = $MD1011
      MD_1(11) = $MD1112
      MD_1(12) = $MD1213
      MD_1(13) = $MD1314
      MD_1(14) = $MD1415
      MD_1(15) = $MD1516
      MD_1(16) = $MD1617
      MD_1(17) = $MD1718
      MD_1(18) = $MD1819
      MD_1(19) = $MD1920
      MD_1(20) = $MD2021
      MD_1(21) = $MD2122
      MD_1(22) = $MD2223
      MD_1(23) = $MD2324
      MD_1(24) = $MD2425
      CALL Electranix_PSSE_SHAF25($Enab, $Bus, \"$Ckt\", $FR, $TM, $TE , MD_1, $Wg, $W, $Angle, $TS, \"$FNAME\")
"
   }
  Section(Help)
   {
   }
  }
 Component("Electranix_Switched_Shunt_Control")
  {
  Desc = "Control of Switched Shunt Capacitor or Reactors"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Choice("Mode",5,4,128,56,2)
     {
     Style = 1
     Desc = "Mode of Operation"
     Def = "1"
     Len = 15
     *1 = "Voltage Control"
     *2 = "SVC External Shunt Control"
     *3 = "Manual Control"
     }
    Input("NumL",5,68,270,12,2)
     {
     Desc = "Number of Reactor Banks (0-5)"
     Def = "0"
     Data = Integer
     Len = 15
     Min = 0
     Max = 5
     }
    Input("MVARL",5,84,270,12,6)
     {
     Desc = "MVAR Size of Each Reactor Bank"
     Def = "10"
     Data = Real
     Unit = "MVAR"
     Len = 15
     Min = 0
     Max = 1000
     }
    Input("NumC",5,100,270,12,2)
     {
     Desc = "Number of Capacitor Banks (0-9)"
     Def = "3"
     Data = Integer
     Len = 15
     Min = 0
     Max = 9
     }
    Input("MVARC",5,116,270,12,6)
     {
     Desc = "MVAR Size of Each Capacitor Bank"
     Def = "10"
     Data = Real
     Unit = "MVAR"
     Len = 15
     Min = 0
     Max = 1000
     }
    Input("TStart",5,132,269,12,6)
     {
     Desc = "Initialization Time (Dynamic Switching disabled during init)"
     Def = "1.0"
     Data = Real
     Len = 15
     }
    Choice("EnableD",5,148,269,12,2)
     {
     Style = 0
     Desc = "Dynamic Switching"
     Def = "1"
     Len = 30
     *0 = "Disabled (lock at initial values)"
     *1 = "Enabled"
     }
    Input("TDelay",5,164,269,12,6)
     {
     Desc = "Time Delay Between Switching"
     Def = "0.2"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("VHigh",5,180,269,12,6)
     {
     Desc = "Upper Voltage Before Decreasing MVARs  (1.05 pu)"
     Def = "1.05"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 2
     Cond = "Mode==1"
     }
    Input("VLow",5,196,269,12,6)
     {
     Desc = "Lower Voltage Before Increasing MVARs  (1.05 pu)"
     Def = "0.95"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 2
     Cond = "Mode==1"
     }
    Input("AlphaHigh",5,212,269,12,6)
     {
     Desc = "Upper Alpha Limit Before TSC Branches are Added (170 Deg)"
     Def = "170"
     Data = Real
     Unit = "°"
     Len = 15
     Cond = "Mode==2"
     }
    Input("AlphaLow",5,228,269,12,6)
     {
     Desc = "Lower Alpha Limit Before TSC Branches are Added (90 Deg)"
     Def = "100"
     Data = Real
     Unit = "°"
     Len = 15
     Cond = "Mode==2"
     }
    }
   }

  Nodes = 
   {
   Input("VInit",-54,-54)
    {
    Type = Real
    }
   Input("QInit",-54,0)
    {
    Type = Real
    }
   Output("CB1",54,18)
    {
    Cond = "NumC>=1"
    Type = Integer
    }
   Output("CB2",54,36)
    {
    Cond = "NumC>=2"
    Type = Integer
    }
   Output("CB3",54,54)
    {
    Cond = "NumC>=3"
    Type = Integer
    }
   Input("Alpha",-54,54)
    {
    Cond = "Mode==2"
    Type = Real
    }
   Output("CB4",54,72)
    {
    Cond = "NumC>=4"
    Type = Integer
    }
   Output("CB5",54,90)
    {
    Cond = "NumC>=5"
    Type = Integer
    }
   Output("LB1",54,-90)
    {
    Cond = "NumL>=1"
    Type = Integer
    }
   Output("LB2",54,-72)
    {
    Cond = "NumL>=2"
    Type = Integer
    }
   Output("LB3",54,-54)
    {
    Cond = "NumL>=3"
    Type = Integer
    }
   Output("LB4",54,-36)
    {
    Cond = "NumL>=4"
    Type = Integer
    }
   Output("LB5",54,-18)
    {
    Cond = "NumL>=5"
    Type = Integer
    }
   Input("VMeas",-54,54)
    {
    Cond = "Mode==1"
    Type = Real
    }
   Output("BanksOn",54,0)
    {
    Type = Integer
    }
   Input("Manual",-54,54)
    {
    Cond = "Mode==3"
    Type = Real
    }
   Output("CB6",54,108)
    {
    Cond = "NumC>=6"
    Type = Integer
    }
   Output("CB7",54,126)
    {
    Cond = "NumC>=7"
    Type = Integer
    }
   Output("CB8",54,144)
    {
    Cond = "NumC>=8"
    Type = Integer
    }
   Output("CB9",54,162)
    {
    Cond = "NumC>=9"
    Type = Integer
    }
   }

  Graphics = 
   {
   Rectangle(-39,-111,39,168)
   Pen(ByNode,ByNode,ByNode,Manual)
   Line(-54,-54,-39,-54)
   Pen(,Solid)
   Line(-39,-54,-44,-59)
   Line(-39,-54,-44,-49)
   Pen(,ByNode)
   Line(-55,0,-40,0)
   Pen(,Solid)
   Line(-39,0,-44,-5)
   Line(-39,0,-44,5)
   Pen(,ByNode)
   Cond = "NumC>=1"
   Line(54,18,39,18)
   Cond = "NumC>=2"
   Line(54,36,39,36)
   Cond = "NumC>=3"
   Line(54,54,39,54)
   Cond = "Mode==2"
   Line(-54,54,-39,54)
   Pen(,Solid)
   Line(-39,54,-44,49)
   Line(-39,54,-44,59)
   Pen(,ByNode)
   Cond = "NumC>=4"
   Line(54,72,39,72)
   Cond = "NumC>=5"
   Line(54,90,39,90)
   Cond = "NumL>=1"
   Line(54,-90,39,-90)
   Cond = "NumL>=2"
   Line(54,-72,39,-72)
   Cond = "NumL>=3"
   Line(54,-54,39,-54)
   Cond = "NumL>=4"
   Line(54,-36,39,-36)
   Cond = "NumL>=5"
   Line(54,-18,39,-18)
   Cond = "Mode==1"
   Line(-54,54,-39,54)
   Pen(,Solid)
   Line(-39,54,-44,49)
   Line(-39,54,-44,59)
   Pen(,ByNode)
   Cond = "true"
   Line(54,0,39,0)
   Cond = "Mode==3"
   Line(-54,54,-39,54)
   Pen(,Solid)
   Line(-39,54,-44,49)
   Line(-39,54,-44,59)
   Cond = "true"
   Text(-1,180,"Switched Shunt")
   Cond = "Mode==1"
   Text(-1,192,"Voltage Control Mode")
   Cond = "true"
   Text(-25,-50,"VInit")
   Text(-25,4,"QInit")
   Cond = "NumC>=1"
   Text(26,22,"CB1")
   Cond = "NumC>=2"
   Text(26,40,"CB2")
   Cond = "NumC>=3"
   Text(26,58,"CB3")
   Cond = "Mode==2"
   Text(-22,58,"Alpha")
   Cond = "NumC>=4"
   Text(26,76,"CB4")
   Cond = "NumC>=5"
   Text(26,94,"CB5")
   Cond = "NumL>=1"
   Text(26,-87,"LB1")
   Cond = "NumL>=2"
   Text(26,-68,"LB2")
   Cond = "NumL>=3"
   Text(26,-50,"LB3")
   Cond = "NumL>=4"
   Text(26,-32,"LB4")
   Cond = "NumL>=5"
   Text(26,-14,"LB5")
   Cond = "Mode==1"
   Text(-19,58,"VMeas")
   Cond = "Mode==2"
   Text(-23,69,"(deg)")
   Cond = "Mode==1"
   Text(-27,67,"(pu)")
   Cond = "true"
   Text(22,-1,"Banks")
   Text(22,8,"On")
   Cond = "Mode==3"
   Text(-18,58,"Manual")
   Text(-13,67,"Up/Down")
   Text(-27,76,"1/-1")
   Cond = "true"
   Text(-26,-42,"(pu)")
   Text(-18,13,"(MVAR")
   Text(-15,22,"+ve out)")
   Text(-34,-99,"E")
   Cond = "Mode==2"
   Text(-2,192,"SVC TSC Control Mode")
   Cond = "Mode==3"
   Text(-3,192,"Manual Control Mode")
   Pen(Real,ByNode)
   Cond = "NumC>=6"
   Line(54,108,39,108)
   Text(26,112,"CB6")
   Cond = "NumC>=7"
   Line(54,126,39,126)
   Cond = "NumC>=8"
   Line(54,144,39,144)
   Cond = "NumC>=7"
   Text(26,130,"CB7")
   Cond = "NumC>=8"
   Text(26,148,"CB8")
   Cond = "NumC>=9"
   Line(54,162,39,162)
   Text(26,166,"CB9")
   }

  Section(EMTDC)
   {
   Fortran = "\
#LOCAL REAL Q_V1
#LOCAL REAL TIME_SINCE_LAST_SWITCH
#STORAGE INTEGER:1
#STORAGE REAL:1
      IF ( (TIME.LT.$TStart).OR.($EnableD.EQ.0) ) THEN
         Q_V1 = $QInit / ($VInit*$VInit)
         IF ( Q_V1 .GT. 0.0 ) THEN
! Initial State is Capacitive
            #IF ( NumC >= 1 )
               $BanksOn = NINT(Q_V1/$MVARC)
               IF ( $BanksOn .GT. $NumC ) $BanksOn = $NumC
            #ELSE
               $BanksOn = 0
            #ENDIF
         ELSEIF ( Q_V1 .LT. 0.0 ) THEN
! Initial State is Inductive
            #IF ( NumL >= 1 )
               $BanksOn = NINT(Q_V1/$MVARL)
               IF ( $BanksOn .LT. -$NumL ) $BanksOn = -$NumL
            #ELSE
               $BanksOn = 0
            #ENDIF
         ELSE
            $BanksOn = 0
         ENDIF
         TIME_SINCE_LAST_SWITCH = $TDelay
      ELSE
         $BanksOn = STORI(NSTORI+0)
         TIME_SINCE_LAST_SWITCH = STORF(NSTORF+0) + DELT
         IF ( TIME_SINCE_LAST_SWITCH .GE. $TDelay ) THEN
            #IF ( Mode==1 )
! Voltage Mode - add or remove shunt elements if the measured voltage is outside of the desired range...
               IF ( ($BanksOn.LT.$NumC).AND.($VMeas .LE. $VLow) ) THEN
                  $BanksOn = $BanksOn + 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
               IF ( ($BanksOn.GT.(-$NumL)).AND.($VMeas .GE. $VHigh) ) THEN
                  $BanksOn = $BanksOn - 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
            #ENDIF
            #IF ( Mode==2 )
! SVC Mode - add or remove shunt elements if the firing angle is outside of the desired range...
               IF ( ($BanksOn.LT.$NumC).AND.($Alpha .GE. $AlphaHigh) ) THEN
                  $BanksOn = $BanksOn + 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
               IF ( ($BanksOn.GT.(-$NumL)).AND.($Alpha .LE. $AlphaLow) ) THEN
                  $BanksOn = $BanksOn - 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
            #ENDIF
            #IF ( Mode==3 )
! Maunal Mode - add or remove shunt elements when the manual input telle you to...
               IF ( ($BanksOn.LT.$NumC).AND.($Manual .GE. 1) ) THEN
                  $BanksOn = $BanksOn + 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
               IF ( ($BanksOn.GT.(-$NumL)).AND.($Manual .LE. -1) ) THEN
                  $BanksOn = $BanksOn - 1
                  TIME_SINCE_LAST_SWITCH = 0.0
               ENDIF
            #ENDIF
         ENDIF
      ENDIF

! Set State of Reactor Bank Breakers
#IF ( NumL >= 1 )
      IF ( $BanksOn .LE. -1 ) THEN
         $LB1 = 0
      ELSE
         $LB1 = 1
      ENDIF
#ENDIF
#IF ( NumL >= 2 )
      IF ( $BanksOn .LE. -2 ) THEN
         $LB2 = 0
      ELSE
         $LB2 = 1
      ENDIF
#ENDIF
#IF ( NumL >= 3 )
      IF ( $BanksOn .LE. -3 ) THEN
         $LB3 = 0
      ELSE
         $LB3 = 1
      ENDIF
#ENDIF
#IF ( NumL >= 4 )
      IF ( $BanksOn .LE. -4 ) THEN
         $LB4 = 0
      ELSE
         $LB4 = 1
      ENDIF
#ENDIF
#IF ( NumL >= 5 )
      IF ( $BanksOn .LE. -5 ) THEN
         $LB5 = 0
      ELSE
         $LB5 = 1
      ENDIF
#ENDIF
#IF ( NumL >= 5 )
      IF ( $BanksOn .LE. -5 ) THEN
         $LB5 = 0
      ELSE
         $LB5 = 1
      ENDIF
#ENDIF

! Set State of Capacitor Bank Breakers
#IF ( NumC >= 1 )
      IF ( $BanksOn .GE. 1 ) THEN
         $CB1 = 0
      ELSE
         $CB1 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 2 )
      IF ( $BanksOn .GE. 2 ) THEN
         $CB2 = 0
      ELSE
         $CB2 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 3 )
      IF ( $BanksOn .GE. 3 ) THEN
         $CB3 = 0
      ELSE
         $CB3 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 4 )
      IF ( $BanksOn .GE. 4 ) THEN
         $CB4 = 0
      ELSE
         $CB4 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 5 )
      IF ( $BanksOn .GE. 5 ) THEN
         $CB5 = 0
      ELSE
         $CB5 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 6 )
      IF ( $BanksOn .GE. 6 ) THEN
         $CB6 = 0
      ELSE
         $CB6 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 7 )
      IF ( $BanksOn .GE. 7 ) THEN
         $CB7 = 0
      ELSE
         $CB7 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 8 )
      IF ( $BanksOn .GE. 8 ) THEN
         $CB8 = 0
      ELSE
         $CB8 = 1
      ENDIF
#ENDIF
#IF ( NumC >= 9 )
      IF ( $BanksOn .GE. 9 ) THEN
         $CB9 = 0
      ELSE
         $CB9 = 1
      ENDIF
#ENDIF
! Update Storage
      STORI(NSTORI+0) = $BanksOn
      NSTORI = NSTORI + 1
      STORF(NSTORF+0) = TIME_SINCE_LAST_SWITCH
      NSTORF = NSTORF + 1"
   Branch = ""
   Computations = ""
   }
  }
 Component("xfmr_2w_scaled")
  {
  Desc = "3 Phase 2 Winding Transformer - With Scaling!"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("Name",6,2,202,12,2)
     {
     Desc = "Transformer Name"
     Def = "T32"
     Len = 15
     }
    Input("Tmva",6,16,202,12,2)
     {
     Desc = "3 Phase Transformer MVA"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 1e-006
     }
    Input("f",6,30,202,12,2)
     {
     Desc = "Base operation frequency"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0.0001
     }
    Choice("YD1",6,44,202,11,2)
     {
     Style = 0
     Desc = "Winding #1 Type"
     Def = "0"
     Len = 15
     *0 = "Y"
     *1 = "Delta"
     }
    Choice("YD2",6,58,202,11,2)
     {
     Style = 0
     Desc = "Winding #2 Type"
     Def = "1"
     Len = 15
     *0 = "Y"
     *1 = "Delta"
     }
    Choice("Lead",6,72,202,11,2)
     {
     Style = 0
     Desc = "Delta Lags or Leads Y"
     Def = "1"
     Len = 15
     Cond = "YD1 != YD2"
     *1 = "Lags"
     *2 = "Leads"
     }
    Input("Xl",6,86,202,12,2)
     {
     Desc = "Positive sequence leakage reactance"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Choice("Ideal",6,100,202,11,2)
     {
     Style = 0
     Desc = "Ideal Transformer Model"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Input("NLL",6,114,202,12,2)
     {
     Desc = "No load losses"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Input("CuL",6,128,202,12,2)
     {
     Desc = "Copper losses"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Choice("Tap",6,142,202,11,2)
     {
     Style = 0
     Desc = "Tap changer on winding"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "None"
     *1 = "#1"
     *2 = "#2"
     }
    Choice("View",6,156,202,11,2)
     {
     Style = 0
     Desc = "Graphics Display"
     Def = "0"
     Len = 24
     Cond = "(true)"
     *0 = "3 phase view"
     *1 = "Single line (circles)"
     *2 = "Single line (windings)"
     }
    Choice("Dtls",6,170,202,11,2)
     {
     Style = 0
     Desc = "Display Details?"
     Def = "0"
     Len = 15
     Cond = "View!=0"
     *0 = "No"
     *1 = "Yes"
     }
    }
   Category("Winding Voltages")
    {
    Input("V1",5,4,201,12,2)
     {
     Desc = "Winding 1 Line to Line voltage (RMS)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("V2",5,20,201,12,2)
     {
     Desc = "Winding 2 Line to Line voltage (RMS)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    }
   Category("Saturation")
    {
    Choice("Enab",6,2,202,12,2)
     {
     Style = 0
     Desc = "Saturation Enabled"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Choice("Sat",6,16,202,11,2)
     {
     Style = 0
     Desc = "Saturation Placed on Winding"
     Def = "1"
     Len = 15
     *1 = "#1"
     *2 = "#2"
     }
    Input("Xair",6,30,202,12,2)
     {
     Desc = "Air core reactance"
     Def = "0.2"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.001
     Max = 10
     }
    Input("Tdc",6,44,202,12,2)
     {
     Desc = "In rush decay time constant"
     Def = "1.0"
     Data = Real
     Unit = "s"
     Len = 15
     Min = -100
     }
    Input("Xknee",6,58,202,12,2)
     {
     Desc = "Knee voltage"
     Def = "1.25"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     }
    Input("Txk",6,72,202,12,2)
     {
     Desc = "Time to release flux clipping"
     Def = "0.1"
     Data = Real
     Unit = "s"
     Len = 15
     Min = 0
     Max = 1e+006
     }
    Input("Im1",6,86,202,12,2)
     {
     Desc = "Magnetizing current"
     Def = "0.4"
     Data = Real
     Unit = "%"
     Len = 15
     Min = 0.0001
     Max = 1000
     }
    }
   Category("Winding 1 Line Currents")
    {
    Text("ILA1",5,4,201,12,2)
     {
     Desc = "Name for Phase A Current (+in,kA)"
     Len = 15
     }
    Text("ILB1",5,20,201,12,2)
     {
     Desc = "Name for Phase B Current (+in,kA)"
     Len = 15
     }
    Text("ILC1",5,36,201,12,2)
     {
     Desc = "Name for Phase C Current (+in,kA)"
     Len = 15
     }
    }
   Category("Winding 1 Delta Currents")
    {
    Cond = "(YD1)"
    Text("IAB1",5,4,201,12,2)
     {
     Desc = "Name for A->B Winding Current (kA)"
     Len = 15
     }
    Text("IBC1",5,20,201,12,2)
     {
     Desc = "Name for B->C Winding Current (kA)"
     Len = 15
     }
    Text("ICA1",5,36,201,12,2)
     {
     Desc = "Name for C->A Winding Current (kA)"
     Len = 15
     }
    }
   Category("Winding 2 Line Currents")
    {
    Text("ILA2",5,4,201,12,2)
     {
     Desc = "Name for Phase A Current (+in,kA)"
     Len = 15
     }
    Text("ILB2",5,20,201,12,2)
     {
     Desc = "Name for Phase B Current (+in,kA)"
     Len = 15
     }
    Text("ILC2",5,36,201,12,2)
     {
     Desc = "Name for Phase C Current (+in,kA)"
     Len = 15
     }
    }
   Category("Winding 2 Delta Currents")
    {
    Cond = "(YD2)"
    Text("IAB2",5,4,201,12,2)
     {
     Desc = "Name for A->B Winding Current (kA)"
     Len = 15
     }
    Text("IBC2",5,20,201,12,2)
     {
     Desc = "Name for B->C Winding Current (kA)"
     Len = 15
     }
    Text("ICA2",5,36,201,12,2)
     {
     Desc = "Name for C->A Winding Current (kA)"
     Len = 15
     }
    }
   Category("Monitoring of Flux and Magn Current")
    {
    Cond = "((Sat==1 ? YD1 : YD2) == 0)"
    Text("IMA",5,4,201,12,2)
     {
     Desc = "Name for Phase A Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMB",5,20,201,12,2)
     {
     Desc = "Name for Phase B Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMC",5,36,201,12,2)
     {
     Desc = "Name for Phase C Magn. Curr. (kA)"
     Len = 15
     }
    Text("FLXA",5,52,201,12,2)
     {
     Desc = "Name for Phase A Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXB",5,68,201,12,2)
     {
     Desc = "Name for Phase B Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXC",5,84,201,12,2)
     {
     Desc = "Name for Phase C Flux Linkage (kWb-N)"
     Len = 15
     }
    }
   Category("Monitoring of Flux and Magn Current:2")
    {
    Cond = "((Sat==1 ? YD1 : YD2) == 1)"
    Text("IMAB",5,4,201,12,2)
     {
     Desc = "Name for Phase A->B Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMBC",5,20,201,12,2)
     {
     Desc = "Name for Phase B->C Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMCA",5,36,201,12,2)
     {
     Desc = "Name for Phase C->A Magn. Curr. (kA)"
     Len = 15
     }
    Text("FLXAB",5,52,201,12,2)
     {
     Desc = "Name for Phase A->B Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXBC",5,68,201,12,2)
     {
     Desc = "Name for Phase B->C Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXCA",5,84,201,12,2)
     {
     Desc = "Name for Phase C->A Flux Linkage (kWb-N)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("G1",-18,36)
    {
    Cond = "(YD1==0)&&(View!=0)"
    }
   Input("TapI",-54,-18)
    {
    Cond = "(Tap)&&(View!=0)"
    Type = Real
    }
   Input("TapI",-18,-72)
    {
    Cond = "(Tap)&&(View==0)"
    Type = Real
    }
   Electrical("G2",0,36)
    {
    Cond = "(YD2==0)&&(View!=0)"
    }
   Electrical("G2",0,0)
    {
    Cond = "(YD2==1)"
    Type = Ground
    }
   Electrical("G1",-18,0)
    {
    Cond = "(YD1==1)"
    Type = Ground
    }
   Electrical("G1",-18,72)
    {
    Cond = "(YD1==0)&&(View==0)"
    }
   Electrical("X2",18,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X1",-36,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X1",-36,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X2",18,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("XA1",-36,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC1",-36,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA1",-36,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC1",-36,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA2",72,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB2",72,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC2",72,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC2",72,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA2",72,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB2",72,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("G2",36,72)
    {
    Cond = "(YD2==0)&&(View==0)"
    }
   Electrical("C1",-54,36)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("C1",-54,36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("C2",90,36)
    {
    Cond = "(View==0)"
    Type = Removable
    }
   Electrical("B2",90,0)
    {
    Cond = "(View==0)"
    Type = Removable
    }
   Electrical("A2",90,-36)
    {
    Cond = "(View==0)"
    Type = Removable
    }
   Electrical("A1",-54,-36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("A1",-54,-36)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("N1",-54,0)
    {
    Cond = "(View!=0)&&(YD1==1||CuL<=0.0)"
    Dim  = [3]
    }
   Electrical("N2",36,0)
    {
    Cond = "(View!=0)&&(YD2==1||CuL<=0.0)"
    Dim  = [3]
    }
   Electrical("N1",-54,0)
    {
    Cond = "(View!=0)&&(YD1==0)&&(CuL>0.0)"
    Dim  = [3]
    }
   Electrical("N2",36,0)
    {
    Cond = "(View!=0)&&(YD2==0)&&(CuL>0.0)"
    Dim  = [3]
    }
   Electrical("XB1",-36,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB1",-36,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("B1",-54,0)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("B1",-54,0)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Input("scl",-36,-72)
    {
    Cond = "(View==0)"
    Type = Real
    }
   Electrical("na1",-72,-36)
    {
    Cond = "(View==0)"
    }
   Electrical("nb1",-72,0)
    {
    Cond = "(View==0)"
    }
   Electrical("nc1",-72,36)
    {
    Cond = "(View==0)"
    }
   Input("scl",-18,-36)
    {
    Cond = "(View!=0)"
    Type = Real
    }
   Electrical("NN1",-72,0)
    {
    Cond = "(View!=0)"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Pen(,,0.6)
   Cond = "(View==1)"
   Ellipse(-40,-18,-4,18)
   Pen(,,0.2)
   Cond = "(View==0)"
   Line(90,-36,72,-36)
   Line(90,0,72,0)
   Line(90,36,72,36)
   Cond = "(YD1==0)&&(View==0)"
   Line(-4,-5,-4,16)
   Cond = "(YD2==0)&&(View==0)"
   Line(22,-5,4,-16)
   Line(22,-5,22,16)
   Cond = "(YD2!=0)&&(View==0)"
   Line(40,-16,58,16)
   Line(58,16,22,16)
   Line(22,16,40,-16)
   Cond = "(YD1!=0)&&(View==0)"
   Line(-4,16,-40,16)
   Line(-40,16,-22,-16)
   Line(-22,-16,-4,16)
   Cond = "(YD1==0)&&(View==0)"
   Line(-18,49,-18,72)
   Cond = "(YD2==0)&&(View==0)"
   Line(36,49,36,72)
   Cond = "(YD1==0)&&(View==0)"
   Line(-4,-5,-22,-16)
   Line(-4,-5,14,-16)
   Cond = "(YD1==0)&&(View==1)"
   Line(-24,23,-21,21)
   Line(-24,23,-27,21)
   Line(-24,23,-24,27)
   Cond = "(YD1!=0)&&(View==1)"
   Line(-24,20,-21,27)
   Line(-27,27,-24,20)
   Line(-21,27,-27,27)
   Cond = "(YD2!=0)&&(View==1)"
   Line(3,27,6,20)
   Line(9,27,3,27)
   Line(6,20,9,27)
   Cond = "(YD2==0)&&(View==1)"
   Line(6,23,3,21)
   Line(6,23,9,21)
   Line(6,23,6,27)
   Pen(,,0.6)
   Cond = "(View==1)"
   Ellipse(-15,-18,21,18)
   Line(21,0,36,0)
   Line(-53,0,-41,0)
   Pen(,,0.2)
   Line(-46,3,-42,-4)
   Cond = "View==1"
   Line(-49,3,-45,-4)
   Line(-52,3,-48,-4)
   Cond = "(View==1)"
   Line(28,3,33,-4)
   Cond = "View==1"
   Line(22,3,27,-4)
   Line(25,3,30,-4)
   Cond = "(YD1==0)&&(View==1)"
   Line(-18,16,-18,36)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-7,-18,1,-9,-450,-180)
   Arc(-19,-9,-10,0,-270,-180)
   Arc(-7,-9,1,0,-450,-180)
   Line(-3,0,36,0)
   Pen(,,0.2)
   Cond = "(YD1!=0)&&(View==2)"
   Line(-16,27,-13,21)
   Line(-10,27,-16,27)
   Line(-13,21,-10,27)
   Cond = "(YD1==0)&&(View==2)"
   Line(-13,23,-16,21)
   Line(-13,23,-10,21)
   Line(-13,23,-13,27)
   Cond = "(YD2!=0)&&(View==2)"
   Line(-7,27,-4,21)
   Line(-4,21,-1,27)
   Line(-1,27,-7,27)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-7,21)
   Cond = "(YD2==0)&&(View==1)"
   Line(0,18,0,36)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-1,21)
   Line(0,18,0,36)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-19,-18,-10,-9,-270,-180)
   Pen(,,0.2)
   Cond = "(YD1==0)&&(View==2)"
   Line(-18,18,-18,36)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-4,27)
   Cond = "View==2"
   Line(-10,24,-7,24)
   Pen(,,0.6)
   Arc(-7,0,1,9,-450,-180)
   Pen(,,0.2)
   Cond = "(YD1==0)&&(View==2)"
   Line(-15,18,-18,18)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-19,9,-10,18,-270,-180)
   Arc(-7,9,1,18,-450,-180)
   Arc(-19,0,-10,9,-270,-180)
   Pen(,,0.2)
   Cond = "(YD2==0)&&(View==2)"
   Line(0,18,-3,18)
   Pen(,,0.6)
   Cond = "View==2"
   Line(-71,0,-15,0)
   Cond = "(tap!=0)&&(View==2)"
   Line(-9,-12,-7,-22)
   Line(-12,-13,-7,-22)
   Line(-21,19,-7,-22)
   Cond = "(tap!=0)&&(View==1)"
   Line(-24,-12,-25,-22)
   Line(-21,-13,-25,-22)
   Line(-12,19,-25,-22)
   Pen(,,0.2)
   Cond = "(tap!=0)&&(View!=0)"
   Line(-54,-18,-42,-18)
   Cond = "(tap!=0)&&(View==1)"
   Line(-42,-18,-19,-1)
   Cond = "(tap!=0)&&(View==2)"
   Line(-42,-18,-15,-4)
   Cond = "(Tap!=0)&&(View==0)"
   Line(-18,-54,-18,-72)
   Line(-23,-59,-18,-54)
   Line(-18,-54,-12,-59)
   Cond = "(View==0)"
   Rectangle(-54,-54,72,50)
   Cond = "(YD2==0)&&(View==0)"
   Line(22,-5,40,-16)
   Cond = "(View==0)"
   Text(81,-37,"A")
   Text(81,-1,"B")
   Text(81,34,"C")
   Text(40,47,"%V2")
   Text(58,6,"#2")
   Text(-22,6,"#1")
   Text(-22,46,"%V1")
   Text(7,-23,"%Tmva")
   Cond = "(View==1)"
   Text(-25,6,"#1")
   Text(6,6,"#2")
   Cond = "(View==2)"
   Text(-24,-7,"#1")
   Text(7,-7,"#2")
   Cond = "(View!=0)&&(Dtls==1)"
   Text(32,-35,"%Tmva")
   Text(34,-20,"%V1 / %V2")
   Cond = "(Tap!=0)&&(View==0)"
   Text(-7,-57,"Tap")
   Pen(,,0.6)
   Cond = "(View==0)"
   Line(-36,-72,-36,-54)
   Text(-46,-60,"scl")
   Pen(,,0.2)
   Line(-72,-36,-54,-36)
   Text(-62,-40,"A")
   Line(-72,0,-54,0)
   Text(-63,-4,"B")
   Line(-72,36,-54,36)
   Text(-62,32,"C")
   Font(,,Right)
   Text(21,-42,"scalar model")
   Pen(,,0.6)
   Cond = "(View==1)"
   Line(-18,-37,-18,-17)
   Cond = "View==2"
   Line(-18,-18,-18,-36)
   Line(-17,-18,-14,-18)
   Cond = "(View==1)"
   Line(-71,0,-54,0)
   Font(,,Centre)
   Cond = "(View==2)"
   Text(-23,12,"E")
   Cond = "(View==1)"
   Text(-24,-7,"s")
   Font(,,Left)
   Cond = "(View==2)"
   Text(-16,-33,"Scl")
   }

  Section(EMTDC)
   {
   Computations = "\
INTEGER NCW = Ideal ? -2 : 2
REAL    MVA = Tmva/3
REAL    XL1 = xl*0.5
REAL    V_1 = YD1 ? V1 : V1/sqrt(3.0)
REAL    V_2 = YD2 ? V2 : V2/sqrt(3.0)
REAL    I_m1= Im1*0.01
REAL    I_m2= I_m1
REAL    w   = 2*pi*f
REAL    ib1 = MVA/V_1
REAL    zb1 = V_1/ib1
REAL    ib2 = MVA/V_2
REAL    tr  = V_1/V_2
REAL    L1  = Ideal==1 ? w/(XL1*zb1) : V_1/(w*I_m1*ib1)
REAL    L2  = Ideal==1 ? tr*tr*L1   : V_2/(w*I_m2*ib2)
REAL    L12 = Ideal==1 ? -tr*L1     : (1-XL1*zb1/(2*w*L1))*sqrt(L1*L2)
REAL    Rd1 = NLL ? 2.0*V_1*V_1/(MVA*NLL) : 0
REAL    Rd2 = NLL ? 2.0*V_2*V_2/(MVA*NLL) : 0
REAL    Rc1 = CuL>0.0 ? 0.5*CuL*MVA/(ib1*ib1) : 0
REAL    Rc2 = CuL>0.0 ? 0.5*CuL*MVA/(ib2*ib2) : 0
INTEGER SW  = Enab ? Sat : 0"
   Branch = "\
#IF CuL>0
 #IF View==0
$A1 $XA1     $Rc1 0.0 0.0
$B1 $XB1     $Rc1 0.0 0.0
$C1 $XC1     $Rc1 0.0 0.0
$A2 $XA2     $Rc2 0.0 0.0
$B2 $XB2     $Rc2 0.0 0.0
$C2 $XC2     $Rc2 0.0 0.0
 #ELSE
$N1(1) $X1(1)     $Rc1 0.0 0.0
$N1(2) $X1(2)     $Rc1 0.0 0.0
$N1(3) $X1(3)     $Rc1 0.0 0.0
$N2(1) $X2(1)     $Rc2 0.0 0.0
$N2(2) $X2(2)     $Rc2 0.0 0.0
$N2(3) $X2(3)     $Rc2 0.0 0.0
 #ENDIF
 #IF NLL>0
  #IF View==0
#CASE YD1*Lead {$XA1 $G1     $Rd1 0.0 0.0} {$XA1 $B1     $Rd1 0.0 0.0} {$XA1 $C1     $Rd1 0.0 0.0}
#CASE YD1*Lead {$XB1 $G1     $Rd1 0.0 0.0} {$XB1 $C1     $Rd1 0.0 0.0} {$XB1 $A1     $Rd1 0.0 0.0}
#CASE YD1*Lead {$XC1 $G1     $Rd1 0.0 0.0} {$XC1 $A1     $Rd1 0.0 0.0} {$XC1 $B1     $Rd1 0.0 0.0}
#CASE YD2*Lead {$XA2 $G2     $Rd2 0.0 0.0} {$XA2 $B2     $Rd2 0.0 0.0} {$XA2 $C2     $Rd2 0.0 0.0}
#CASE YD2*Lead {$XB2 $G2     $Rd2 0.0 0.0} {$XB2 $C2     $Rd2 0.0 0.0} {$XB2 $A2     $Rd2 0.0 0.0}
#CASE YD2*Lead {$XC2 $G2     $Rd2 0.0 0.0} {$XC2 $A2     $Rd2 0.0 0.0} {$XC2 $B2     $Rd2 0.0 0.0}
  #ELSE
#CASE YD1*Lead {$X1(1) $G1     $Rd1 0.0 0.0} {$X1(1) $N1(2)     $Rd1 0.0 0.0} {$X1(1) $N1(3)     $Rd1 0.0 0.0}
#CASE YD1*Lead {$X1(2) $G1     $Rd1 0.0 0.0} {$X1(2) $N1(3)     $Rd1 0.0 0.0} {$X1(2) $N1(1)     $Rd1 0.0 0.0}
#CASE YD1*Lead {$X1(3) $G1     $Rd1 0.0 0.0} {$X1(3) $N1(1)     $Rd1 0.0 0.0} {$X1(3) $N1(2)     $Rd1 0.0 0.0}
#CASE YD2*Lead {$X2(1) $G2     $Rd2 0.0 0.0} {$X2(1) $N2(2)     $Rd2 0.0 0.0} {$X2(1) $N2(3)     $Rd2 0.0 0.0}
#CASE YD2*Lead {$X2(2) $G2     $Rd2 0.0 0.0} {$X2(2) $N2(3)     $Rd2 0.0 0.0} {$X2(2) $N2(1)     $Rd2 0.0 0.0}
#CASE YD2*Lead {$X2(3) $G2     $Rd2 0.0 0.0} {$X2(3) $N2(1)     $Rd2 0.0 0.0} {$X2(3) $N2(2)     $Rd2 0.0 0.0}
  #ENDIF
 #ENDIF
#ELSE 
 #IF NLL>0
  #IF View==0
#CASE YD1 {$A1 $G1     $Rd1 0.0 0.0} {$A1 $B1     $Rd1 0.0 0.0}
#CASE YD1 {$B1 $G1     $Rd1 0.0 0.0} {$B1 $C1     $Rd1 0.0 0.0}
#CASE YD1 {$C1 $G1     $Rd1 0.0 0.0} {$C1 $A1     $Rd1 0.0 0.0}
#CASE YD2 {$A2 $G2     $Rd2 0.0 0.0} {$A2 $B2     $Rd2 0.0 0.0}
#CASE YD2 {$B2 $G2     $Rd2 0.0 0.0} {$B2 $C2     $Rd2 0.0 0.0}
#CASE YD2 {$C2 $G2     $Rd2 0.0 0.0} {$C2 $A2     $Rd2 0.0 0.0}
  #ELSE
#CASE YD1 {$N1(1) $G1     $Rd1 0.0 0.0} {$N1(1) $N1(2)     $Rd1 0.0 0.0}
#CASE YD1 {$N1(2) $G1     $Rd1 0.0 0.0} {$N1(2) $N1(3)     $Rd1 0.0 0.0}
#CASE YD1 {$N1(3) $G1     $Rd1 0.0 0.0} {$N1(3) $N1(1)     $Rd1 0.0 0.0}
#CASE YD2 {$N2(1) $G2     $Rd2 0.0 0.0} {$N2(1) $N2(2)     $Rd2 0.0 0.0}
#CASE YD2 {$N2(2) $G2     $Rd2 0.0 0.0} {$N2(2) $N2(3)     $Rd2 0.0 0.0}
#CASE YD2 {$N2(3) $G2     $Rd2 0.0 0.0} {$N2(3) $N2(1)     $Rd2 0.0 0.0}
  #ENDIF
 #ENDIF
#ENDIF"
   Transformers = "\
#TRANSFORMERS 3
#WINDINGS 2
C   3 Phase, 2 Winding Transformer
C*     Name: %Name   Tmva: $Tmva MVA,    Freq: $f Hz,   V1: $V1 kV,      V2: $V2 kV
C*     Imag1: $I_m1 p.u.,    Imag2: $I_m2 p.u.,   Xl: $Xl p.u.
C*     Sat: $SW ,      ~
#IF SW
~      Xair: $Xair p.u.,     Knee: $Xknee p.u.,   Tdc: $Tdc sec
#ENDIF
  $NCW / Number of windings...
#IF CuL>0
 #IF View==0
#CASE YD1*Lead  {  $XA1 $G1 ~}  {  $XA1 $B1 ~}  {  $XA1 $C1 ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $XA2 $G2 ~}  {  $XA2 $B2 ~}  {  $XA2 $C2 ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $XB1 $G1 /}  {  $XB1 $C1 /}  {  $XB1 $A1 /}
#CASE YD2*Lead  {  $XB2 $G2 /}  {  $XB2 $C2 /}  {  $XB2 $A2 /}
 888 /
#CASE YD1*Lead  {  $XC1 $G1 /}  {  $XC1 $A1 /}  {  $XC1 $B1 /}
#CASE YD2*Lead  {  $XC2 $G2 /}  {  $XC2 $A2 /}  {  $XC2 $B2 /}
 #ELSE
#CASE YD1*Lead  {  $X1(1) $G1 ~}  {  $X1(1) $N1(2) ~}  {  $X1(1) $N1(3) ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $X2(1) $G2 ~}  {  $X2(1) $N2(2) ~}  {  $X2(1) $N2(3) ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $X1(2) $G1 /}  {  $X1(2) $N1(3) /}  {  $X1(2) $N1(1) /}
#CASE YD2*Lead  {  $X2(2) $G2 /}  {  $X2(2) $N2(3) /}  {  $X2(2) $N2(1) /}
 888 /
#CASE YD1*Lead  {  $X1(3) $G1 /}  {  $X1(3) $N1(1) /}  {  $X1(3) $N1(2) /}
#CASE YD2*Lead  {  $X2(3) $G2 /}  {  $X2(3) $N2(1) /}  {  $X2(3) $N2(2) /}
 #ENDIF
#ELSE
 #IF View==0
#CASE YD1*Lead  {  $A1 $G1 ~}  {  $A1 $B1 ~}  {  $A1 $C1 ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $A2 $G2 ~}  {  $A2 $B2 ~}  {  $A2 $C2 ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $B1 $G1 /}  {  $B1 $C1 /}  {  $B1 $A1 /}
#CASE YD2*Lead  {  $B2 $G2 /}  {  $B2 $C2 /}  {  $B2 $A2 /}
 888 /
#CASE YD1*Lead  {  $C1 $G1 /}  {  $C1 $A1 /}  {  $C1 $B1 /}
#CASE YD2*Lead  {  $C2 $G2 /}  {  $C2 $A2 /}  {  $C2 $B2 /}
 #ELSE
#CASE YD1*Lead  {  $N1(1) $G1 ~}  {  $N1(1) $N1(2) ~}  {  $N1(1) $N1(3) ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $N2(1) $G2 ~}  {  $N2(1) $N2(2) ~}  {  $N2(1) $N2(3) ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $N1(2) $G1 /}  {  $N1(2) $N1(3) /}  {  $N1(2) $N1(1) /}
#CASE YD2*Lead  {  $N2(2) $G2 /}  {  $N2(2) $N2(3) /}  {  $N2(2) $N2(1) /}
 888 /
#CASE YD1*Lead  {  $N1(3) $G1 /}  {  $N1(3) $N1(1) /}  {  $N1(3) $N1(2) /}
#CASE YD2*Lead  {  $N2(3) $G2 /}  {  $N2(3) $N2(1) /}  {  $N2(3) $N2(2) /}
 #ENDIF
#ENDIF
C
"
   Matrix-fill = "\
#IF CuL>0
 #IF View==0
  #IF YD1*Lead==0
   #CASE YD2*Lead {$XA1 $G1 $XA2 $G2} {$XA1 $G1 $XA2 $B2} {$XA1 $G1 $XA2 $C2}
   #CASE YD2*Lead {$XB1 $G1 $XB2 $G2} {$XB1 $G1 $XB2 $C2} {$XB1 $G1 $XC2 $B2}
   #CASE YD2*Lead {$XC1 $G1 $XC2 $G2} {$XC1 $G1 $XC2 $A2} {$XC1 $G1 $XB2 $A2}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$XA1 $B1 $XA2 $G2} {$XA1 $B1 $XA2 $B2} {$XA1 $B1 $XA2 $C2}
   #CASE YD2*Lead {$XB1 $C1 $XB2 $G2} {$XB1 $C1 $XB2 $C2} {$XB1 $C1 $XC2 $B2}
   #CASE YD2*Lead {$XC1 $A1 $XC2 $G2} {$XC1 $A1 $XC2 $A2} {$XC1 $A1 $XB2 $A2}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$XA1 $C1 $XA2 $G2} {$XA1 $C1 $XA2 $B2} {$XA1 $C1 $XA2 $C2}
   #CASE YD2*Lead {$XC1 $B1 $XB2 $G2} {$XC1 $B1 $XB2 $C2} {$XC1 $B1 $XC2 $B2}
   #CASE YD2*Lead {$XB1 $A1 $XC2 $G2} {$XB1 $A1 $XC2 $A2} {$XB1 $A1 $XB2 $A2}
  #ENDIF
 #ELSE
  #IF YD1*Lead==0
   #CASE YD2*Lead {$X1(1) $G1 $X2(1) $G2} {$X1(1) $G1 $X2(1) $N2(2)} {$X1(1) $G1 $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(2) $G1 $X2(2) $G2} {$X1(2) $G1 $X2(2) $N2(3)} {$X1(2) $G1 $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(3) $G1 $X2(3) $G2} {$X1(3) $G1 $X2(3) $N2(1)} {$X1(3) $G1 $X2(2) $N2(1)}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$X1(1) $N1(2) $X2(1) $G2} {$X1(1) $N1(2) $X2(1) $N2(2)} {$X1(1) $N1(2) $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(2) $N1(3) $X2(2) $G2} {$X1(2) $N1(3) $X2(2) $N2(3)} {$X1(2) $N1(3) $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(3) $N1(1) $X2(3) $G2} {$X1(3) $N1(1) $X2(3) $N2(1)} {$X1(3) $N1(1) $X2(2) $N2(1)}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$X1(1) $N1(3) $X2(1) $G2} {$X1(1) $N1(3) $X2(1) $N2(2)} {$X1(1) $N1(3) $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(3) $N1(2) $X2(2) $G2} {$X1(3) $N1(2) $X2(2) $N2(3)} {$X1(3) $N1(2) $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(2) $N1(1) $X2(3) $G2} {$X1(2) $N1(1) $X2(3) $N2(1)} {$X1(2) $N1(1) $X2(2) $N2(1)}
  #ENDIF
 #ENDIF
#ELSE
 #IF View==0
  #IF YD1*Lead==0
   #CASE YD2*Lead {$A1 $G1 $A2 $G2} {$A1 $G1 $A2 $B2} {$A1 $G1 $A2 $C2}
   #CASE YD2*Lead {$B1 $G1 $B2 $G2} {$B1 $G1 $B2 $C2} {$B1 $G1 $C2 $B2}
   #CASE YD2*Lead {$C1 $G1 $C2 $G2} {$C1 $G1 $C2 $A2} {$C1 $G1 $B2 $A2}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$A1 $B1 $A2 $G2} {$A1 $B1 $A2 $B2} {$A1 $B1 $A2 $C2}
   #CASE YD2*Lead {$B1 $C1 $B2 $G2} {$B1 $C1 $B2 $C2} {$B1 $C1 $C2 $B2}
   #CASE YD2*Lead {$C1 $A1 $C2 $G2} {$C1 $A1 $C2 $A2} {$C1 $A1 $B2 $A2}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$A1 $C1 $A2 $G2} {$A1 $C1 $A2 $B2} {$A1 $C1 $A2 $C2}
   #CASE YD2*Lead {$C1 $B1 $B2 $G2} {$C1 $B1 $B2 $C2} {$C1 $B1 $C2 $B2}
   #CASE YD2*Lead {$B1 $A1 $C2 $G2} {$B1 $A1 $C2 $A2} {$B1 $A1 $B2 $A2}
  #ENDIF
 #ELSE
  #IF YD1*Lead==0
   #CASE YD2*Lead {$N1(1) $G1 $N2(1) $G2} {$N1(1) $G1 $N2(1) $N2(2)} {$N1(1) $G1 $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(2) $G1 $N2(2) $G2} {$N1(2) $G1 $N2(2) $N2(3)} {$N1(2) $G1 $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(3) $G1 $N2(3) $G2} {$N1(3) $G1 $N2(3) $N2(1)} {$N1(3) $G1 $N2(2) $N2(1)}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$N1(1) $N1(2) $N2(1) $G2} {$N1(1) $N1(2) $N2(1) $N2(2)} {$N1(1) $N1(2) $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(2) $N1(3) $N2(2) $G2} {$N1(2) $N1(3) $N2(2) $N2(3)} {$N1(2) $N1(3) $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(3) $N1(1) $N2(3) $G2} {$N1(3) $N1(1) $N2(3) $N2(1)} {$N1(3) $N1(1) $N2(2) $N2(1)}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$N1(1) $N1(3) $N2(1) $G2} {$N1(1) $N1(3) $N2(1) $N2(2)} {$N1(1) $N1(3) $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(3) $N1(2) $N2(2) $G2} {$N1(3) $N1(2) $N2(2) $N2(3)} {$N1(3) $N1(2) $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(2) $N1(1) $N2(3) $G2} {$N1(2) $N1(1) $N2(3) $N2(1)} {$N1(2) $N1(1) $N2(2) $N2(1)}
  #ENDIF
 #ENDIF
#ENDIF"
   Dsdyn = "\
!  TRANSFORMER SATURATION SUBROUTINE
#IF Tap
 #STORAGE STOR:36
 #IF SAT==TAP
  #LOCAL REAL RVD1_1
      RVD1_1 = $TapI
      IF (RVD1_1 .LT. 1.0E-8) RVD1_1 = 1.0
 #ENDIF
#ELSE
 #STORAGE STOR:21
#ENDIF
#SUBROUTINE TSAT21 Transformer Saturation Subroutine
#LOCAL REAL X_KNEE
#If Txk>0
      IF (TIME.GT.$Txk) THEN
         X_KNEE = $Xknee
      ELSE
         X_KNEE = -$Xknee
      ENDIF
#ELSE
      X_KNEE = $Xknee
#ENDIF
#LOCAL REAL TURNS_V
#IF SAT==1
      TURNS_V = $V_1
#ELSE
      TURNS_V = $V_2
#ENDIF
#IF SAT==TAP
     + * RVD1_1
#ENDIF
      CALL TSAT21(~
#IF CuL>0
 #IF View==0
  #IF SAT==1
   #CASE YD1 {~$XA1,$G1, $XB1,$G1, $XC1,$G1,} {~$XA1,$B1, $XB1,$C1, $XC1,$A1,}
  #ELSE
   #CASE YD2 {~$XA2,$G2, $XB2,$G2, $XC2,$G2,} {~$XA2,$B2, $XB2,$C2, $XC2,$A2,}
  #ENDIF
 #ELSE
  #IF SAT==1
   #CASE YD1 {~$X1(1),$G1, $X1(2),$G1, $X1(3),$G1,} {~$X1(1),$N1(2), $X1(2),$N1(3), $X1(3),$N1(1),}
  #ELSE
   #CASE YD2 {~$X2(1),$G2, $X2(2),$G2, $X2(3),$G2,} {~$X2(1),$N2(2), $X2(2),$N2(3), $X2(3),$N2(1),}
  #ENDIF
 #ENDIF
#ELSE
 #IF View==0
  #IF SAT==1
   #CASE YD1 {~$A1,$G1, $B1,$G1, $C1,$G1,} {~$A1,$B1, $B1,$C1, $C1,$A1,}
  #ELSE
   #CASE YD2 {~$A2,$G2, $B2,$G2, $C2,$G2,} {~$A2,$B2, $B2,$C2, $C2,$A2,}
  #ENDIF
 #ELSE
  #IF SAT==1
   #CASE YD1 {~$N1(1),$G1, $N1(2),$G1, $N1(3),$G1,} {~$N1(1),$N1(2), $N1(2),$N1(3), $N1(3),$N1(1),}
  #ELSE
   #CASE YD2 {~$N2(1),$G2, $N2(2),$G2, $N2(3),$G2,} {~$N2(1),$N2(2), $N2(2),$N2(3), $N2(3),$N2(1),}
  #ENDIF
 #ENDIF
#ENDIF
     +$SS,$MVA,TURNS_V,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
#IF (SAT==1 ? YD1 : YD2) == 1
#OUTPUT REAL IMAB  {-STOR(NEXC-21+17)}
#OUTPUT REAL IMBC  {-STOR(NEXC-21+18)}
#OUTPUT REAL IMCA  {-STOR(NEXC-21+19)}
#OUTPUT REAL FLXAB {STOR(NEXC-21+11)}
#OUTPUT REAL FLXBC {STOR(NEXC-21+13)}
#OUTPUT REAL FLXCA {STOR(NEXC-21+15)}
#ELSE
#OUTPUT REAL IMA   {-STOR(NEXC-21+17)}
#OUTPUT REAL IMB   {-STOR(NEXC-21+18)}
#OUTPUT REAL IMC   {-STOR(NEXC-21+19)}
#OUTPUT REAL FLXA  {STOR(NEXC-21+11)}
#OUTPUT REAL FLXB  {STOR(NEXC-21+13)}
#OUTPUT REAL FLXC  {STOR(NEXC-21+15)}
#ENDIF
#IF Tap
      CALL TRTAP5($#[1], $Tap, $SS, $TapI)
      CALL TRTAP5($#[2], $Tap, $SS, $TapI)
      CALL TRTAP5($#[3], $Tap, $SS, $TapI)
#ENDIF
!
"
   Dsout = "\
#IF YD1
#  IF Lead==1
#OUTPUT REAL IAB1 {CDCTR(1,$#[1])}
#OUTPUT REAL IBC1 {CDCTR(1,$#[2])}
#OUTPUT REAL ICA1 {CDCTR(1,$#[3])}
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])-CDCTR(1,$#[3])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])-CDCTR(1,$#[1])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])-CDCTR(1,$#[2])}
#  ELSE
#OUTPUT REAL IAB1 {-CDCTR(1,$#[2])}
#OUTPUT REAL IBC1 {-CDCTR(1,$#[3])}
#OUTPUT REAL ICA1 {-CDCTR(1,$#[1])}
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])-CDCTR(1,$#[2])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])-CDCTR(1,$#[3])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])-CDCTR(1,$#[1])}
#  ENDIF
#ELSE
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])}
#ENDIF
#IF YD2
#  IF Lead==1
#OUTPUT REAL IAB2 {CDCTR(2,$#[1])}
#OUTPUT REAL IBC2 {CDCTR(2,$#[2])}
#OUTPUT REAL ICA2 {CDCTR(2,$#[3])}
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])-CDCTR(2,$#[3])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])-CDCTR(2,$#[1])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])-CDCTR(2,$#[2])}
#  ELSE
#OUTPUT REAL IAB2 {-CDCTR(2,$#[2])}
#OUTPUT REAL IBC2 {-CDCTR(2,$#[3])}
#OUTPUT REAL ICA2 {-CDCTR(2,$#[1])}
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])-CDCTR(2,$#[2])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])-CDCTR(2,$#[3])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])-CDCTR(2,$#[1])}
#  END
#ELSE
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])}
#ENDIF
"
   FORTRAN = "\
#STORAGE REAL:6
#LOCAL REAL OLD_CCIN_a1
#LOCAL REAL OLD_CCIN_b1
#LOCAL REAL OLD_CCIN_c1
#LOCAL REAL OLD_CCIN_a2
#LOCAL REAL OLD_CCIN_b2
#LOCAL REAL OLD_CCIN_c2

#LOCAL REAL NEW_CCIN_a1
#LOCAL REAL NEW_CCIN_b1
#LOCAL REAL NEW_CCIN_c1
#LOCAL REAL NEW_CCIN_a2
#LOCAL REAL NEW_CCIN_b2
#LOCAL REAL NEW_CCIN_c2

#LOCAL REAL IMKa_OLD
#LOCAL REAL IMKb_OLD
#LOCAL REAL IMKc_OLD
#LOCAL REAL IKMa_OLD
#LOCAL REAL IKMb_OLD
#LOCAL REAL IKMc_OLD

#LOCAL REAL IZom 
#LOCAL REAL IZo 
#LOCAL REAL Scl1 

      IZo = 1.0/(($Xl*$V1*$V1)/(2.0*$Tmva*TWO_PI*$f*DELT))
      Scl1 = $scl-1
      IZom = Scl1*IZo

#IF View==0 
! Recall current injections from the last time step
      OLD_CCIN_a1 = STORF(NSTORF+0)
      OLD_CCIN_b1 = STORF(NSTORF+1)
      OLD_CCIN_c1 = STORF(NSTORF+2)
      OLD_CCIN_a2 = STORF(NSTORF+3)
      OLD_CCIN_b2 = STORF(NSTORF+4)
      OLD_CCIN_c2 = STORF(NSTORF+5)

! Compute the branch currents from the last time step
      IMKa_OLD =  VDC($A1,$SS)*IZo - OLD_CCIN_a2
      IMKb_OLD =  VDC($B1,$SS)*IZo - OLD_CCIN_b2
      IMKc_OLD =  VDC($C1,$SS)*IZo - OLD_CCIN_c2
      IKMa_OLD =  VDC($na1,$SS)*IZo - OLD_CCIN_a1
      IKMb_OLD =  VDC($nb1,$SS)*IZo - OLD_CCIN_b1
      IKMc_OLD =  VDC($nc1,$SS)*IZo - OLD_CCIN_c1


! Define the new current injections
      NEW_CCIN_a1 = VDC($A1, $SS)*IZo + IMKa_OLD + (VDC($A1, $SS)*IZo + IMKa_OLD)*Scl1
      NEW_CCIN_b1 = VDC($B1, $SS)*IZo + IMKb_OLD + (VDC($B1, $SS)*IZo + IMKb_OLD)*Scl1
      NEW_CCIN_c1 = VDC($C1, $SS)*IZo + IMKc_OLD + (VDC($C1, $SS)*IZo + IMKc_OLD)*Scl1
      NEW_CCIN_a2 = VDC($na1, $SS)*IZo + IKMa_OLD 
      NEW_CCIN_b2 = VDC($nb1, $SS)*IZo + IKMb_OLD 
      NEW_CCIN_c2 = VDC($nc1, $SS)*IZo + IKMc_OLD 

! Put current injections into the EMTDC main program using CCIN
      CCIN($A1, $SS) = CCIN($A1, $SS) + NEW_CCIN_a2      
      CCIN($B1, $SS) = CCIN($B1, $SS) + NEW_CCIN_b2   
      CCIN($C1, $SS) = CCIN($C1, $SS) + NEW_CCIN_c2   
      CCIN($na1, $SS) = CCIN($na1, $SS) + NEW_CCIN_a1     
      CCIN($nb1, $SS) = CCIN($nb1, $SS) + NEW_CCIN_b1   
      CCIN($nc1, $SS) = CCIN($nc1, $SS) + NEW_CCIN_c1   

! Ensure main program records CCIN current injections at these nodes
      IF ( TIMEZERO ) THEN
         ENABCCIN($A1, $SS) = .TRUE.
         ENABCCIN($B1, $SS) = .TRUE.
         ENABCCIN($C1, $SS) = .TRUE.
         ENABCCIN($na1, $SS) = .TRUE.
         ENABCCIN($nb1, $SS) = .TRUE.
         ENABCCIN($nc1, $SS) = .TRUE.
      ENDIF

         GGIN($A1,$SS) = GGIN($A1,$SS) + IZo
         GGIN($B1,$SS) = GGIN($B1,$SS) + IZo
         GGIN($C1,$SS) = GGIN($C1,$SS) + IZo
         GGIN($na1,$SS) = GGIN($na1,$SS) + IZo + IZom
         GGIN($nb1,$SS) = GGIN($nb1,$SS) + IZo + IZom
         GGIN($nc1,$SS) = GGIN($nc1,$SS) + IZo + IZom
      

! Save current injections for use in the next time step to compute the branch currents
      STORF(NSTORF+0) = VDC($A1, $SS)*IZo + IMKa_OLD
      STORF(NSTORF+1) = VDC($B1, $SS)*IZo + IMKb_OLD
      STORF(NSTORF+2) = VDC($C1, $SS)*IZo + IMKc_OLD
      STORF(NSTORF+3) = VDC($na1, $SS)*IZo + IKMa_OLD 
      STORF(NSTORF+4) = VDC($nb1, $SS)*IZo + IKMb_OLD
      STORF(NSTORF+5) = VDC($nc1, $SS)*IZo + IKMc_OLD
      NSTORF = NSTORF + 6

#ELSE
! Recall current injections from the last time step
      OLD_CCIN_a1 = STORF(NSTORF+0)
      OLD_CCIN_b1 = STORF(NSTORF+1)
      OLD_CCIN_c1 = STORF(NSTORF+2)
      OLD_CCIN_a2 = STORF(NSTORF+3)
      OLD_CCIN_b2 = STORF(NSTORF+4)
      OLD_CCIN_c2 = STORF(NSTORF+5)

! Compute the branch currents from the last time step
      IMKa_OLD =  VDC($N1(1),$SS)*IZo - OLD_CCIN_a2
      IMKb_OLD =  VDC($N1(2),$SS)*IZo - OLD_CCIN_b2
      IMKc_OLD =  VDC($N1(3),$SS)*IZo - OLD_CCIN_c2
      IKMa_OLD =  VDC($NN1(1),$SS)*IZo - OLD_CCIN_a1
      IKMb_OLD =  VDC($NN1(2),$SS)*IZo - OLD_CCIN_b1
      IKMc_OLD =  VDC($NN1(3),$SS)*IZo - OLD_CCIN_c1


! Define the new current injections
      NEW_CCIN_a1 = VDC($N1(1), $SS)*IZo + IMKa_OLD + (VDC($N1(1), $SS)*IZo + IMKa_OLD)*Scl1
      NEW_CCIN_b1 = VDC($N1(2), $SS)*IZo + IMKb_OLD + (VDC($N1(2), $SS)*IZo + IMKb_OLD)*Scl1
      NEW_CCIN_c1 = VDC($N1(3), $SS)*IZo + IMKc_OLD + (VDC($N1(3), $SS)*IZo + IMKc_OLD)*Scl1
      NEW_CCIN_a2 = VDC($NN1(1), $SS)*IZo + IKMa_OLD 
      NEW_CCIN_b2 = VDC($NN1(2), $SS)*IZo + IKMb_OLD 
      NEW_CCIN_c2 = VDC($NN1(3), $SS)*IZo + IKMc_OLD 

! Put current injections into the EMTDC main program using CCIN
      CCIN($N1(1), $SS) = CCIN($N1(1), $SS) + NEW_CCIN_a2      
      CCIN($N1(2), $SS) = CCIN($N1(2), $SS) + NEW_CCIN_b2   
      CCIN($N1(3), $SS) = CCIN($N1(3), $SS) + NEW_CCIN_c2   
      CCIN($NN1(1), $SS) = CCIN($NN1(1), $SS) + NEW_CCIN_a1     
      CCIN($NN1(2), $SS) = CCIN($NN1(2), $SS) + NEW_CCIN_b1   
      CCIN($NN1(3), $SS) = CCIN($NN1(3), $SS) + NEW_CCIN_c1   

! Ensure main program records CCIN current injections at these nodes
      IF ( TIMEZERO ) THEN
         ENABCCIN($N1(1), $SS) = .TRUE.
         ENABCCIN($N1(2), $SS) = .TRUE.
         ENABCCIN($N1(3), $SS) = .TRUE.
         ENABCCIN($NN1(1), $SS) = .TRUE.
         ENABCCIN($NN1(2), $SS) = .TRUE.
         ENABCCIN($NN1(3), $SS) = .TRUE.
      ENDIF

         GGIN($N1(1),$SS) = GGIN($N1(1),$SS) + IZo
         GGIN($N1(2),$SS) = GGIN($N1(2),$SS) + IZo
         GGIN($N1(3),$SS) = GGIN($N1(3),$SS) + IZo
         GGIN($NN1(1),$SS) = GGIN($NN1(1),$SS) + IZo + IZom
         GGIN($NN1(2),$SS) = GGIN($NN1(2),$SS) + IZo + IZom
         GGIN($NN1(3),$SS) = GGIN($NN1(3),$SS) + IZo + IZom
      

! Save current injections for use in the next time step to compute the branch currents
      STORF(NSTORF+0) = VDC($N1(1), $SS)*IZo + IMKa_OLD
      STORF(NSTORF+1) = VDC($N1(2), $SS)*IZo + IMKb_OLD
      STORF(NSTORF+2) = VDC($N1(3), $SS)*IZo + IMKc_OLD
      STORF(NSTORF+3) = VDC($NN1(1), $SS)*IZo + IKMa_OLD 
      STORF(NSTORF+4) = VDC($NN1(2), $SS)*IZo + IKMb_OLD
      STORF(NSTORF+5) = VDC($NN1(3), $SS)*IZo + IKMc_OLD
      NSTORF = NSTORF + 6
#ENDIF"
   }
  Section(Help)
   {
   Flyby = "\
3-phase bank of 1-phase 2-winding transformers
:TapI
Tap setting
:A1
Phase A - Winding 1
:B1
Phase B - Winding 1
:C1
Phase C - Winding 1
:A2
Phase A - Winding 2
:B2
Phase B - Winding 2
:C2
Phase C - Winding 2
:G1
Neutral - Winding 1
:G2
Neutral - Winding 2
:N1
Winding 1 terminals
:N2
Winding 2 terminals
"
   }
  }
 Component("ETRAN_COM_BERG")
  {
  Desc = ""
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("LName",9,8,180,12,2)
     {
     Desc = "Line Name (for display only)"
     Def = "TestLine1"
     Len = 15
     }
    Input("Port",9,25,180,12,2)
     {
     Desc = "TCP/IP Port of other end (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    Input("Rpu",9,41,180,12,2)
     {
     Desc = "Pos Seq R (pu on MVA base)"
     Def = ".1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("Xpu",9,53,180,12,2)
     {
     Desc = "Pos Seq X (pu on MVA base)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("Bpu",9,65,180,12,2)
     {
     Desc = "Pos Seq B (pu on MVA base)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("R0pu",9,86,180,12,2)
     {
     Desc = "Zero Seq R (pu on MVA base)"
     Def = ".1"
     Data = Real
     Unit = "pu"
     Len = 15
     Cond = "NumC>1"
     }
    Input("X0pu",9,98,180,12,2)
     {
     Desc = "Zero Seq X (pu on MVA base)"
     Def = "2"
     Data = Real
     Unit = "pu"
     Len = 15
     Cond = "NumC>1"
     }
    Input("B0pu",9,110,180,12,2)
     {
     Desc = "Zero Seq B (pu on MVA base)"
     Def = "2"
     Data = Real
     Unit = "pu"
     Len = 15
     Cond = "NumC>1"
     }
    Input("MVA",9,130,180,12,2)
     {
     Desc = "Base MVA"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     }
    Input("VBase",9,142,180,12,2)
     {
     Desc = "Base Voltage (kV, LL, rms)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("F",9,154,180,12,2)
     {
     Desc = "Base Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     }
    Choice("NumC",10,172,180,55,2)
     {
     Style = 1
     Desc = "Number of Phases/Conductors:"
     Def = "3"
     Len = 15
     *1 = "1 phase"
     *2 = "2 phases"
     *3 = "3 phases"
     }
    Input("scl",10,230,180,12,2)
     {
     Desc = "Scaling Factor"
     Def = "1.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.001
     Max = 1e+006
     }
    }
   }

  Nodes = 
   {
   Electrical("E",-54,0)
    {
    Cond = "NumC==3"
    Dim  = [3]
    }
   Input("NINF",-18,18)
    {
    Type = Integer
    }
   Output("NOUTF",-18,18)
    {
    Type = Integer
    }
   Output("NOUTI",-18,0)
    {
    Type = Integer
    }
   Input("NINI",-18,0)
    {
    Type = Integer
    }
   Electrical("E",-54,0)
    {
    Cond = "NumC==2"
    Dim  = [2]
    }
   Electrical("E1",-54,0)
    {
    Cond = "NumC==1"
    }
   }

  Graphics = 
   {
   Text(-30,23,"MultiCPU Line")
   Pen(ByNode,ByNode,ByNode,E)
   Line(-54,0,-39,0)
   Text(-43,-12,"E+")
   Pen(Black,Solid,0.4)
   Line(-27,12,-27,-11)
   Pen(,,0.2)
   Line(-25,12,-25,-11)
   Line(-38,-13,-21,-13)
   Pen(,,0.4)
   Line(-38,-11,-21,-11)
   Pen(,,0.2)
   Line(-33,-11,-30,-8)
   Line(-30,-8,-27,-11)
   Line(-30,-8,-30,-5)
   Line(-37,-11,-37,-8)
   Pen(,,0.4)
   Line(-34,12,-34,-11)
   Pen(,,0.2)
   Line(-33,12,-33,-11)
   Line(-22,-11,-22,-8)
   Line(-33,5,-27,-4)
   Line(-27,5,-33,-4)
   Text(-30,34,"$Port - $LName")
   }

  Section(EMTDC)
   {
   DSOUT = "\
#STORAGE REAL:2000
#STORAGE INTEGER:10
#STORAGE LOGICAL:10
#IF ( NumC == 3 )
         CALL ETRAN_COM_BERG_Write($E(1),$E(2),$E(3),$B12,$B23,$B31,$SS,$Port,$NINF,$NINI,$scl)
#ELSEIF ( NumC == 2 )
         CALL ETRAN_COM_BERG_Write($E(1),$E(2),0,$B12,0,0,$SS,$Port,$NINF,$NINI,$scl)
#ELSE
         CALL ETRAN_COM_BERG_Write($E1,0,0,0,0,0,$SS,$Port,$NINF,$NINI,$scl)
#ENDIF"
   DSDYN = "\
#STORAGE REAL:100000
#STORAGE LOGICAL:1
! ETRAN Parallel Processing Line Model
#IF ( NumC == 3 )
            CALL ETRAN_COM_BERG_Master($E(1),$E(2),$E(3),$B12,$B23,$B31,$SS,$Port,$NOUTF,$NOUTI,$VBase,$MVA,$F,$Rpu,$Xpu,$Bpu,$R0pu,$X0pu,$B0pu,$scl)
#ELSEIF ( NumC == 2 )
            CALL ETRAN_COM_BERG_Master($E(1),$E(2),0,$B12,0,0,$SS,$Port,$NOUTF,$NOUTI,$VBase,$MVA,$F,$Rpu,$Xpu,$Bpu,$R0pu,$X0pu,$B0pu,$scl)
#ELSE
            CALL ETRAN_COM_BERG_Master($E1,0,0,0,0,0,$SS,$Port,$NOUTF,$NOUTI,$VBase,$MVA,$F,$Rpu,$Xpu,$Bpu,0.0,0.0,0.0,$scl)
#ENDIF
"
   BRANCH = "\
  #IF NumC == 3
     B12 = $E(1) $E(2) BREAKER 100.0 /
     B23 = $E(2) $E(3) BREAKER 100.0 /
     B31 = $E(3) $E(1) BREAKER 100.0 /
  #ELSEIF ( NumC == 2 )
     B12 = $E(1) $E(2) BREAKER 100.0 /
  #ENDIF"
   }
  }
 Component("Electranix_PSCAD_PSSE")
  {
  Desc = ""
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Input("IP1",5,4,180,12,2)
     {
     Desc = "IP Address 1 of other end"
     Def = "127"
     Data = Integer
     Len = 15
     }
    Input("IP2",5,16,180,12,2)
     {
     Desc = "IP Address 2 of other end"
     Def = "0"
     Data = Integer
     Len = 15
     }
    Input("IP3",5,28,180,12,2)
     {
     Desc = "IP Address 3 of other end"
     Def = "0"
     Data = Integer
     Len = 15
     }
    Input("IP4",5,40,180,12,2)
     {
     Desc = "IP Address 4 of other end"
     Def = "1"
     Data = Integer
     Len = 15
     }
    Input("Port",5,56,180,12,2)
     {
     Desc = "TCP/IP Port of other end (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    Input("VBase",5,72,180,12,2)
     {
     Desc = "Base Voltage (kV, LL, rms)"
     Def = "230"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("F0",5,88,180,12,2)
     {
     Desc = "Base Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     }
    Input("TStart",5,108,180,12,6)
     {
     Desc = "Start Time of Interface (sec)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Output("P",72,-54)
    {
    Type = Real
    }
   Output("Q",72,-36)
    {
    Type = Real
    }
   Electrical("NN",0,72)
    {
    }
   Electrical("NP",0,-90)
    {
    Dim  = [3]
    }
   Output("Epu",72,-18)
    {
    Type = Real
    }
   Output("Ang",72,0)
    {
    Type = Real
    }
   Input("NINF",18,-36)
    {
    Type = Integer
    }
   Output("NOUTF",18,-36)
    {
    Type = Integer
    }
   Input("NINI",18,-18)
    {
    Type = Integer
    }
   Output("NOUTI",18,-18)
    {
    Type = Integer
    }
   Output("F",72,18)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Rectangle(-26,-74,57,56)
   Text(29,39,"PSCAD")
   Pen(ByNode,ByNode,ByNode,NN)
   Line(72,-54,57,-54)
   Font(,,Left)
   Text(6,-51,"P+jQ")
   Pen(,,,NP)
   Line(72,-36,57,-36)
   Font(,,Right)
   Text(55,-32,"Q")
   Pen(Black,Solid,1.0)
   Line(0,-90,0,-19)
   Line(0,17,0,70)
   Text(-3,-62,"NP")
   Text(-3,51,"NN")
   Line(0,-51,5,-56)
   Line(0,-51,-5,-56)
   Text(55,-51,"P")
   Font(,,Centre)
   Text(30,51,"<->PSSE")
   Pen(,,0.2)
   Ellipse(-18,-19,18,17)
   Pen(ByNode,ByNode,ByNode,NN)
   Line(72,-18,57,-18)
   Pen(,,,NP)
   Line(72,0,57,0)
   Font(,,Right)
   Text(55,4,"Ang")
   Text(55,-15,"Epu")
   Line(72,18,57,18)
   Text(55,22,"F")
   }

  Section(EMTDC)
   {
   Branch = "\
BA =  $NN  $NP(1)     SOURCE   0.01
BB =  $NN  $NP(2)     SOURCE   0.01
BC =  $NN  $NP(3)     SOURCE   0.01
"
   DSOUT = "      CALL ETRAN_COM_PSSE_DSOUT($BA,$BB,$BC,$NP,$NN,$SS,$IP1,$IP2,$IP3,$IP4,$Port,$NINF,$NINI,$TStart,$VBase,$Epu,$Ang,$F,$P,$Q)"
   DSDYN = "\
      CALL ETRAN_COM_PSSE_DSDYN($BA,$BB,$BC,$NP,$NN,$SS,$IP1,$IP2,$IP3,$IP4,$Port,$NOUTF,$NOUTI,$TStart,$VBase,$Epu,$Ang,$F,$P,$Q)
"
   }
  }
 Component("Sequencer_Electranix_ETRANPlus_Com")
  {
  Desc = "E-TRAN Plus TCP/IP Computer/Socket Mapping"
  FileDate = 0
  Parameters = 
   {
   Category("Options")
    {
    Choice("Option",5,4,228,44,2)
     {
     Style = 1
     Desc = "Method to Enter TCP Ports and Computername/IP Addresses:"
     Def = "0"
     Len = 15
     *0 = "Enter TCP Ports and Computernames"
     *1 = "Use Text file to Enter TCP Ports and Computernames"
     }
    Text("TxtName",5,52,306,24,2)
     {
     Desc = "Enter Filename containing Ports/Computernames:"
     Def = "C:\\Temp\\Port_Computer_Map.txt"
     Len = 45
     Cond = "Option==1"
     }
    Input("TStart",5,84,306,12,6)
     {
     Desc = "Start Time of Hybrid Interface to PSS/E (if used - sec)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     Min = 0
     }
    }
   Category("Connections Page 1")
    {
    Cond = "Option==0"
    Text("header1",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port1",5,20,78,12,2)
     {
     Desc = "Start Port 1"
     Def = "2001"
     Data = Integer
     Len = 8
     }
    Input("EPort1",86,20,78,12,2)
     {
     Desc = "End Port 1"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port1>0"
     }
    Text("CName1b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 1"
     Def = "localhost"
     Len = 25
     Cond = "Port1>0"
     }
    Input("Port2",5,36,78,12,2)
     {
     Desc = "Start Port 2"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort2",86,36,78,12,2)
     {
     Desc = "End Port 2"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port2>0"
     }
    Text("CName2b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 2"
     Def = "192.168.0.102"
     Len = 25
     Cond = "Port2>0"
     }
    Input("Port3",5,52,78,12,2)
     {
     Desc = "Start Port 3"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort3",86,52,78,12,2)
     {
     Desc = "End Port 3"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port3>0"
     }
    Text("CName3b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 3"
     Def = "Comp3b"
     Len = 25
     Cond = "Port3>0"
     }
    Input("Port4",5,68,78,12,2)
     {
     Desc = "Start Port 4"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort4",86,68,78,12,2)
     {
     Desc = "End Port 4"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port4>0"
     }
    Text("CName4b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 4"
     Def = "Comp4b"
     Len = 25
     Cond = "Port4>0"
     }
    Input("Port5",5,84,78,12,2)
     {
     Desc = "Start Port 5"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort5",86,84,78,12,2)
     {
     Desc = "End Port 5"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port5>0"
     }
    Text("CName5b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 5"
     Def = "Comp5b"
     Len = 25
     Cond = "Port5>0"
     }
    Input("Port6",5,100,78,12,2)
     {
     Desc = "Start Port 6"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort6",86,100,78,12,2)
     {
     Desc = "End Port 6"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port6>0"
     }
    Text("CName6b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 6"
     Def = "Comp6b"
     Len = 25
     Cond = "Port6>0"
     }
    Input("Port7",5,116,78,12,2)
     {
     Desc = "Start Port 7"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort7",86,116,78,12,2)
     {
     Desc = "End Port 7"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port7>0"
     }
    Text("CName7b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 7"
     Def = "Comp7b"
     Len = 25
     Cond = "Port7>0"
     }
    Input("Port8",5,132,78,12,2)
     {
     Desc = "Start Port 8"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort8",86,132,78,12,2)
     {
     Desc = "End Port 8"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port8>0"
     }
    Text("CName8b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 8"
     Def = "Comp8b"
     Len = 25
     Cond = "Port8>0"
     }
    Input("Port9",5,148,78,12,2)
     {
     Desc = "Start Port 9"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort9",86,148,78,12,2)
     {
     Desc = "End Port 9"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port9>0"
     }
    Text("CName9b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 9"
     Def = "Comp9b"
     Len = 25
     Cond = "Port9>0"
     }
    Input("Port10",5,164,78,12,2)
     {
     Desc = "Start Port 10"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort10",86,164,78,12,2)
     {
     Desc = "End Port 10"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port10>0"
     }
    Text("CName10b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 10"
     Def = "Comp10b"
     Len = 25
     Cond = "Port10>0"
     }
    }
   Category("Connections Page 2")
    {
    Cond = "Option==0"
    Text("header2",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port11",5,20,78,12,2)
     {
     Desc = "Start Port 11"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort11",86,20,78,12,2)
     {
     Desc = "End Port 11"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port11>0"
     }
    Text("CName11b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 11"
     Def = "Comp11b"
     Len = 25
     Cond = "Port11>0"
     }
    Input("Port12",5,36,78,12,2)
     {
     Desc = "Start Port 12"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort12",86,36,78,12,2)
     {
     Desc = "End Port 12"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port12>0"
     }
    Text("CName12b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 11"
     Def = "Comp12b"
     Len = 25
     Cond = "Port12>0"
     }
    Input("Port13",5,52,78,12,2)
     {
     Desc = "Start Port 13"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort13",86,52,78,12,2)
     {
     Desc = "End Port 13"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port13>0"
     }
    Text("CName13b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 13"
     Def = "Comp13b"
     Len = 25
     Cond = "Port13>0"
     }
    Input("Port14",5,68,78,12,2)
     {
     Desc = "Start Port 14"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort14",86,68,78,12,2)
     {
     Desc = "End Port 14"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port14>0"
     }
    Text("CName14b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 14"
     Def = "Comp14b"
     Len = 25
     Cond = "Port14>0"
     }
    Input("Port15",5,84,78,12,2)
     {
     Desc = "Start Port 15"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort15",86,84,78,12,2)
     {
     Desc = "End Port 15"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port15>0"
     }
    Text("CName15b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 15"
     Def = "Comp15b"
     Len = 25
     Cond = "Port15>0"
     }
    Input("Port16",5,100,78,12,2)
     {
     Desc = "Start Port 16"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort16",86,100,78,12,2)
     {
     Desc = "End Port 16"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port16>0"
     }
    Text("CName16b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 16"
     Def = "Comp16b"
     Len = 25
     Cond = "Port16>0"
     }
    Input("Port17",5,116,78,12,2)
     {
     Desc = "Start Port 17"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort17",86,116,78,12,2)
     {
     Desc = "End Port 17"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port17>0"
     }
    Text("CName17b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 17"
     Def = "Comp17b"
     Len = 25
     Cond = "Port17>0"
     }
    Input("Port18",5,132,78,12,2)
     {
     Desc = "Start Port 18"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort18",86,132,78,12,2)
     {
     Desc = "End Port 18"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port18>0"
     }
    Text("CName18b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 18"
     Def = "Comp18b"
     Len = 25
     Cond = "Port18>0"
     }
    Input("Port19",5,148,78,12,2)
     {
     Desc = "Start Port 19"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort19",86,148,78,12,2)
     {
     Desc = "End Port 19"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port19>0"
     }
    Text("CName19b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 19"
     Def = "Comp19b"
     Len = 25
     Cond = "Port19>0"
     }
    Input("Port20",5,164,78,12,2)
     {
     Desc = "Start Port 20"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort20",86,164,78,12,2)
     {
     Desc = "End Port 20"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port20>0"
     }
    Text("CName20b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 20"
     Def = "Comp20b"
     Len = 25
     Cond = "Port20>0"
     }
    }
   Category("Connections Page 3")
    {
    Cond = "Option==0"
    Text("header3",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port21",5,20,78,12,2)
     {
     Desc = "Start Port 21"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort21",86,20,78,12,2)
     {
     Desc = "End Port 21"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port21>0"
     }
    Text("CName21b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 21"
     Def = "Comp21b"
     Len = 25
     Cond = "Port21>0"
     }
    Input("Port22",5,36,78,12,2)
     {
     Desc = "Start Port 22"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort22",86,36,78,12,2)
     {
     Desc = "End Port 22"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port22>0"
     }
    Text("CName22b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 22"
     Def = "Comp22b"
     Len = 25
     Cond = "Port22>0"
     }
    Input("Port23",5,52,78,12,2)
     {
     Desc = "Start Port 23"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort23",86,52,78,12,2)
     {
     Desc = "End Port 23"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port23>0"
     }
    Text("CName23b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 23"
     Def = "Comp23b"
     Len = 25
     Cond = "Port23>0"
     }
    Input("Port24",5,68,78,12,2)
     {
     Desc = "Start Port 24"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort24",86,68,78,12,2)
     {
     Desc = "End Port 24"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port24>0"
     }
    Text("CName24b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 24"
     Def = "Comp24b"
     Len = 25
     Cond = "Port24>0"
     }
    Input("Port25",5,84,78,12,2)
     {
     Desc = "Start Port 25"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort25",86,84,78,12,2)
     {
     Desc = "End Port 25"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port25>0"
     }
    Text("CName25b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 25"
     Def = "Comp25b"
     Len = 25
     Cond = "Port25>0"
     }
    Input("Port26",5,100,78,12,2)
     {
     Desc = "Start Port 26"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort26",86,100,78,12,2)
     {
     Desc = "End Port 26"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port26>0"
     }
    Text("CName26b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 26"
     Def = "Comp26b"
     Len = 25
     Cond = "Port26>0"
     }
    Input("Port27",5,116,78,12,2)
     {
     Desc = "Start Port 27"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort27",86,116,78,12,2)
     {
     Desc = "End Port 27"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port27>0"
     }
    Text("CName27b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 27"
     Def = "Comp27b"
     Len = 25
     Cond = "Port27>0"
     }
    Input("Port28",5,132,78,12,2)
     {
     Desc = "Start Port 28"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort28",86,132,78,12,2)
     {
     Desc = "End Port 28"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port28>0"
     }
    Text("CName28b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 28"
     Def = "Comp28b"
     Len = 25
     Cond = "Port28>0"
     }
    Input("Port29",5,148,78,12,2)
     {
     Desc = "Start Port 29"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort29",86,148,78,12,2)
     {
     Desc = "End Port 29"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port29>0"
     }
    Text("CName29b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 29"
     Def = "Comp29b"
     Len = 25
     Cond = "Port29>0"
     }
    Input("Port30",5,164,78,12,2)
     {
     Desc = "Start Port 30"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort30",86,164,78,12,2)
     {
     Desc = "End Port 30"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port30>0"
     }
    Text("CName30b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 30"
     Def = "Comp30b"
     Len = 25
     Cond = "Port30>0"
     }
    }
   Category("Connections Page 4")
    {
    Cond = "Option==0"
    Text("header4",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port31",5,20,78,12,2)
     {
     Desc = "Start Port 31"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort31",86,20,78,12,2)
     {
     Desc = "End Port 31"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port31>0"
     }
    Text("CName31b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 31"
     Def = "Comp31b"
     Len = 25
     Cond = "Port31>0"
     }
    Input("Port32",5,36,78,12,2)
     {
     Desc = "Start Port 32"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort32",86,36,78,12,2)
     {
     Desc = "End Port 32"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port32>0"
     }
    Text("CName32b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 32"
     Def = "Comp32b"
     Len = 25
     Cond = "Port32>0"
     }
    Input("Port33",5,52,78,12,2)
     {
     Desc = "Start Port 33"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort33",86,52,78,12,2)
     {
     Desc = "End Port 33"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port33>0"
     }
    Text("CName33b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 33"
     Def = "Comp33b"
     Len = 25
     Cond = "Port33>0"
     }
    Input("Port34",5,68,78,12,2)
     {
     Desc = "Start Port 34"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort34",86,68,78,12,2)
     {
     Desc = "End Port 34"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port34>0"
     }
    Text("CName34b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 34"
     Def = "Comp34b"
     Len = 25
     Cond = "Port34>0"
     }
    Input("Port35",5,84,78,12,2)
     {
     Desc = "Start Port 35"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort35",86,84,78,12,2)
     {
     Desc = "End Port 35"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port35>0"
     }
    Text("CName35b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 35"
     Def = "Comp35b"
     Len = 25
     Cond = "Port35>0"
     }
    Input("Port36",5,100,78,12,2)
     {
     Desc = "Start Port 36"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort36",86,100,78,12,2)
     {
     Desc = "End Port 36"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port36>0"
     }
    Text("CName36b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 36"
     Def = "Comp36b"
     Len = 25
     Cond = "Port36>0"
     }
    Input("Port37",5,116,78,12,2)
     {
     Desc = "Start Port 37"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort37",86,116,78,12,2)
     {
     Desc = "End Port 37"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port37>0"
     }
    Text("CName37b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 37"
     Def = "Comp37b"
     Len = 25
     Cond = "Port37>0"
     }
    Input("Port38",5,132,78,12,2)
     {
     Desc = "Start Port 38"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort38",86,132,78,12,2)
     {
     Desc = "End Port 38"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port38>0"
     }
    Text("CName38b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 38"
     Def = "Comp38b"
     Len = 25
     Cond = "Port38>0"
     }
    Input("Port39",5,148,78,12,2)
     {
     Desc = "Start Port 39"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort39",86,148,78,12,2)
     {
     Desc = "End Port 39"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port39>0"
     }
    Text("CName39b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 39"
     Def = "Comp39b"
     Len = 25
     Cond = "Port39>0"
     }
    Input("Port40",5,164,78,12,2)
     {
     Desc = "Start Port 40"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort40",86,164,78,12,2)
     {
     Desc = "End Port 40"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port40>0"
     }
    Text("CName40b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 40"
     Def = "Comp40b"
     Len = 25
     Cond = "Port40>0"
     }
    }
   Category("Connections Page 5")
    {
    Cond = "Option==0"
    Text("header5",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port41",5,20,78,12,2)
     {
     Desc = "Start Port 41"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort41",86,20,78,12,2)
     {
     Desc = "End Port 41"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port41>0"
     }
    Text("CName41b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 41"
     Def = "Comp41b"
     Len = 25
     Cond = "Port41>0"
     }
    Input("Port42",5,36,78,12,2)
     {
     Desc = "Start Port 42"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort42",86,36,78,12,2)
     {
     Desc = "End Port 42"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port42>0"
     }
    Text("CName42b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 42"
     Def = "Comp42b"
     Len = 25
     Cond = "Port42>0"
     }
    Input("Port43",5,52,78,12,2)
     {
     Desc = "Start Port 43"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort43",86,52,78,12,2)
     {
     Desc = "End Port 43"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port43>0"
     }
    Text("CName43b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 43"
     Def = "Comp43b"
     Len = 25
     Cond = "Port43>0"
     }
    Input("Port44",5,68,78,12,2)
     {
     Desc = "Start Port 44"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort44",86,68,78,12,2)
     {
     Desc = "End Port 44"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port44>0"
     }
    Text("CName44b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 44"
     Def = "Comp44b"
     Len = 25
     Cond = "Port44>0"
     }
    Input("Port45",5,84,78,12,2)
     {
     Desc = "Start Port 45"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort45",86,84,78,12,2)
     {
     Desc = "End Port 45"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port45>0"
     }
    Text("CName45b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 45"
     Def = "Comp45b"
     Len = 25
     Cond = "Port45>0"
     }
    Input("Port46",5,100,78,12,2)
     {
     Desc = "Start Port 46"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort46",86,100,78,12,2)
     {
     Desc = "End Port 46"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port46>0"
     }
    Text("CName46b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 46"
     Def = "Comp46b"
     Len = 25
     Cond = "Port46>0"
     }
    Input("Port47",5,116,78,12,2)
     {
     Desc = "Start Port 47"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort47",86,116,78,12,2)
     {
     Desc = "End Port 47"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port47>0"
     }
    Text("CName47b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 47"
     Def = "Comp47b"
     Len = 25
     Cond = "Port47>0"
     }
    Input("Port48",5,132,78,12,2)
     {
     Desc = "Start Port 48"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort48",86,132,78,12,2)
     {
     Desc = "End Port 48"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port48>0"
     }
    Text("CName48b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 48"
     Def = "Comp48b"
     Len = 25
     Cond = "Port48>0"
     }
    Input("Port49",5,148,78,12,2)
     {
     Desc = "Start Port 49"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort49",86,148,78,12,2)
     {
     Desc = "End Port 49"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port49>0"
     }
    Text("CName49b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 49"
     Def = "Comp49b"
     Len = 25
     Cond = "Port49>0"
     }
    Input("Port50",5,164,78,12,2)
     {
     Desc = "Start Port 50"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort50",86,164,78,12,2)
     {
     Desc = "End Port 50"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port50>0"
     }
    Text("CName50b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 50"
     Def = "Comp50b"
     Len = 25
     Cond = "Port50>0"
     }
    }
   Category("Connections Page 6")
    {
    Cond = "Option==0"
    Text("header6",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port51",5,20,78,12,2)
     {
     Desc = "Start Port 51"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort51",86,20,78,12,2)
     {
     Desc = "End Port 51"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port51>0"
     }
    Text("CName51b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 51"
     Def = "Comp51b"
     Len = 25
     Cond = "Port51>0"
     }
    Input("Port52",5,36,78,12,2)
     {
     Desc = "Start Port 52"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort52",86,36,78,12,2)
     {
     Desc = "End Port 52"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port52>0"
     }
    Text("CName52b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 52"
     Def = "Comp52b"
     Len = 25
     Cond = "Port52>0"
     }
    Input("Port53",5,52,78,12,2)
     {
     Desc = "Start Port 53"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort53",86,52,78,12,2)
     {
     Desc = "End Port 53"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port53>0"
     }
    Text("CName53b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 53"
     Def = "Comp53b"
     Len = 25
     Cond = "Port53>0"
     }
    Input("Port54",5,68,78,12,2)
     {
     Desc = "Start Port 54"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort54",86,68,78,12,2)
     {
     Desc = "End Port 54"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port54>0"
     }
    Text("CName54b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 54"
     Def = "Comp54b"
     Len = 25
     Cond = "Port54>0"
     }
    Input("Port55",5,84,78,12,2)
     {
     Desc = "Start Port 55"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort55",86,84,78,12,2)
     {
     Desc = "End Port 55"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port55>0"
     }
    Text("CName55b",169,84,220,12,2)
     {
     Desc = "Computer Name or IP Address 55"
     Def = "Comp55b"
     Len = 25
     Cond = "Port55>0"
     }
    Input("Port56",5,100,78,12,2)
     {
     Desc = "Start Port 56"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort56",86,100,78,12,2)
     {
     Desc = "End Port 56"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port56>0"
     }
    Text("CName56b",169,100,220,12,2)
     {
     Desc = "Computer Name or IP Address 56"
     Def = "Comp56b"
     Len = 25
     Cond = "Port56>0"
     }
    Input("Port57",5,116,78,12,2)
     {
     Desc = "Start Port 57"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort57",86,116,78,12,2)
     {
     Desc = "End Port 57"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port57>0"
     }
    Text("CName57b",169,116,220,12,2)
     {
     Desc = "Computer Name or IP Address 57"
     Def = "Comp57b"
     Len = 25
     Cond = "Port57>0"
     }
    Input("Port58",5,132,78,12,2)
     {
     Desc = "Start Port 58"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort58",86,132,78,12,2)
     {
     Desc = "End Port 58"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port58>0"
     }
    Text("CName58b",169,132,220,12,2)
     {
     Desc = "Computer Name or IP Address 58"
     Def = "Comp58b"
     Len = 25
     Cond = "Port58>0"
     }
    Input("Port59",5,148,78,12,2)
     {
     Desc = "Start Port 59"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort59",86,148,78,12,2)
     {
     Desc = "End Port 59"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port59>0"
     }
    Text("CName59b",169,148,220,12,2)
     {
     Desc = "Computer Name or IP Address 59"
     Def = "Comp59b"
     Len = 25
     Cond = "Port59>0"
     }
    Input("Port60",5,164,78,12,2)
     {
     Desc = "Start Port 60"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort60",86,164,78,12,2)
     {
     Desc = "End Port 60"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port60>0"
     }
    Text("CName60b",169,164,220,12,2)
     {
     Desc = "Computer Name or IP Address 60"
     Def = "Comp60b"
     Len = 25
     Cond = "Port60>0"
     }
    }
   Category("Connections Page 7")
    {
    Cond = "Option==0"
    Text("header7",5,4,310,12,2)
     {
     Desc = "Enter the Start Port(0=disabled) and End Port(0 for one port) in the Range and computer name or ip address for each connection"
     Len = 0
     }
    Input("Port61",5,20,78,12,2)
     {
     Desc = "Start Port 61"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort61",86,20,78,12,2)
     {
     Desc = "End Port 61"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port61>0"
     }
    Text("CName61b",169,20,220,12,2)
     {
     Desc = "Computer Name or IP Address 61"
     Def = "Comp61b"
     Len = 25
     Cond = "Port61>0"
     }
    Input("Port62",5,36,78,12,2)
     {
     Desc = "Start Port 62"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort62",86,36,78,12,2)
     {
     Desc = "End Port 62"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port62>0"
     }
    Text("CName62b",169,36,220,12,2)
     {
     Desc = "Computer Name or IP Address 62"
     Def = "Comp62b"
     Len = 25
     Cond = "Port62>0"
     }
    Input("Port63",5,52,78,12,2)
     {
     Desc = "Start Port 63"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort63",86,52,78,12,2)
     {
     Desc = "End Port 63"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port63>0"
     }
    Text("CName63b",169,52,220,12,2)
     {
     Desc = "Computer Name or IP Address 63"
     Def = "Comp63b"
     Len = 25
     Cond = "Port63>0"
     }
    Input("Port64",5,68,78,12,2)
     {
     Desc = "Start Port 64"
     Def = "0"
     Data = Integer
     Len = 8
     }
    Input("EPort64",86,68,78,12,2)
     {
     Desc = "End Port 64"
     Def = "0"
     Data = Integer
     Len = 8
     Cond = "Port64>0"
     }
    Text("CName64b",169,68,220,12,2)
     {
     Desc = "Computer Name or IP Address 64"
     Def = "Comp64b"
     Len = 25
     Cond = "Port64>0"
     }
    }
   }

  Nodes = 
   {
   Output("DumOut",36,0)
    {
    Type = Integer
    }
   }

  Graphics = 
   {
   Rectangle(-76,-33,96,70)
   Text(-68,-22,"E+")
   Font(,,Left)
   Text(-71,-1,"ETRAN Plus")
   Text(-71,16,"Computer/Socket Mapping")
   Text(-71,33,"TStart (PSS/E com) = $TStart")
   }

  Section(EMTDC)
   {
   DSDYN = "\
! Verify port mappings with other components
      CALL ETRAN_PLUS_VERIFY_MAPPINGS()

! Collect all port and computer names
      IF ( FIRSTSTEP ) THEN
         CALL ETRAN_PLUS_SetTStart($TStart)
#IF ( Option == 0 )
#LOCAL INTEGER I_1
      #IF ( Port1 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port1,\"localhost\",\"%CName1b\")
         #IF (EPort1 > Port1)
            DO I_1 = $Port1+1,$EPort1
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName1b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port2 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port2,\"localhost\",\"%CName2b\")
         #IF (EPort2 > Port2)
            DO I_1 = $Port2+1,$EPort2
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName2b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port3 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port3,\"localhost\",\"%CName3b\")
         #IF (EPort3 > Port3)
            DO I_1 = $Port3+1,$EPort3
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName3b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port4 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port4,\"localhost\",\"%CName4b\")
         #IF (EPort4 > Port4)
            DO I_1 = $Port4+1,$EPort4
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName4b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port5 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port5,\"localhost\",\"%CName5b\")
         #IF (EPort5 > Port5)
            DO I_1 = $Port5+1,$EPort5
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName5b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port6 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port6,\"localhost\",\"%CName6b\")
         #IF (EPort6 > Port6)
            DO I_1 = $Port6+1,$EPort6
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName6b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port7 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port7,\"localhost\",\"%CName7b\")
         #IF (EPort7 > Port7)
            DO I_1 = $Port7+1,$EPort7
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName7b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port8 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port8,\"localhost\",\"%CName8b\")
         #IF (EPort8 > Port8)
            DO I_1 = $Port8+1,$EPort8
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName8b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port9 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port9,\"localhost\",\"%CName9b\")
         #IF (EPort9 > Port9)
            DO I_1 = $Port9+1,$EPort9
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName9b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port10 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port10,\"localhost\",\"%CName10b\")
         #IF (EPort10 > Port10)
            DO I_1 = $Port10+1,$EPort10
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName10b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port11 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port11,\"localhost\",\"%CName11b\")
         #IF (EPort11 > Port11)
            DO I_1 = $Port11+1,$EPort11
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName11b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port12 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port12,\"localhost\",\"%CName12b\")
         #IF (EPort12 > Port12)
            DO I_1 = $Port12+1,$EPort12
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName12b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port13 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port13,\"localhost\",\"%CName13b\")
         #IF (EPort13 > Port13)
            DO I_1 = $Port13+1,$EPort13
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName13b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port14 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port14,\"localhost\",\"%CName14b\")
         #IF (EPort14 > Port14)
            DO I_1 = $Port14+1,$EPort14
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName14b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port15 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port15,\"localhost\",\"%CName15b\")
         #IF (EPort15 > Port15)
            DO I_1 = $Port15+1,$EPort15
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName15b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port16 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port16,\"localhost\",\"%CName16b\")
         #IF (EPort16 > Port16)
            DO I_1 = $Port16+1,$EPort16
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName16b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port17 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port17,\"localhost\",\"%CName17b\")
         #IF (EPort17 > Port17)
            DO I_1 = $Port17+1,$EPort17
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName17b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port18 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port18,\"localhost\",\"%CName18b\")
         #IF (EPort18 > Port18)
            DO I_1 = $Port18+1,$EPort18
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName18b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port19 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port19,\"localhost\",\"%CName19b\")
         #IF (EPort19 > Port19)
            DO I_1 = $Port19+1,$EPort19
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName19b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port20 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port20,\"localhost\",\"%CName20b\")
         #IF (EPort20 > Port20)
            DO I_1 = $Port20+1,$EPort20
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName20b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port21 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port21,\"localhost\",\"%CName21b\")
         #IF (EPort21 > Port21)
            DO I_1 = $Port21+1,$EPort21
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName21b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port22 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port22,\"localhost\",\"%CName22b\")
         #IF (EPort22 > Port22)
            DO I_1 = $Port22+1,$EPort22
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName22b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port23 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port23,\"localhost\",\"%CName23b\")
         #IF (EPort23 > Port23)
            DO I_1 = $Port23+1,$EPort23
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName23b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port24 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port24,\"localhost\",\"%CName24b\")
         #IF (EPort24 > Port24)
            DO I_1 = $Port24+1,$EPort24
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName24b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port25 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port25,\"localhost\",\"%CName25b\")
         #IF (EPort25 > Port25)
            DO I_1 = $Port25+1,$EPort25
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName25b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port26 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port26,\"localhost\",\"%CName26b\")
         #IF (EPort26 > Port26)
            DO I_1 = $Port26+1,$EPort26
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName26b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port27 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port27,\"localhost\",\"%CName27b\")
         #IF (EPort27 > Port27)
            DO I_1 = $Port27+1,$EPort27
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName27b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port28 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port28,\"localhost\",\"%CName28b\")
         #IF (EPort28 > Port28)
            DO I_1 = $Port28+1,$EPort28
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName28b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port29 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port29,\"localhost\",\"%CName29b\")
         #IF (EPort29 > Port29)
            DO I_1 = $Port29+1,$EPort29
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName29b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port30 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port30,\"localhost\",\"%CName30b\")
         #IF (EPort30 > Port30)
            DO I_1 = $Port30+1,$EPort30
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName30b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port31 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port31,\"localhost\",\"%CName31b\")
         #IF (EPort31 > Port31)
            DO I_1 = $Port31+1,$EPort31
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName31b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port32 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port32,\"localhost\",\"%CName32b\")
         #IF (EPort32 > Port32)
            DO I_1 = $Port32+1,$EPort32
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName32b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port33 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port33,\"localhost\",\"%CName33b\")
         #IF (EPort33 > Port33)
            DO I_1 = $Port33+1,$EPort33
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName33b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port34 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port34,\"localhost\",\"%CName34b\")
         #IF (EPort34 > Port34)
            DO I_1 = $Port34+1,$EPort34
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName34b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port35 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port35,\"localhost\",\"%CName35b\")
         #IF (EPort35 > Port35)
            DO I_1 = $Port35+1,$EPort35
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName35b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port36 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port36,\"localhost\",\"%CName36b\")
         #IF (EPort36 > Port36)
            DO I_1 = $Port36+1,$EPort36
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName36b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port37 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port37,\"localhost\",\"%CName37b\")
         #IF (EPort37 > Port37)
            DO I_1 = $Port37+1,$EPort37
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName37b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port38 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port38,\"localhost\",\"%CName38b\")
         #IF (EPort38 > Port38)
            DO I_1 = $Port38+1,$EPort38
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName38b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port39 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port39,\"localhost\",\"%CName39b\")
         #IF (EPort39 > Port39)
            DO I_1 = $Port39+1,$EPort39
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName39b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port40 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port40,\"localhost\",\"%CName40b\")
         #IF (EPort40 > Port40)
            DO I_1 = $Port40+1,$EPort40
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName40b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port41 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port41,\"localhost\",\"%CName41b\")
         #IF (EPort41 > Port41)
            DO I_1 = $Port41+1,$EPort41
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName41b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port42 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port42,\"localhost\",\"%CName42b\")
         #IF (EPort42 > Port42)
            DO I_1 = $Port42+1,$EPort42
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName42b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port43 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port43,\"localhost\",\"%CName43b\")
         #IF (EPort43 > Port43)
            DO I_1 = $Port43+1,$EPort43
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName43b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port44 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port44,\"localhost\",\"%CName44b\")
         #IF (EPort44 > Port44)
            DO I_1 = $Port44+1,$EPort44
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName44b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port45 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port45,\"localhost\",\"%CName45b\")
         #IF (EPort45 > Port45)
            DO I_1 = $Port45+1,$EPort45
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName45b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port46 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port46,\"localhost\",\"%CName46b\")
         #IF (EPort46 > Port46)
            DO I_1 = $Port46+1,$EPort46
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName46b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port47 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port47,\"localhost\",\"%CName47b\")
         #IF (EPort47 > Port47)
            DO I_1 = $Port47+1,$EPort47
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName47b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port48 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port48,\"localhost\",\"%CName48b\")
         #IF (EPort48 > Port48)
            DO I_1 = $Port48+1,$EPort48
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName48b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port49 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port49,\"localhost\",\"%CName49b\")
         #IF (EPort49 > Port49)
            DO I_1 = $Port49+1,$EPort49
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName49b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port50 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port50,\"localhost\",\"%CName50b\")
         #IF (EPort50 > Port50)
            DO I_1 = $Port50+1,$EPort50
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName50b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port51 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port51,\"localhost\",\"%CName51b\")
         #IF (EPort51 > Port51)
            DO I_1 = $Port51+1,$EPort51
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName51b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port52 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port52,\"localhost\",\"%CName52b\")
         #IF (EPort52 > Port52)
            DO I_1 = $Port52+1,$EPort52
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName52b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port53 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port53,\"localhost\",\"%CName53b\")
         #IF (EPort53 > Port53)
            DO I_1 = $Port53+1,$EPort53
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName53b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port54 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port54,\"localhost\",\"%CName54b\")
         #IF (EPort54 > Port54)
            DO I_1 = $Port54+1,$EPort54
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName54b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port55 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port55,\"localhost\",\"%CName55b\")
         #IF (EPort55 > Port55)
            DO I_1 = $Port55+1,$EPort55
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName55b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port56 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port56,\"localhost\",\"%CName56b\")
         #IF (EPort56 > Port56)
            DO I_1 = $Port56+1,$EPort56
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName56b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port57 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port57,\"localhost\",\"%CName57b\")
         #IF (EPort57 > Port57)
            DO I_1 = $Port57+1,$EPort57
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName57b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port58 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port58,\"localhost\",\"%CName58b\")
         #IF (EPort58 > Port58)
            DO I_1 = $Port58+1,$EPort58
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName58b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port59 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port59,\"localhost\",\"%CName59b\")
         #IF (EPort59 > Port59)
            DO I_1 = $Port59+1,$EPort59
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName59b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port60 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port60,\"localhost\",\"%CName60b\")
         #IF (EPort60 > Port60)
            DO I_1 = $Port60+1,$EPort60
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName60b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port61 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port61,\"localhost\",\"%CName61b\")
         #IF (EPort61 > Port61)
            DO I_1 = $Port61+1,$EPort61
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName61b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port62 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port62,\"localhost\",\"%CName62b\")
         #IF (EPort62 > Port62)
            DO I_1 = $Port62+1,$EPort62
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName62b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port63 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port63,\"localhost\",\"%CName63b\")
         #IF (EPort63 > Port63)
            DO I_1 = $Port63+1,$EPort63
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName63b\")
            END DO
         #ENDIF
      #ENDIF
      #IF ( Port64 > 0 )
         CALL ETRAN_PLUS_LOADIP_F($Port64,\"localhost\",\"%CName64b\")
         #IF (EPort64> Port64)
            DO I_1 = $Port64+1,$EPort64
               CALL ETRAN_PLUS_LOADIP_F(I_1,\"localhost\",\"%CName64b\")
            END DO
         #ENDIF
      #ENDIF
#ELSE
         CALL ETRAN_PLUS_FILEREAD_F(\"%TxtName\")
#ENDIF
      ENDIF

! Sync number of runs across all cases
      IF (.NOT. FIRSTSTEP ) THEN
         CALL ETRAN_PLUS_SYNC_NRUN()
      ENDIF

! Cpu Time Meter
      IF ( FIRSTSTEP ) THEN
         CALL WRITE_CPUTIME_F(1)
      ENDIF
      IF ( LASTSTEP ) THEN
         CALL WRITE_CPUTIME_F(0)
      ENDIF
"
   }
  }
 Component("Electranix_Common_GetSet")
  {
  Desc = "E-TRAN Plus Signal Communicator to Remote Case"
  FileDate = 0
  Parameters = 
   {
   Category("Main Data")
    {
    Text("Name",5,8,260,12,2)
     {
     Desc = "Parameter Name (for display only)"
     Def = "X1"
     Len = 15
     }
    Input("DimI",5,24,260,12,2)
     {
     Desc = "Input Array Dimension (0-100)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 0
     Max = 100
     }
    Input("DimO",5,40,260,12,2)
     {
     Desc = "Output Array Dimension (0-100)"
     Def = "1"
     Data = Integer
     Len = 8
     Min = 0
     Max = 100
     }
    Input("Port",5,56,261,12,2)
     {
     Desc = "TCP/IP Port of other end (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    Input("CDelay",5,72,261,12,6)
     {
     Desc = "Com Time Delay (sec)"
     Def = "0.001"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Input("TStart",5,88,261,12,6)
     {
     Desc = "Start Time of Interface (sec, only for coms to PSS/E)"
     Def = "1.0"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Choice("Interp",9,104,206,44,2)
     {
     Style = 1
     Desc = "Use Extrap/Interp-olation? (use for analog values only!)"
     Def = "0"
     Len = 15
     *0 = "No (Do Not Use)"
     *1 = "Yes (Use Extrap/Interp-olation)"
     }
    }
   }

  Nodes = 
   {
   Output("OUTR:DimO",54,0)
    {
    Cond = "DimO>0"
    Type = Real
    Dim  = [0]
    }
   Input("INR:DimI",-54,0)
    {
    Cond = "DimI>0"
    Type = Real
    Dim  = [0]
    }
   }

  Graphics = 
   {
   Pen(ByNode,Real,ByNode)
   Cond = "DimO>0"
   Line(37,0,53,0)
   Cond = "true"
   Text(-28,-7,"E+")
   Pen(Blue,Solid,0.4)
   Rectangle(-37,-18,37,18)
   Font(,,Right)
   Text(36,-4,"$Name")
   Text(29,13,"$Port")
   Pen(ByNode,Real,ByNode)
   Cond = "DimI>0"
   Line(-54,0,-37,0)
   Cond = "DimO>1"
   Line(42,4,47,-5)
   Font(,,Centre)
   Text(48,-9,"$DimO")
   Cond = "DimI>1"
   Line(-49,4,-44,-5)
   Text(-53,-7,"$DimI")
   Cond = "DimI>0"
   Line(-42,4,-37,0)
   Line(-42,-4,-37,0)
   }

  Section(EMTDC)
   {
   Help = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_GetSet"
   DSOUT = "\
#STORAGE REAL:1000
#STORAGE INTEGER:2
#STORAGE LOGICAL:1
! Electranix Common Transfer - Set
#LOCAL REAL TEMP_INIT
#IF ( DimI > 0 )
      CALL ELECTRANIX_COMMON_SET_Rn(1,$DimI,$Port,$CDelay,$TStart,$INR)
#ELSE
      TEMP_INIT = 0.0
      CALL ELECTRANIX_COMMON_SET_Rn(1,$DimI,$Port,0.0,$TStart,TEMP_INIT)
#ENDIF"
   DSDYN = "\
#STORAGE LOGICAL:1
! Electranix Common Transfer - Get
#LOCAL REAL TEMP_INIT
#IF ( DimO > 0 )
#IF (Interp == 1)
      IF ( FIRSTSTEP ) CALL Electranix_GetSet_AddInterpolation($Port)
#ENDIF
      CALL ELECTRANIX_COMMON_GET_Rn(1,$DimO,$Port,$CDelay,$TStart,$OUTR)
#ELSE
      TEMP_INIT = 0.0
      CALL ELECTRANIX_COMMON_GET_Rn(1,$DimO,$Port,0.0,$TStart,TEMP_INIT)
#ENDIF
"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Common Block Transfer - Input/Output via TCP

Transfers Information from one page to another
     - Real Variables Supported
     - Multiple Inputs or Outputs allowed
     - Can transfer up to 1000 quantities (R)"
   }
  }
 Component("Sequencer_Electranix_AutoLaunch")
  {
  Desc = "Launches EMTDC .exes on local/remote computers"
  FileDate = 0
  Parameters = 
   {
   Category("External Case 1")
    {
    Choice("Strt1",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName1",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp1"
     Len = 30
     Cond = "Strt1>=1"
     }
    Text("PName1",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..\\Case1.emt"
     Len = 15
     Cond = "Strt1>=1"
     }
    Text("FName1",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case1.exe"
     Len = 30
     Cond = "Strt1>=1"
     }
    Choice("Kill1",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt1>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc1",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt1>=1"
     }
    }
   Category("External Case 2")
    {
    Choice("Strt2",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName2",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp2"
     Len = 30
     Cond = "Strt2>=1"
     }
    Text("PName2",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case2.emt"
     Len = 15
     Cond = "Strt2>=1"
     }
    Text("FName2",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case2.exe"
     Len = 30
     Cond = "Strt2>=1"
     }
    Choice("Kill2",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt2>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc2",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt2>=1"
     }
    }
   Category("External Case 3")
    {
    Choice("Strt3",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName3",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp3"
     Len = 30
     Cond = "Strt3>=1"
     }
    Text("PName3",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case3.emt"
     Len = 15
     Cond = "Strt3>=1"
     }
    Text("FName3",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case3.exe"
     Len = 30
     Cond = "Strt3>=1"
     }
    Choice("Kill3",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt3>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc3",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt3>=1"
     }
    }
   Category("External Case 4")
    {
    Choice("Strt4",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName4",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp4"
     Len = 30
     Cond = "Strt4>=1"
     }
    Text("PName4",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case4.emt"
     Len = 15
     Cond = "Strt4>=1"
     }
    Text("FName4",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case4.exe"
     Len = 30
     Cond = "Strt4>=1"
     }
    Choice("Kill4",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt4>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc4",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt4>=1"
     }
    }
   Category("External Case 5")
    {
    Choice("Strt5",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName5",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp5"
     Len = 30
     Cond = "Strt5>=1"
     }
    Text("PName5",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case5.emt"
     Len = 15
     Cond = "Strt5>=1"
     }
    Text("FName5",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case5.exe"
     Len = 30
     Cond = "Strt5>=1"
     }
    Choice("Kill5",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt5>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc5",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt5>=1"
     }
    }
   Category("External Case 6")
    {
    Choice("Strt6",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName6",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp6"
     Len = 30
     Cond = "Strt6>=1"
     }
    Text("PName6",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case6.emt"
     Len = 15
     Cond = "Strt6>=1"
     }
    Text("FName6",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case6.exe"
     Len = 30
     Cond = "Strt6>=1"
     }
    Choice("Kill6",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt6>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc6",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt6>=1"
     }
    }
   Category("External Case 7")
    {
    Choice("Strt7",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName7",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp7"
     Len = 30
     Cond = "Strt7>=1"
     }
    Text("PName7",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case7.emt"
     Len = 15
     Cond = "Strt7>=1"
     }
    Text("FName7",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case7.exe"
     Len = 30
     Cond = "Strt7>=1"
     }
    Choice("Kill7",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt7>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc7",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt7>=1"
     }
    }
   Category("External Case 8")
    {
    Choice("Strt8",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName8",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp8"
     Len = 30
     Cond = "Strt8>=1"
     }
    Text("PName8",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case8.emt"
     Len = 15
     Cond = "Strt8>=1"
     }
    Text("FName8",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case8.exe"
     Len = 30
     Cond = "Strt8>=1"
     }
    Choice("Kill8",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt8>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc8",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt8>=1"
     }
    }
   Category("External Case 9")
    {
    Choice("Strt9",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName9",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp9"
     Len = 30
     Cond = "Strt9>=1"
     }
    Text("PName9",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case9.emt"
     Len = 15
     Cond = "Strt9>=1"
     }
    Text("FName9",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case9.exe"
     Len = 30
     Cond = "Strt9>=1"
     }
    Choice("Kill9",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt9>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc9",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt9>=1"
     }
    }
   Category("External Case 10")
    {
    Choice("Strt10",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName10",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp10"
     Len = 30
     Cond = "Strt10>=1"
     }
    Text("PName10",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case10.emt"
     Len = 15
     Cond = "Strt10>=1"
     }
    Text("FName10",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case10.exe"
     Len = 30
     Cond = "Strt10>=1"
     }
    Choice("Kill10",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt10>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc10",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt10>=1"
     }
    }
   Category("External Case 11")
    {
    Choice("Strt11",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName11",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp11"
     Len = 30
     Cond = "Strt11>=1"
     }
    Text("PName11",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case11.emt"
     Len = 15
     Cond = "Strt11>=1"
     }
    Text("FName11",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case11.exe"
     Len = 30
     Cond = "Strt11>=1"
     }
    Choice("Kill11",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt11>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc11",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt11>=1"
     }
    }
   Category("External Case 12")
    {
    Choice("Strt12",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName12",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp12"
     Len = 30
     Cond = "Strt12>=1"
     }
    Text("PName12",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case12.emt"
     Len = 15
     Cond = "Strt12>=1"
     }
    Text("FName12",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case12.exe"
     Len = 30
     Cond = "Strt12>=1"
     }
    Choice("Kill12",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt12>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc12",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt12>=1"
     }
    }
   Category("External Case 13")
    {
    Choice("Strt13",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName13",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp13"
     Len = 30
     Cond = "Strt13>=1"
     }
    Text("PName13",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case13.emt"
     Len = 15
     Cond = "Strt13>=1"
     }
    Text("FName13",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case13.exe"
     Len = 30
     Cond = "Strt13>=1"
     }
    Choice("Kill13",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt13>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc13",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt13>=1"
     }
    }
   Category("External Case 14")
    {
    Choice("Strt14",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName14",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp14"
     Len = 30
     Cond = "Strt14>=1"
     }
    Text("PName14",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case14.emt"
     Len = 15
     Cond = "Strt14>=1"
     }
    Text("FName14",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case14.exe"
     Len = 30
     Cond = "Strt14>=1"
     }
    Choice("Kill14",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt14>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc14",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt14>=1"
     }
    }
   Category("External Case 15")
    {
    Choice("Strt15",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName15",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp15"
     Len = 30
     Cond = "Strt15>=1"
     }
    Text("PName15",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case15.emt"
     Len = 15
     Cond = "Strt15>=1"
     }
    Text("FName15",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case15.exe"
     Len = 30
     Cond = "Strt15>=1"
     }
    Choice("Kill15",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt15>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc15",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt15>=1"
     }
    }
   Category("External Case 16")
    {
    Choice("Strt16",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName16",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp16"
     Len = 30
     Cond = "Strt16>=1"
     }
    Text("PName16",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case16.emt"
     Len = 15
     Cond = "Strt16>=1"
     }
    Text("FName16",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case16.exe"
     Len = 30
     Cond = "Strt16>=1"
     }
    Choice("Kill16",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt16>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc16",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt16>=1"
     }
    }
   Category("External Case 17")
    {
    Choice("Strt17",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName17",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp17"
     Len = 30
     Cond = "Strt17>=1"
     }
    Text("PName17",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case17.emt"
     Len = 15
     Cond = "Strt17>=1"
     }
    Text("FName17",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case17.exe"
     Len = 30
     Cond = "Strt17>=1"
     }
    Choice("Kill17",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt17>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc17",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt17>=1"
     }
    }
   Category("External Case 18")
    {
    Choice("Strt18",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName18",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp18"
     Len = 30
     Cond = "Strt18>=1"
     }
    Text("PName18",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case18.emt"
     Len = 15
     Cond = "Strt18>=1"
     }
    Text("FName18",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case18.exe"
     Len = 30
     Cond = "Strt18>=1"
     }
    Choice("Kill18",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt18>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc18",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt18>=1"
     }
    }
   Category("External Case 19")
    {
    Choice("Strt19",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName19",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp19"
     Len = 30
     Cond = "Strt19>=1"
     }
    Text("PName19",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case19.emt"
     Len = 15
     Cond = "Strt19>=1"
     }
    Text("FName19",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case19.exe"
     Len = 30
     Cond = "Strt19>=1"
     }
    Choice("Kill19",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt19>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc19",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt19>=1"
     }
    }
   Category("External Case 20")
    {
    Choice("Strt20",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName20",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp20"
     Len = 30
     Cond = "Strt20>=1"
     }
    Text("PName20",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case20.emt"
     Len = 15
     Cond = "Strt20>=1"
     }
    Text("FName20",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case20.exe"
     Len = 30
     Cond = "Strt20>=1"
     }
    Choice("Kill20",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt20>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc20",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt20>=1"
     }
    }
   Category("External Case 21")
    {
    Choice("Strt21",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName21",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp21"
     Len = 30
     Cond = "Strt21>=1"
     }
    Text("PName21",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case21.emt"
     Len = 15
     Cond = "Strt21>=1"
     }
    Text("FName21",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case21.exe"
     Len = 30
     Cond = "Strt21>=1"
     }
    Choice("Kill21",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt21>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc21",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt21>=1"
     }
    }
   Category("External Case 22")
    {
    Choice("Strt22",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName22",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp22"
     Len = 30
     Cond = "Strt22>=1"
     }
    Text("PName22",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case22.emt"
     Len = 15
     Cond = "Strt22>=1"
     }
    Text("FName22",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case22.exe"
     Len = 30
     Cond = "Strt22>=1"
     }
    Choice("Kill22",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt22>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc22",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt22>=1"
     }
    }
   Category("External Case 23")
    {
    Choice("Strt23",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName23",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp23"
     Len = 30
     Cond = "Strt23>=1"
     }
    Text("PName23",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case23.emt"
     Len = 15
     Cond = "Strt23>=1"
     }
    Text("FName23",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case23.exe"
     Len = 30
     Cond = "Strt23>=1"
     }
    Choice("Kill23",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt23>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc23",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt23>=1"
     }
    }
   Category("External Case 24")
    {
    Choice("Strt24",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName24",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp24"
     Len = 30
     Cond = "Strt24>=1"
     }
    Text("PName24",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case24.emt"
     Len = 15
     Cond = "Strt24>=1"
     }
    Text("FName24",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case24.exe"
     Len = 30
     Cond = "Strt24>=1"
     }
    Choice("Kill24",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt24>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc24",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt24>=1"
     }
    }
   Category("External Case 25")
    {
    Choice("Strt25",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName25",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp25"
     Len = 30
     Cond = "Strt25>=1"
     }
    Text("PName25",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case25.emt"
     Len = 15
     Cond = "Strt25>=1"
     }
    Text("FName25",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case25.exe"
     Len = 30
     Cond = "Strt25>=1"
     }
    Choice("Kill25",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt25>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc25",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt25>=1"
     }
    }
   Category("External Case 26")
    {
    Choice("Strt26",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName26",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp26"
     Len = 30
     Cond = "Strt26>=1"
     }
    Text("PName26",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case26.emt"
     Len = 15
     Cond = "Strt26>=1"
     }
    Text("FName26",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case26.exe"
     Len = 30
     Cond = "Strt26>=1"
     }
    Choice("Kill26",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt26>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc26",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt26>=1"
     }
    }
   Category("External Case 27")
    {
    Choice("Strt27",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName27",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp27"
     Len = 30
     Cond = "Strt27>=1"
     }
    Text("PName27",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case27.emt"
     Len = 15
     Cond = "Strt27>=1"
     }
    Text("FName27",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case27.exe"
     Len = 30
     Cond = "Strt27>=1"
     }
    Choice("Kill27",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt27>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc27",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt27>=1"
     }
    }
   Category("External Case 28")
    {
    Choice("Strt28",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName28",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp28"
     Len = 30
     Cond = "Strt28>=1"
     }
    Text("PName28",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case28.emt"
     Len = 15
     Cond = "Strt28>=1"
     }
    Text("FName28",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case28.exe"
     Len = 30
     Cond = "Strt28>=1"
     }
    Choice("Kill28",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt28>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc28",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt28>=1"
     }
    }
   Category("External Case 29")
    {
    Choice("Strt29",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName29",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp29"
     Len = 30
     Cond = "Strt29>=1"
     }
    Text("PName29",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case29.emt"
     Len = 15
     Cond = "Strt29>=1"
     }
    Text("FName29",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case29.exe"
     Len = 30
     Cond = "Strt29>=1"
     }
    Choice("Kill29",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt29>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc29",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt29>=1"
     }
    }
   Category("External Case 30")
    {
    Choice("Strt30",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName30",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp30"
     Len = 30
     Cond = "Strt30>=1"
     }
    Text("PName30",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case30.emt"
     Len = 15
     Cond = "Strt30>=1"
     }
    Text("FName30",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case30.exe"
     Len = 30
     Cond = "Strt30>=1"
     }
    Choice("Kill30",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt30>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc30",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt30>=1"
     }
    }
   Category("External Case 31")
    {
    Choice("Strt31",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName31",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp31"
     Len = 30
     Cond = "Strt31>=1"
     }
    Text("PName31",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case31.emt"
     Len = 15
     Cond = "Strt31>=1"
     }
    Text("FName31",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case31.exe"
     Len = 30
     Cond = "Strt31>=1"
     }
    Choice("Kill31",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt31>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc31",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt31>=1"
     }
    }
   Category("External Case 32")
    {
    Choice("Strt32",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName32",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp32"
     Len = 30
     Cond = "Strt32>=1"
     }
    Text("PName32",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case32.emt"
     Len = 15
     Cond = "Strt32>=1"
     }
    Text("FName32",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case32.exe"
     Len = 30
     Cond = "Strt32>=1"
     }
    Choice("Kill32",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt32>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc32",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt32>=1"
     }
    }
   Category("External Case 33")
    {
    Choice("Strt33",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName33",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp33"
     Len = 30
     Cond = "Strt33>=1"
     }
    Text("PName33",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case33.emt"
     Len = 15
     Cond = "Strt33>=1"
     }
    Text("FName33",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case33.exe"
     Len = 30
     Cond = "Strt33>=1"
     }
    Choice("Kill33",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt33>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc33",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt33>=1"
     }
    }
   Category("External Case 34")
    {
    Choice("Strt34",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName34",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp34"
     Len = 30
     Cond = "Strt34>=1"
     }
    Text("PName34",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case34.emt"
     Len = 15
     Cond = "Strt34>=1"
     }
    Text("FName34",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case34.exe"
     Len = 30
     Cond = "Strt34>=1"
     }
    Choice("Kill34",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt34>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc34",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt34>=1"
     }
    }
   Category("External Case 35")
    {
    Choice("Strt35",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName35",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp35"
     Len = 30
     Cond = "Strt35>=1"
     }
    Text("PName35",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case35.emt"
     Len = 15
     Cond = "Strt35>=1"
     }
    Text("FName35",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case35.exe"
     Len = 30
     Cond = "Strt35>=1"
     }
    Choice("Kill35",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt35>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc35",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt35>=1"
     }
    }
   Category("External Case 36")
    {
    Choice("Strt36",5,4,279,12,2)
     {
     Style = 0
     Desc = "Autostart case"
     Def = "0"
     Len = 30
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Text("CName36",5,20,279,12,2)
     {
     Desc = "Computer name or IP address"
     Def = "Comp36"
     Len = 30
     Cond = "Strt36>=1"
     }
    Text("PName36",5,36,279,24,2)
     {
     Desc = "Path to .exe or .bat (ex: ..\\Case1.emt, or C:\\Temp\\Case2.if12, or \\\\C1\\Test\\Case2.cf6) "
     Def = "..Case36.emt"
     Len = 15
     Cond = "Strt36>=1"
     }
    Text("FName36",5,64,279,12,2)
     {
     Desc = "Filename of .exe or .bat to run (ex: Case1.exe)"
     Def = "Case36.exe"
     Len = 30
     Cond = "Strt36>=1"
     }
    Choice("Kill36",5,80,279,12,2)
     {
     Style = 0
     Desc = "Kill existing processes"
     Def = "0"
     Len = 30
     Cond = "Strt36>=1"
     *0 = "Disabled"
     *1 = "Enabled"
     }
    Input("Proc36",5,96,279,12,2)
     {
     Desc = "Processor affinity (1-N, 0 for auto)"
     Def = "0"
     Data = Integer
     Len = 30
     Min = 0
     Cond = "Strt36>=1"
     }
    }
   Category("Options")
    {
    Choice("Priority",9,8,180,55,2)
     {
     Style = 1
     Desc = "Process Priority"
     Def = "0"
     Len = 15
     *-1 = "/BelowNormal"
     *0 = "/Normal"
     *1 = "/AboveNormal"
     }
    }
   }

  Nodes = 
   {
   Output("DumOut",36,0)
    {
    Type = Integer
    }
   }

  Graphics = 
   {
   Rectangle(-76,-33,81,25)
   Text(-68,-22,"E+")
   Font(,,Left)
   Text(-73,5,"ETRAN Plus")
   Text(-73,19,"Process AutoLaunch")
   }

  Section(EMTDC)
   {
   DSDYN = "\
! Collect all port and computer names
      IF ( FIRSTSTEP ) THEN

! Collect all autolaunch computer names
      #IF ( Strt1 > 0 )
         IF ( \"%CName1\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill1, $Priority, $Proc1, \"%PName1\", \"%FName1\", \"localhost\", 1)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill1, $Priority, $Proc1, \"%PName1\", \"%FName1\", \"%CName1\", 1)
         ENDIF
      #ENDIF
      #IF ( Strt2 > 0 )
         IF ( \"%CName2\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill2, $Priority, $Proc2, \"%PName2\", \"%FName2\", \"localhost\", 2)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill2, $Priority, $Proc2, \"%PName2\", \"%FName2\", \"%CName2\", 2)
         ENDIF
      #ENDIF
      #IF ( Strt3 > 0 )
         IF ( \"%CName3\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill3, $Priority, $Proc3, \"%PName3\", \"%FName3\", \"localhost\", 3)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill3, $Priority, $Proc3, \"%PName3\", \"%FName3\", \"%CName3\", 3)
         ENDIF
      #ENDIF
      #IF ( Strt4 > 0 )
         IF ( \"%CName4\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill4, $Priority, $Proc4, \"%PName4\", \"%FName4\", \"localhost\", 4)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill4, $Priority, $Proc4, \"%PName4\", \"%FName4\", \"%CName4\", 4)
         ENDIF
      #ENDIF
      #IF ( Strt5 > 0 )
         IF ( \"%CName5\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill5, $Priority, $Proc5, \"%PName5\", \"%FName5\", \"localhost\", 5)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill5, $Priority, $Proc5, \"%PName5\", \"%FName5\", \"%CName5\", 5)
         ENDIF
      #ENDIF
      #IF ( Strt6 > 0 )
         IF ( \"%CName6\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill6, $Priority, $Proc6, \"%PName6\", \"%FName6\", \"localhost\", 6)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill6, $Priority, $Proc6, \"%PName6\", \"%FName6\", \"%CName6\", 6)
         ENDIF
      #ENDIF
      #IF ( Strt7 > 0 )
         IF ( \"%CName7\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill7, $Priority, $Proc7, \"%PName7\", \"%FName7\", \"localhost\", 7)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill7, $Priority, $Proc7, \"%PName7\", \"%FName7\", \"%CName7\", 7)
         ENDIF
      #ENDIF
      #IF ( Strt8 > 0 )
         IF ( \"%CName8\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill8, $Priority, $Proc8, \"%PName8\", \"%FName8\", \"localhost\", 8)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill8, $Priority, $Proc8, \"%PName8\", \"%FName8\", \"%CName8\", 8)
         ENDIF
      #ENDIF
      #IF ( Strt9 > 0 )
         IF ( \"%CName9\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill9, $Priority, $Proc9, \"%PName9\", \"%FName9\", \"localhost\", 9)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill9, $Priority, $Proc9, \"%PName9\", \"%FName9\", \"%CName9\", 9)
         ENDIF
      #ENDIF
      #IF ( Strt10 > 0 )
         IF ( \"%CName10\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill10, $Priority, $Proc10, \"%PName10\", \"%FName10\", \"localhost\", 10)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill10, $Priority, $Proc10, \"%PName10\", \"%FName10\", \"%CName10\", 10)
         ENDIF
      #ENDIF
      #IF ( Strt11 > 0 )
         IF ( \"%CName11\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill11, $Priority, $Proc11, \"%PName11\", \"%FName11\", \"localhost\", 11)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill11, $Priority, $Proc11, \"%PName11\", \"%FName11\", \"%CName11\", 11)
         ENDIF
      #ENDIF
      #IF ( Strt12 > 0 )
         IF ( \"%CName12\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill12, $Priority, $Proc12, \"%PName12\", \"%FName12\", \"localhost\", 12)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill12, $Priority, $Proc12, \"%PName12\", \"%FName12\", \"%CName12\", 12)
         ENDIF
      #ENDIF
      #IF ( Strt13 > 0 )
         IF ( \"%CName13\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill13, $Priority, $Proc13, \"%PName13\", \"%FName13\", \"localhost\", 13)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill13, $Priority, $Proc13, \"%PName13\", \"%FName13\", \"%CName13\", 13)
         ENDIF
      #ENDIF
      #IF ( Strt14 > 0 )
         IF ( \"%CName14\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill14, $Priority, $Proc14, \"%PName14\", \"%FName14\", \"localhost\", 14)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill14, $Priority, $Proc14, \"%PName14\", \"%FName14\", \"%CName14\", 14)
         ENDIF
      #ENDIF
      #IF ( Strt15 > 0 )
         IF ( \"%CName15\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill15, $Priority, $Proc15, \"%PName15\", \"%FName15\", \"localhost\", 15)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill15, $Priority, $Proc15, \"%PName15\", \"%FName15\", \"%CName15\", 15)
         ENDIF
      #ENDIF
      #IF ( Strt16 > 0 )
         IF ( \"%CName16\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill16, $Priority, $Proc16, \"%PName16\", \"%FName16\", \"localhost\", 16)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill16, $Priority, $Proc16, \"%PName16\", \"%FName16\", \"%CName16\", 16)
         ENDIF
      #ENDIF
      #IF ( Strt17 > 0 )
         IF ( \"%CName17\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill17, $Priority, $Proc17, \"%PName17\", \"%FName17\", \"localhost\", 17)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill17, $Priority, $Proc17, \"%PName17\", \"%FName17\", \"%CName17\", 17)
         ENDIF
      #ENDIF
      #IF ( Strt18 > 0 )
         IF ( \"%CName18\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill18, $Priority, $Proc18, \"%PName18\", \"%FName18\", \"localhost\", 18)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill18, $Priority, $Proc18, \"%PName18\", \"%FName18\", \"%CName18\", 18)
         ENDIF
      #ENDIF
      #IF ( Strt19 > 0 )
         IF ( \"%CName19\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill19, $Priority, $Proc19, \"%PName19\", \"%FName19\", \"localhost\", 19)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill19, $Priority, $Proc19, \"%PName19\", \"%FName19\", \"%CName19\", 19)
         ENDIF
      #ENDIF
      #IF ( Strt20 > 0 )
         IF ( \"%CName20\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill20, $Priority, $Proc20, \"%PName20\", \"%FName20\", \"localhost\", 20)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill20, $Priority, $Proc20, \"%PName20\", \"%FName20\", \"%CName20\", 20)
         ENDIF
      #ENDIF
      #IF ( Strt21 > 0 )
         IF ( \"%CName21\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill21, $Priority, $Proc21, \"%PName21\", \"%FName21\", \"localhost\", 21)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill21, $Priority, $Proc21, \"%PName21\", \"%FName21\", \"%CName21\", 21)
         ENDIF
      #ENDIF
      #IF ( Strt22 > 0 )
         IF ( \"%CName22\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill22, $Priority, $Proc22, \"%PName22\", \"%FName22\", \"localhost\", 22)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill22, $Priority, $Proc22, \"%PName22\", \"%FName22\", \"%CName22\", 22)
         ENDIF
      #ENDIF
      #IF ( Strt23 > 0 )
         IF ( \"%CName23\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill23, $Priority, $Proc23, \"%PName23\", \"%FName23\", \"localhost\", 23)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill23, $Priority, $Proc23, \"%PName23\", \"%FName23\", \"%CName23\", 23)
         ENDIF
      #ENDIF
      #IF ( Strt24 > 0 )
         IF ( \"%CName24\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill24, $Priority, $Proc24, \"%PName24\", \"%FName24\", \"localhost\", 24)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill24, $Priority, $Proc24, \"%PName24\", \"%FName24\", \"%CName24\", 24)
         ENDIF
      #ENDIF
      #IF ( Strt25 > 0 )
         IF ( \"%CName25\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill25, $Priority, $Proc25, \"%PName25\", \"%FName25\", \"localhost\", 25)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill25, $Priority, $Proc25, \"%PName25\", \"%FName25\", \"%CName25\", 25)
         ENDIF
      #ENDIF
      #IF ( Strt26 > 0 )
         IF ( \"%CName26\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill26, $Priority, $Proc26, \"%PName26\", \"%FName26\", \"localhost\", 26)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill26, $Priority, $Proc26, \"%PName26\", \"%FName26\", \"%CName26\", 26)
         ENDIF
      #ENDIF
      #IF ( Strt27 > 0 )
         IF ( \"%CName27\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill27, $Priority, $Proc27, \"%PName27\", \"%FName27\", \"localhost\", 27)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill27, $Priority, $Proc27, \"%PName27\", \"%FName27\", \"%CName27\", 27)
         ENDIF
      #ENDIF
      #IF ( Strt28 > 0 )
         IF ( \"%CName28\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill28, $Priority, $Proc28, \"%PName28\", \"%FName28\", \"localhost\", 28)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill28, $Priority, $Proc28, \"%PName28\", \"%FName28\", \"%CName28\", 28)
         ENDIF
      #ENDIF
      #IF ( Strt29 > 0 )
         IF ( \"%CName29\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill29, $Priority, $Proc29, \"%PName29\", \"%FName29\", \"localhost\", 29)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill29, $Priority, $Proc29, \"%PName29\", \"%FName29\", \"%CName29\", 29)
         ENDIF
      #ENDIF
      #IF ( Strt30 > 0 )
         IF ( \"%CName30\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill30, $Priority, $Proc30, \"%PName30\", \"%FName30\", \"localhost\", 30)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill30, $Priority, $Proc30, \"%PName30\", \"%FName30\", \"%CName30\", 30)
         ENDIF
      #ENDIF
      #IF ( Strt31 > 0 )
         IF ( \"%CName31\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill31, $Priority, $Proc31, \"%PName31\", \"%FName31\", \"localhost\", 31)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill31, $Priority, $Proc31, \"%PName31\", \"%FName31\", \"%CName31\", 31)
         ENDIF
      #ENDIF
      #IF ( Strt32 > 0 )
         IF ( \"%CName32\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill32, $Priority, $Proc32, \"%PName32\", \"%FName32\", \"localhost\", 32)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill32, $Priority, $Proc32, \"%PName32\", \"%FName32\", \"%CName32\", 32)
         ENDIF
      #ENDIF
      #IF ( Strt33 > 0 )
         IF ( \"%CName33\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill33, $Priority, $Proc33, \"%PName33\", \"%FName33\", \"localhost\", 33)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill33, $Priority, $Proc33, \"%PName33\", \"%FName33\", \"%CName33\", 33)
         ENDIF
      #ENDIF
      #IF ( Strt34 > 0 )
         IF ( \"%CName34\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill34, $Priority, $Proc34, \"%PName34\", \"%FName34\", \"localhost\", 34)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill34, $Priority, $Proc34, \"%PName34\", \"%FName34\", \"%CName34\", 34)
         ENDIF
      #ENDIF
      #IF ( Strt35 > 0 )
         IF ( \"%CName35\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill35, $Priority, $Proc35, \"%PName35\", \"%FName35\", \"localhost\", 35)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill35, $Priority, $Proc35, \"%PName35\", \"%FName35\", \"%CName35\", 35)
         ENDIF
      #ENDIF
      #IF ( Strt36 > 0 )
         IF ( \"%CName36\" .EQ. \"localhost\" ) THEN
            CALL ETRAN_COM_Remote_Start(1, $Kill36, $Priority, $Proc36, \"%PName36\", \"%FName36\", \"localhost\", 36)
         ELSE
            CALL ETRAN_COM_Remote_Start(2, $Kill36, $Priority, $Proc36, \"%PName36\", \"%FName36\", \"%CName36\", 36)
         ENDIF
      #ENDIF
      ENDIF

! Cpu Time Meter
      IF ( FIRSTSTEP ) THEN
         CALL WRITE_CPUTIME_F(1)
      ENDIF
      IF ( LASTSTEP ) THEN
         CALL WRITE_CPUTIME_F(0)
      ENDIF
"
   }
  }
 Component("Electranix_Load")
  {
  Desc = "PSSE Compatible Load Model"
  FileDate = 0
  Parameters = 
   {
   Category("Parameters")
    {
    Text("Name",5,4,269,12,2)
     {
     Desc = "Load Name"
     Def = "Load 1"
     Len = 21
     }
    Input("PO",5,20,269,12,2)
     {
     Desc = "3 Phase Real Power (MW)"
     Def = "100"
     Data = Real
     Unit = "MW"
     Len = 15
     Min = 0
     Cond = "LoadType!=4"
     }
    Input("QO",5,36,269,12,2)
     {
     Desc = "3 Phase Reactive Power (MVAR,+L)"
     Def = "25"
     Data = Real
     Unit = "MVAR"
     Len = 15
     Cond = "LoadType!=4"
     }
    Input("FR",5,52,269,12,6)
     {
     Desc = "Fundamental Frequency (Hz)"
     Def = "60"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0
     }
    Input("VBO",5,68,269,12,2)
     {
     Desc = "Rated Load Voltage (kV,L-L,rms)"
     Def = "230"
     Data = Real
     Unit = "KV"
     Len = 15
     Min = 0
     }
    Input("VO",5,84,269,12,6)
     {
     Desc = "Initial Load Voltage for initialization(p.u., can be a var)"
     Def = "1"
     Data = Real
     Unit = "p.u."
     Len = 15
     Min = 0
     Cond = "LoadType!=4"
     }
    Input("HOLD",5,100,269,12,6)
     {
     Desc = "Hold Signal  (0=Hold, 1=Modify, can be a variable)"
     Def = "1"
     Data = Integer
     Len = 15
     Cond = "LoadType<=2"
     }
    Choice("LoadType",5,116,155,76,2)
     {
     Style = 1
     Desc = "Select Load Type:"
     Def = "0"
     Len = 15
     *0 = "Constant Power Load"
     *1 = "Constant Current Load"
     *2 = "Constant Impedance Load"
     *3 = "Constant R,L,C Shunt Branch"
     *4 = "Pure Zero Seq Load (+ve Seq = infinite)"
     }
    Choice("Compact",169,116,104,44,2)
     {
     Style = 1
     Desc = "Use Small Icon for LC Load?"
     Def = "0"
     Len = 15
     Cond = "LoadType==3"
     *0 = "No (Large Icon)"
     *1 = "Yes (Small Icon)"
     }
    Choice("View",5,196,155,56,2)
     {
     Style = 1
     Desc = "Circuit Type?"
     Def = "2"
     Len = 15
     *0 = "Three Phase"
     *1 = "Three Phase Single Line Diagram (V4)"
     *2 = "Single Phase"
     }
    Choice("Enable",169,196,102,42,2)
     {
     Style = 1
     Desc = "Is this Device Enabled?"
     Def = "1"
     Len = 15
     *0 = "No (Disabled)"
     *1 = "Yes (Enabled)"
     }
    }
   Category("Zero Sequence Parameters")
    {
    Cond = "View!=2"
    Choice("ZeroSeq",5,4,169,55,2)
     {
     Style = 1
     Desc = "Zero Sequence Impedance?"
     Def = "0"
     Len = 15
     Cond = "LoadType!=4"
     *0 = "Zero Seq Impedance = Pos Seq (grounded)"
     *1 = "Zero Seq Impedance is Infinite (un-grounded)"
     *2 = "Enter Zero Seq Impedance Separately"
     }
    Input("MVA",5,64,269,12,2)
     {
     Desc = "Base MVA (used only for Zero Seq pu Impedances)"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 0
     Cond = "ZeroSeq==2 || LoadType==4"
     }
    Input("R0pu",5,80,269,12,2)
     {
     Desc = "Zero Seq Resistance (pu on Base MVA)"
     Def = "0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "ZeroSeq==2 || LoadType==4"
     }
    Input("X0pu",5,96,269,12,2)
     {
     Desc = "Zero Seq Inductive Reactance (pu, +ve for inductance)"
     Def = "1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Cond = "ZeroSeq==2 || LoadType==4"
     }
    }
   Category("Outputs")
    {
    Text("PL",5,4,269,12,2)
     {
     Desc = "Name for Total Load P (MW,3 Phase)"
     Len = 24
     }
    Text("QL",5,20,269,12,2)
     {
     Desc = "Name for Total Load Q (MVAR,3 Phase,+L)"
     Len = 24
     }
    Text("INAME",5,36,269,12,2)
     {
     Desc = "Name for Load Currents (kA,Instantaneous)"
     Len = 24
     }
    }
   Category("Animated States")
    {
    Text("Pdisplay",5,4,269,12,2)
     {
     Desc = "Animated Display of P (Auto-updated)"
     Def = "0.0"
     Len = 24
     }
    Text("Qdisplay",5,20,269,12,2)
     {
     Desc = "Animated Display of Q (Auto-updated)"
     Def = "0.0"
     Len = 24
     }
    }
   }

  Nodes = 
   {
   Electrical("IB",0,0)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("IA",0,0)
    {
    Cond = "(Enable==1)&&(View==2)"
    }
   Electrical("IC",0,18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("IA",0,-18)
    {
    Cond = "(Enable==1)&&(View==0)"
    }
   Electrical("I",0,0)
    {
    Cond = "(Enable==1)&&(View==1)"
    Dim  = [3]
    }
   Electrical("Gnd",90,0)
    {
    Cond = "(Enable==1)&&((LoadType!=3)||(Compact==0))"
    Type = Ground
    }
   Electrical("Gnd",36,0)
    {
    Cond = "(Enable==1)&&(LoadType==3)&&(Compact==1)"
    Type = Ground
    }
   Electrical("Neut",72,0)
    {
    Cond = "(Enable==1)&&((LoadType!=3)||(Compact==0))&&((ZeroSeq!=0)||(LoadType==4))"
    }
   Electrical("Neut",18,0)
    {
    Cond = "(Enable==1)&&(LoadType==3)&&(Compact==1)&&(ZeroSeq!=0)"
    }
   }

  Graphics = 
   {
   Brush(BkDiag,,Silver)
   Cond = "(Enable==0)&&(View==0)&&((LoadType!=3)||(Compact==0))"
   Rectangle(-1,-21,108,21)
   Cond = "(Enable==0)&&(View!=0)&&((LoadType!=3)||(Compact==0))"
   Rectangle(-1,-15,108,16)
   Cond = "(ZeroSeq!=1)&&((LoadType!=3)||(Compact==0))"
   Line(99,8,99,-9)
   Line(103,5,103,-5)
   Line(106,2,106,-2)
   Cond = "(LoadType!=4)&&(ZeroSeq==0)&&((LoadType!=3)||(Compact==0))"
   Line(91,0,99,0)
   Cond = "((LoadType!=3)||(Compact==0))"
   Line(34,-3,40,0)
   Line(40,0,34,3)
   Cond = "(View==0)&&((LoadType!=3)||(Compact==0))"
   Line(0,-18,28,-18)
   Line(28,-18,34,0)
   Line(0,18,28,18)
   Line(28,18,34,0)
   Cond = "(View!=1)&&((LoadType!=3)||(Compact==0))"
   Line(0,0,42,0)
   Pen(,,0.6)
   Cond = "(View==1)&&((LoadType!=3)||(Compact==0))"
   Line(0,0,42,0)
   Pen(,,0.2)
   Brush(Hollow)
   Cond = "(View!=1)&&((LoadType!=3)||(Compact==0))"
   Rectangle(42,-13,91,11)
   Pen(,,0.6)
   Cond = "(View==1)&&((LoadType!=3)||(Compact==0))"
   Rectangle(42,-12,91,12)
   Pen(,,0.2)
   Cond = "(LoadType==3)&&(Compact==1)"
   Line(0,0,3,0)
   Cond = "(LoadType==3)&&(Compact==1)&&(Enable==1)"
   Rectangle(3,-3,28,3)
   Brush(BkDiag)
   Cond = "(LoadType==3)&&(Compact==1)&&(Enable==0)"
   Rectangle(3,-3,28,3)
   Cond = "(LoadType==3)&&(Compact==1)&&(ZeroSeq==0)"
   Line(28,0,34,0)
   Cond = "(LoadType==3)&&(Compact==1)&&(ZeroSeq!=1)"
   Line(34,3,34,-3)
   Line(36,1,36,-2)
   Cond = "(LoadType==3)&&(Compact==1)&&(View==0)"
   Line(0,-18,2,-18)
   Line(2,18,2,-18)
   Line(2,18,0,18)
   Cond = "LoadType==1"
   Text(70,-1,"Const I")
   Cond = "LoadType==2"
   Text(70,-1,"Const Z")
   Cond = "LoadType==0"
   Text(70,-1,"P,Q")
   Cond = "(LoadType==3)&&(Compact==0)"
   Text(70,-1,"Shunt")
   Cond = "LoadType<=2"
   Text(72,9,"Load")
   Cond = "(LoadType==3)&&(Compact==0)&&((PO<1.0e-10)&&(QO>1.0E-10))"
   Text(72,8,"L")
   Cond = "(LoadType==3)&&(Compact==0)&&((PO>0.0)&&(abs(QO)<1.0E-10))"
   Text(72,9,"R")
   Cond = "(LoadType==3)&&(Compact==0)&&((PO<1.0e-10)&&(QO<-1.0E-10))"
   Text(72,9,"C")
   Cond = "(LoadType==3)&&(Compact==0)&&((PO>1.0e-10)&&(QO>1.0E-10))"
   Text(72,9,"RL")
   Cond = "(LoadType==3)&&(Compact==0)&&((PO>1.0e-10)&&(QO<-1.0E-10))"
   Text(72,9,"RC")
   Font(,,Left)
   Cond = "((LoadType!=3)||(Compact==0))"
   Text(0,-3,"$Pdisplay")
   Font(,,Centre)
   Text(46,10,"E")
   Cond = "(View==0)&&((LoadType!=3)||(Compact==0))"
   Text(6,-19,"A")
   Font(,,Left)
   Cond = "((LoadType!=3)||(Compact==0))"
   Text(0,12,"$Qdisplay")
   Font(,,Centre)
   Cond = "(LoadType==4)"
   Text(69,-2,"0 Seq")
   Cond = "LoadType==4"
   Text(71,9,"Load")
   Cond = "(ZeroSeq!=1)&&((LoadType!=3)||(Compact==0))"
   Line(99,8,99,-9)
   Line(103,5,103,-5)
   Line(106,2,106,-2)
   Brush(Hollow)
   Cond = "((LoadType==4)||(ZeroSeq==2)&&((LoadType!=3)||(Compact==0)))"
   Rectangle(93,-1,97,1)
   Line(93,0,90,0)
   Line(97,0,99,0)
   Cond = "(LoadType==3)&&(Compact==1)&&(ZeroSeq==2)"
   Rectangle(30,-2,32,1)
   Line(28,0,30,0)
   Line(32,0,34,0)
   }

  Section(EMTDC)
   {
   BRANCH = "\
#IF Enable==1
#IF LoadType!=4
 #IF ZeroSeq==0
  #IF View==2
     BRA = $IA $Gnd BREAKER 1.0 /
     BLA = $IA $Gnd BREAKER 1.0 /
     BCA = $IA $Gnd BREAKER 1.0 /
  #ELSEIF View==1
     BRA = $I(1) $Gnd BREAKER 1.0 /
     BLA = $I(1) $Gnd BREAKER 1.0 /
     BCA = $I(1) $Gnd BREAKER 1.0 /
     BRB = $I(2) $Gnd BREAKER 1.0 /
     BLB = $I(2) $Gnd BREAKER 1.0 /
     BCB = $I(2) $Gnd BREAKER 1.0 /
     BRC = $I(3) $Gnd BREAKER 1.0 /
     BLC = $I(3) $Gnd BREAKER 1.0 /
     BCC = $I(3) $Gnd BREAKER 1.0 /
  #ELSE
     BRA = $IA $Gnd BREAKER 1.0 /
     BLA = $IA $Gnd BREAKER 1.0 /
     BCA = $IA $Gnd BREAKER 1.0 /
     BRB = $IB $Gnd BREAKER 1.0 /
     BLB = $IB $Gnd BREAKER 1.0 /
     BCB = $IB $Gnd BREAKER 1.0 /
     BRC = $IC $Gnd BREAKER 1.0 /
     BLC = $IC $Gnd BREAKER 1.0 /
     BCC = $IC $Gnd BREAKER 1.0 /
  #ENDIF
 #ELSEIF ZeroSeq<=3
  #IF View==2
     BRA = $IA $Neut BREAKER 1.0 /
     BLA = $IA $Neut BREAKER 1.0 /
     BCA = $IA $Neut BREAKER 1.0 /
  #ELSEIF View==1
     BRA = $I(1) $Neut BREAKER 1.0 /
     BLA = $I(1) $Neut BREAKER 1.0 /
     BCA = $I(1) $Neut BREAKER 1.0 /
     BRB = $I(2) $Neut BREAKER 1.0 /
     BLB = $I(2) $Neut BREAKER 1.0 /
     BCB = $I(2) $Neut BREAKER 1.0 /
     BRC = $I(3) $Neut BREAKER 1.0 /
     BLC = $I(3) $Neut BREAKER 1.0 /
     BCC = $I(3) $Neut BREAKER 1.0 /
  #ELSE
     BRA = $IA $Neut BREAKER 1.0 /
     BLA = $IA $Neut BREAKER 1.0 /
     BCA = $IA $Neut BREAKER 1.0 /
     BRB = $IB $Neut BREAKER 1.0 /
     BLB = $IB $Neut BREAKER 1.0 /
     BCB = $IB $Neut BREAKER 1.0 /
     BRC = $IC $Neut BREAKER 1.0 /
     BLC = $IC $Neut BREAKER 1.0 /
     BCC = $IC $Neut BREAKER 1.0 /
  #ENDIF
 #ENDIF
 #IF ZeroSeq==2
    #IF ((ABS(RN0S)<1.0E-8) && ((ABS(XN0S)<1.0E-8)))
      $Neut $Gnd SOURCE 0.0 /
    #ELSE
     #IF (RN0>0) || (RN0<0)
       $Neut $Gnd $RN0 /
     #ENDIF
     #IF X0S > 0
       $Neut $Gnd 0.0 $LN0 /
     #ELSEIF X0S < 0
       $Neut $Gnd 0.0 0.0 $CN0 /
     #ENDIF
    #ENDIF
 #ENDIF
#ELSE
  #IF View==2
     #IF RP > 0
        BRA = $IA   $Neut $RP /
     #ENDIF
  #ELSEIF View==1
     #IF RP > 0
        BRA = $I(1) $Neut $RP /
        BRB = $I(2) $Neut $RP /
        BRC = $I(3) $Neut $RP /
     #ENDIF
     #IF LP > 0
      BLA = $I(1) $Neut 0.0 $LP /
      BLB = $I(2) $Neut 0.0 $LP /
      BLC = $I(3) $Neut 0.0 $LP /
     #ELSEIF CP > 0
      BCA = $I(1) $Neut 0.0 0.0 $CP /
      BCB = $I(2) $Neut 0.0 0.0 $CP /
      BCC = $I(3) $Neut 0.0 0.0 $CP /
     #ENDIF
  #ELSE
     #IF RP > 0
        BRA = $IA   $Neut $RP /
        BRB = $IB   $Neut $RP /
        BRC = $IC   $Neut $RP /
     #ENDIF
     #IF LP > 0
      BLA = $IA  $Neut 0.0 $LP /
      BLB = $IB  $Neut 0.0 $LP /
      BLC = $IC  $Neut 0.0 $LP /
     #ELSEIF CP > 0
      BCA = $IA  $Neut 0.0 0.0 $CP /
      BCB = $IB  $Neut 0.0 0.0 $CP /
      BCC = $IC  $Neut 0.0 0.0 $CP /
     #ENDIF
  #ENDIF
  #IF (RN0>0) || (RN0<0)
     $Neut $Gnd $RN0 /
  #ENDIF
  #IF X0S > 0
    $Neut $Gnd 0.0 $LN0 /
  #ELSEIF X0S < 0
    $Neut $Gnd 0.0 0.0 $CN0 /
  #ENDIF
#ENDIF
#IF ZeroSeq!=0 || LoadType==4
    $Neut $Gnd 1.0E10 /
    #IF View==2
     $IA $Gnd 1.0E10 /
    #ELSEIF View==1
     $I(1) $Gnd 1.0E10 /
     $I(2) $Gnd 1.0E10 /
     $I(3) $Gnd 1.0E10 /
    #ELSE
     $IA $Gnd 1.0E10 /
     $IB $Gnd 1.0E10 /
     $IC $Gnd 1.0E10 /
    #ENDIF
#ENDIF
#ENDIF"
   DSDYN = "\
#IF Enable==1 && LoadType!=4
#IF View==2
#SUBROUTINE Electranix_1Load - Electranix Single Phase Load Model
 #STORAGE STOR:159
 #STORAGE REAL:63
 #STORAGE INTEGER:6
 #STORAGE COMPLEX:4
#ELSE
#SUBROUTINE Electranix_3Load - Electranix Three Phase Load Model
 #STORAGE STOR:477
 #STORAGE REAL:173
 #STORAGE INTEGER:18
 #STORAGE COMPLEX:12
#ENDIF

#IF View==2
#LOCAL REAL E_Volts
#LOCAL REAL E_Curr
#LOCAL REAL E_CurrLC
#LOCAL REAL E_R
#LOCAL REAL E_L
#LOCAL REAL E_C
#LOCAL REAL E_PA
#LOCAL REAL E_QA
#LOCAL REAL VARR_I
  #IF ( ZeroSeq==0 )
      E_Volts  = VDC($IA,$SS)
  #ELSE
      E_Volts  = VDC($IA,$SS) - VDC($Neut,$SS)
  #ENDIF
      E_Curr   = CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)
      E_CurrLC = CBR($BLA,$SS)+CBR($BCA,$SS)
 #IF (LoadType<=2)
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,$LoadType,$HOLD,E_R,E_L,E_C,E_PA,E_QA)
 #ELSE
      CALL Electranix_1Load(E_Volts,E_Curr,E_CurrLC,$PO,$QO,$FR,$VBO,$VO,$LoadType,1,E_R,E_L,E_C,E_PA,E_QA)
 #ENDIF
      CALL EMTDC_VARRLC10( $BRA , $SS , 0 , VARR_I , E_R , 0.0 )
      CALL EMTDC_VARRLC10( $BLA , $SS , 1 , VARR_I , E_L , 0.0 )
      CALL EMTDC_VARRLC10( $BCA , $SS , 2 , VARR_I , E_C , 0.0 )
#OUTPUT REAL PL    {E_PA}
#OUTPUT REAL QL    {E_QA}
#ELSE
#LOCAL REAL E_VoltsA
#LOCAL REAL E_VoltsB
#LOCAL REAL E_VoltsC
#LOCAL REAL E_CurrA
#LOCAL REAL E_CurrB
#LOCAL REAL E_CurrC
#LOCAL REAL E_CurrLCA
#LOCAL REAL E_CurrLCB
#LOCAL REAL E_CurrLCC
#LOCAL REAL E_RA
#LOCAL REAL E_LA
#LOCAL REAL E_CA
#LOCAL REAL E_RB
#LOCAL REAL E_LB
#LOCAL REAL E_CB
#LOCAL REAL E_RC
#LOCAL REAL E_LC
#LOCAL REAL E_CC
#LOCAL REAL E_P
#LOCAL REAL E_Q
#LOCAL REAL VARR_I
! LoadS
 #IF View==1
  #IF ( ZeroSeq==0 )
      E_VoltsA  = VDC($I(1),$SS)
      E_VoltsB  = VDC($I(2),$SS)
      E_VoltsC  = VDC($I(3),$SS)
  #ELSE
      E_VoltsA  = VDC($I(1),$SS) - VDC($Neut,$SS)
      E_VoltsB  = VDC($I(2),$SS) - VDC($Neut,$SS)
      E_VoltsC  = VDC($I(3),$SS) - VDC($Neut,$SS)
  #ENDIF
 #ELSE
  #IF ( ZeroSeq==0 )
      E_VoltsA  = VDC($IA,$SS)
      E_VoltsB  = VDC($IB,$SS)
      E_VoltsC  = VDC($IC,$SS)
  #ELSE
      E_VoltsA  = VDC($IA,$SS) - VDC($Neut,$SS)
      E_VoltsB  = VDC($IB,$SS) - VDC($Neut,$SS)
      E_VoltsC  = VDC($IC,$SS) - VDC($Neut,$SS)
  #ENDIF
 #ENDIF
      E_CurrA   = CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)
      E_CurrLCA = CBR($BLA,$SS)+CBR($BCA,$SS)
      E_CurrB   = CBR($BRB,$SS)+CBR($BLB,$SS)+CBR($BCB,$SS)
      E_CurrLCB = CBR($BLB,$SS)+CBR($BCB,$SS)
      E_CurrC   = CBR($BRC,$SS)+CBR($BLC,$SS)+CBR($BCC,$SS)
      E_CurrLCC = CBR($BLC,$SS)+CBR($BCC,$SS)
 #IF (LoadType<=2)
      CALL Electranix_3Load(E_VoltsA,E_VoltsB,E_VoltsC,E_CurrA,E_CurrB,E_CurrC,
     & E_CurrLCA,E_CurrLCB,E_CurrLCC,$PO,$QO,$FR,$VBO,$VO,$LoadType,$HOLD,
     & E_RA,E_LA,E_CA,E_RB,E_LB,E_CB,E_RC,E_LC,E_CC,E_P,E_Q)
 #ELSE
      CALL Electranix_3Load(E_VoltsA,E_VoltsB,E_VoltsC,E_CurrA,E_CurrB,E_CurrC,
     & E_CurrLCA,E_CurrLCB,E_CurrLCC,$PO,$QO,$FR,$VBO,$VO,$LoadType,1,
     & E_RA,E_LA,E_CA,E_RB,E_LB,E_CB,E_RC,E_LC,E_CC,E_P,E_Q)
 #ENDIF
      CALL EMTDC_VARRLC10( $BRA , $SS , 0 , VARR_I , E_RA , 0.0 )
      CALL EMTDC_VARRLC10( $BLA , $SS , 1 , VARR_I , E_LA , 0.0 )
      CALL EMTDC_VARRLC10( $BCA , $SS , 2 , VARR_I , E_CA , 0.0 )
      CALL EMTDC_VARRLC10( $BRB , $SS , 0 , VARR_I , E_RB , 0.0 )
      CALL EMTDC_VARRLC10( $BLB , $SS , 1 , VARR_I , E_LB , 0.0 )
      CALL EMTDC_VARRLC10( $BCB , $SS , 2 , VARR_I , E_CB , 0.0 )
      CALL EMTDC_VARRLC10( $BRC , $SS , 0 , VARR_I , E_RC , 0.0 )
      CALL EMTDC_VARRLC10( $BLC , $SS , 1 , VARR_I , E_LC , 0.0 )
      CALL EMTDC_VARRLC10( $BCC , $SS , 2 , VARR_I , E_CC , 0.0 )
#ENDIF
 #OUTPUT REAL PL    {E_P}
 #OUTPUT REAL QL    {E_Q}

      IF ( TIMEZERO ) THEN
#LOCAL REAL PXINIT
#LOCAL REAL QXINIT
         IF ( $LoadType .EQ. 0) THEN
            PXINIT = $PO
            QXINIT = $QO
         ELSEIF ( $LoadType .EQ. 1) THEN
            PXINIT = $PO*$VO
            QXINIT = $QO*$VO
         ELSEIF ( $LoadType .EQ. 4) THEN
            PXINIT = 0.0
            QXINIT = 0.0
         ELSE
            PXINIT = $PO*$VO*$VO
            QXINIT = $QO*$VO*$VO
         ENDIF
         CALL PSCAD_AGRG($#Component,PXINIT,\"Pdisplay\")
         CALL PSCAD_AGRG($#Component,QXINIT,\"Qdisplay\")
      ELSEIF ( UPDATE_AG ) THEN
         CALL PSCAD_AGRG($#Component,E_P,\"Pdisplay\")
         CALL PSCAD_AGRG($#Component,E_Q,\"Qdisplay\")
      ENDIF

#ELSE
 #OUTPUT REAL PL    {0.0}
 #OUTPUT REAL QL    {0.0}
#ENDIF"
   HELP = "E-TRAN_Model_Help\\E-TRAN008.htm#SubChapter_ETRAN_Loads"
   Checks = "\
#IF Enable==1
Warning Warning in Load Data - Base Voltage must be > 0 : !(VBO<=0.0)
Warning Warning in Load Data - Numerical instabilities are possible when load dynamics are used when zero sequence impedances are less than the positive sequence > 0 : !((LoadType<=2)&&(ZeroSeq==2))
ERROR ERROR in Load Data - Negative Power Loads Not Allowed! : !(PO<0.0)
ERROR ERROR in Load Data - For zero seq loads with P and Q = 0.0, use Pure Zero Sequence load type! : !((PO<=0.0)&&((QO<1.0E-8)&&(QO>-1.0E-8))&&(ZeroSeq==2)&&(LoadType!=4))
ERROR ERROR in Load Data - A Zero Sequence Single Phase Load is not allowed! : !((View==2)&&(LoadType==4))
ERROR ERROR in Load Data - Zero Sequence Load Resistance cannot be negative! : !(((ZeroSeq==2)||(LoadType==4))&&(R0pu<0.0))
#ENDIF"
   DSOUT = "\
#IF Enable==1
#IF LoadType!=4
 #IF View==2
  #OUTPUT REAL INAME  1 {CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)}
 #ELSE
  #OUTPUT REAL INAME  3 {CBR($BRA,$SS)+CBR($BLA,$SS)+CBR($BCA,$SS)} {CBR($BRB,$SS)+CBR($BLB,$SS)+CBR($BCB,$SS)} {CBR($BRC,$SS)+CBR($BLC,$SS)+CBR($BCC,$SS)}
 #ENDIF
#ELSE
 #IF View==2
  #LOCAL REAL IBR_A
      IBR_A = 0.0
     #IF RP > 0
        IBR_A = IBR_A + CBR($BRA,$SS)
     #ENDIF
     #IF LP > 0
        IBR_A = IBR_A + CBR($BLA,$SS)
     #ELSEIF CP > 0
        IBR_A = IBR_A + CBR($BCA,$SS)
     #ENDIF
  #OUTPUT REAL INAME  1 {IBR_A}
 #ELSE
  #LOCAL REAL IBR_A
  #LOCAL REAL IBR_B
  #LOCAL REAL IBR_C
      IBR_A = 0.0
      IBR_B = 0.0
      IBR_C = 0.0
     #IF RP > 0
        IBR_A = IBR_A + CBR($BRA,$SS)
        IBR_B = IBR_B + CBR($BRB,$SS)
        IBR_C = IBR_C + CBR($BRC,$SS)
     #ENDIF
     #IF LP > 0
        IBR_A = IBR_A + CBR($BLA,$SS)
        IBR_B = IBR_B + CBR($BLB,$SS)
        IBR_C = IBR_C + CBR($BLC,$SS)
     #ELSEIF CP > 0
        IBR_A = IBR_A + CBR($BCA,$SS)
        IBR_B = IBR_B + CBR($BCB,$SS)
        IBR_C = IBR_C + CBR($BCC,$SS)
     #ENDIF
  #OUTPUT REAL INAME  3 {IBR_A} {IBR_B} {IBR_C}
 #ENDIF
#ENDIF
#ELSE
 #IF View==2
  #OUTPUT REAL INAME  1 {0.0}
 #ELSE
  #OUTPUT REAL INAME  3 {0.0} {0.0} {0.0}
 #ENDIF
#ENDIF"
   COMPUTATIONS = "\
#IF ZeroSeq==2 || LoadType==4
REAL W     = 2*PI*FR
REAL ZBASE = (VBO*VBO)/MVA
REAL YBASE = 1.0 / ZBASE

#IF ( LoadType!=4 )
  REAL S = SQRT(PO*PO+QO*QO)

#IF ( PO >= 1.0E-8 )
 REAL ANG = R2PA(PO,QO)*PI/180.0
#ELSE
 #IF ( QO >=0 )
  REAL ANG = 90.0*PI/180.0
 #ELSE
  REAL ANG = -90.0*PI/180.0
 #ENDIF
#ENDIF
#IF PO>0
 REAL RPS = VBO*VBO*COS(ANG)/S
#ELSE
 #IF ((QO>0)||(QO<0))
    REAL RPS = 0.0
 #ELSE
    REAL RPS = 1.0E8
 #ENDIF
#ENDIF
#IF ((QO>0)||(QO<0))
 REAL XPS = VBO*VBO*SIN(ANG)/S
#ELSE
 REAL XPS = 0.0
#ENDIF


#ELSE

 #IF (R0pu>0)
    REAL RPS = 1.0E6
 #ELSE
    REAL RPS = 0.0
 #ENDIF
 #IF (X0pu>0)
    REAL XPS = 1.0E6
 #ELSEIF (X0pu<0)
    REAL XPS = -1.0E6
 #ELSE
    REAL XPS = 0.0
 #ENDIF
 REAL ZPS = SQRT(RPS*RPS+XPS*XPS)
 REAL ANGZP = R2PA(RPS,XPS)*PI/180.0
 REAL COSANGZP = COS(ANGZP)
 REAL SINANGZP = SIN(ANGZP)
 REAL ABSCOSP = ABS(COSANGZP)
 REAL ABSSINP = ABS(SINANGZP)
 REAL RP = ( ABSCOSP>1.0E-8 && (ZPS>=1.0E-8) ) ? 1.0/((1.0/ZPS)*COSANGZP) : 0.0
 REAL XP = ( ABSSINP>1.0E-8 && (ZPS>=1.0E-8) ) ? 1.0/((1.0/ZPS)*SINANGZP) : 0.0
 REAL LP = XP>0 ? XP/W          : 0.0
 REAL CP = XP<0 ? -1.0E6/(XP*W) : 0.0
#ENDIF
REAL ABSRPS = ABS(RPS)
REAL ABSXPS = ABS(XPS)
REAL R0S  = R0pu*ZBase
REAL X0S  = X0pu*ZBase
REAL RN0S = (R0S-RPS)/3
REAL XN0S = (X0S-XPS)/3
REAL ZN0S = SQRT(RN0S*RN0S+XN0S*XN0S)
REAL ABSRN0S = ABS(RN0S)
REAL ANGZ = R2PA(RN0S,XN0S)*PI/180.0
REAL COSANGZ = COS(ANGZ)
REAL SINANGZ = SIN(ANGZ)
REAL ABSCOS = ABS(COSANGZ)
REAL ABSSIN = ABS(SINANGZ)
REAL RN0 = ( ABSCOS>1.0E-8 && (ZN0S>=1.0E-8) ) ? 1.0/((1.0/ZN0S)*COSANGZ) : 0.0
REAL XN0 = ( ABSSIN>1.0E-8 && (ZN0S>=1.0E-8) ) ? 1.0/((1.0/ZN0S)*SINANGZ) : 0.0
REAL LN0 = X0S>0 ? XN0/W          : 0.0
REAL CN0 = X0S<0 ? -1.0E6/(XN0*W) : 0.0
#ENDIF"
   }
  Section(Help)
   {
   FlyBy = "\

Electranix - Single Phase Load Model

Load Model Features:
     - Dynamically computes load RLC based on fundamental frequency RMS voltage
     - Changes RLC values on current zeroes using VARRLC10 model
     - Load impedances can be frozen using a 0 or 1 \"Hold\" signal
Modes of Operation:
     - Constant P,Q Power
     - Constant Current
     - Constant Impedance (R,Xl or Xc is constant)
     - Constant RLC (R, L or C is constant)
:IA
Single Phase Electrical Connection"
   }
  }
 Component("Electranix_Scale_2")
  {
  Desc = "Parallel 3P, 2W ScalingTransformer_Side2!"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Text("Name",6,2,202,12,2)
     {
     Desc = "Transformer Name"
     Def = "T32"
     Len = 15
     }
    Input("Tmva",6,16,202,12,2)
     {
     Desc = "3 Phase Transformer MVA"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 1e-006
     }
    Input("f",6,30,202,12,2)
     {
     Desc = "Base operation frequency"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0.0001
     }
    Choice("YD1",6,44,202,11,2)
     {
     Style = 0
     Desc = "Winding #1 Type"
     Def = "0"
     Len = 15
     *0 = "Y"
     *1 = "Delta"
     }
    Choice("YD2",6,58,202,11,2)
     {
     Style = 0
     Desc = "Winding #2 Type"
     Def = "1"
     Len = 15
     *0 = "Y"
     *1 = "Delta"
     }
    Choice("Lead",6,72,202,11,2)
     {
     Style = 0
     Desc = "Delta Lags or Leads Y"
     Def = "1"
     Len = 15
     Cond = "YD1 != YD2"
     *1 = "Lags"
     *2 = "Leads"
     }
    Input("Xl",6,86,202,12,2)
     {
     Desc = "Positive sequence leakage reactance"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Choice("Ideal",6,100,202,11,2)
     {
     Style = 0
     Desc = "Ideal Transformer Model"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    Input("NLL",6,114,202,12,2)
     {
     Desc = "No load losses"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Input("CuL",6,128,202,12,2)
     {
     Desc = "Copper losses"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Choice("Tap",6,142,202,11,2)
     {
     Style = 0
     Desc = "Tap changer on winding"
     Def = "0"
     Len = 15
     Cond = "(true)"
     *0 = "None"
     *1 = "#1"
     *2 = "#2"
     }
    Choice("View",6,156,202,11,2)
     {
     Style = 0
     Desc = "Graphics Display"
     Def = "0"
     Len = 24
     Cond = "(true)"
     *0 = "3 phase view"
     *1 = "Single line (circles)"
     *2 = "Single line (windings)"
     }
    Choice("Dtls",6,170,202,11,2)
     {
     Style = 0
     Desc = "Display Details?"
     Def = "0"
     Len = 15
     Cond = "View!=0"
     *0 = "No"
     *1 = "Yes"
     }
    Input("Port",5,188,201,12,2)
     {
     Desc = "TCP/IP Port (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    }
   Category("Winding Voltages")
    {
    Input("V2",5,20,201,12,2)
     {
     Desc = "Winding 2 Line to Line voltage (RMS)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    Input("V1",5,4,201,12,2)
     {
     Desc = "Winding 1 Line to Line voltage (RMS)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    }
   Category("Saturation")
    {
    Input("Im1",6,86,202,12,2)
     {
     Desc = "Magnetizing current"
     Def = "0.4"
     Data = Real
     Unit = "%"
     Len = 15
     Min = 0.0001
     Max = 1000
     }
    Input("Txk",6,72,202,12,2)
     {
     Desc = "Time to release flux clipping"
     Def = "0.1"
     Data = Real
     Unit = "s"
     Len = 15
     Min = 0
     Max = 1e+006
     }
    Input("Xknee",6,58,202,12,2)
     {
     Desc = "Knee voltage"
     Def = "1.25"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     }
    Input("Tdc",6,44,202,12,2)
     {
     Desc = "In rush decay time constant"
     Def = "1.0"
     Data = Real
     Unit = "s"
     Len = 15
     Min = -100
     }
    Input("Xair",6,30,202,12,2)
     {
     Desc = "Air core reactance"
     Def = "0.2"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0.001
     Max = 10
     }
    Choice("Sat",6,16,202,11,2)
     {
     Style = 0
     Desc = "Saturation Placed on Winding"
     Def = "1"
     Len = 15
     *1 = "#1"
     *2 = "#2"
     }
    Choice("Enab",6,2,202,12,2)
     {
     Style = 0
     Desc = "Saturation Enabled"
     Def = "0"
     Len = 15
     *0 = "No"
     *1 = "Yes"
     }
    }
   Category("Winding 1 Line Currents")
    {
    Text("ILC1",5,36,201,12,2)
     {
     Desc = "Name for Phase C Current (+in,kA)"
     Len = 15
     }
    Text("ILB1",5,20,201,12,2)
     {
     Desc = "Name for Phase B Current (+in,kA)"
     Len = 15
     }
    Text("ILA1",5,4,201,12,2)
     {
     Desc = "Name for Phase A Current (+in,kA)"
     Len = 15
     }
    }
   Category("Winding 1 Delta Currents")
    {
    Cond = "(YD1)"
    Text("ICA1",5,36,201,12,2)
     {
     Desc = "Name for C->A Winding Current (kA)"
     Len = 15
     }
    Text("IBC1",5,20,201,12,2)
     {
     Desc = "Name for B->C Winding Current (kA)"
     Len = 15
     }
    Text("IAB1",5,4,201,12,2)
     {
     Desc = "Name for A->B Winding Current (kA)"
     Len = 15
     }
    }
   Category("Winding 2 Line Currents")
    {
    Text("ILC2",5,36,201,12,2)
     {
     Desc = "Name for Phase C Current (+in,kA)"
     Len = 15
     }
    Text("ILB2",5,20,201,12,2)
     {
     Desc = "Name for Phase B Current (+in,kA)"
     Len = 15
     }
    Text("ILA2",5,4,201,12,2)
     {
     Desc = "Name for Phase A Current (+in,kA)"
     Len = 15
     }
    }
   Category("Winding 2 Delta Currents")
    {
    Cond = "(YD2)"
    Text("ICA2",5,36,201,12,2)
     {
     Desc = "Name for C->A Winding Current (kA)"
     Len = 15
     }
    Text("IBC2",5,20,201,12,2)
     {
     Desc = "Name for B->C Winding Current (kA)"
     Len = 15
     }
    Text("IAB2",5,4,201,12,2)
     {
     Desc = "Name for A->B Winding Current (kA)"
     Len = 15
     }
    }
   Category("Monitoring of Flux and Magn Current")
    {
    Cond = "((Sat==1 ? YD1 : YD2) == 0)"
    Text("FLXC",5,84,201,12,2)
     {
     Desc = "Name for Phase C Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXB",5,68,201,12,2)
     {
     Desc = "Name for Phase B Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXA",5,52,201,12,2)
     {
     Desc = "Name for Phase A Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("IMC",5,36,201,12,2)
     {
     Desc = "Name for Phase C Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMB",5,20,201,12,2)
     {
     Desc = "Name for Phase B Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMA",5,4,201,12,2)
     {
     Desc = "Name for Phase A Magn. Curr. (kA)"
     Len = 15
     }
    }
   Category("Monitoring of Flux and Magn Current:2")
    {
    Cond = "((Sat==1 ? YD1 : YD2) == 1)"
    Text("FLXCA",5,84,201,12,2)
     {
     Desc = "Name for Phase C->A Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXBC",5,68,201,12,2)
     {
     Desc = "Name for Phase B->C Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("FLXAB",5,52,201,12,2)
     {
     Desc = "Name for Phase A->B Flux Linkage (kWb-N)"
     Len = 15
     }
    Text("IMCA",5,36,201,12,2)
     {
     Desc = "Name for Phase C->A Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMBC",5,20,201,12,2)
     {
     Desc = "Name for Phase B->C Magn. Curr. (kA)"
     Len = 15
     }
    Text("IMAB",5,4,201,12,2)
     {
     Desc = "Name for Phase A->B Magn. Curr. (kA)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("G1",-18,36)
    {
    Cond = "(YD1==0)&&(View!=0)"
    }
   Input("TapI",-54,-18)
    {
    Cond = "(Tap)&&(View!=0)"
    Type = Real
    }
   Input("TapI",-18,-72)
    {
    Cond = "(Tap)&&(View==0)"
    Type = Real
    }
   Electrical("G2",0,36)
    {
    Cond = "(YD2==0)&&(View!=0)"
    }
   Electrical("G2",0,0)
    {
    Cond = "(YD2==1)"
    Type = Ground
    }
   Electrical("G1",0,0)
    {
    Cond = "(YD1==1)"
    Type = Ground
    }
   Electrical("G1",-18,72)
    {
    Cond = "(YD1==0)&&(View==0)"
    }
   Electrical("X2",18,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X1",-36,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X1",-36,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("X2",18,0)
    {
    Cond = "(View!=0)&&(CuL>0)"
    Dim  = [3]
    }
   Electrical("XA1",-18,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC1",-18,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA1",-18,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC1",-18,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA2",72,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB2",72,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC2",72,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XC2",72,36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XA2",72,-36)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB2",72,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("G2",36,72)
    {
    Cond = "(YD2==0)&&(View==0)"
    }
   Electrical("C1",-18,36)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("C1",-36,36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("C2",72,36)
    {
    Cond = "(View==0)&&(YD2==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("B2",72,0)
    {
    Cond = "(View==0)&&(YD2==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("A2",72,-36)
    {
    Cond = "(View==0)&&(YD2==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("A1",-36,-36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("A1",-18,-36)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("C2",90,36)
    {
    Cond = "(View==0)&&(YD2==1||CuL<=0.0)"
    }
   Electrical("A2",90,-36)
    {
    Cond = "(View==0)&&(YD2==1||CuL<=0.0)"
    }
   Electrical("B2",90,0)
    {
    Cond = "(View==0)&&(YD2==1||CuL<=0.0)"
    }
   Electrical("N1",-18,0)
    {
    Cond = "(View!=0)&&(YD1==1||CuL<=0.0)"
    Dim  = [3]
    }
   Electrical("N2",36,0)
    {
    Cond = "(View!=0)&&(YD2==1||CuL<=0.0)"
    Dim  = [3]
    }
   Electrical("N1",-36,-18)
    {
    Cond = "(View!=0)&&(YD1==0)&&(CuL>0.0)"
    Dim  = [3]
    }
   Electrical("N2",36,0)
    {
    Cond = "(View!=0)&&(YD2==0)&&(CuL>0.0)"
    Dim  = [3]
    }
   Electrical("XB1",-18,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("XB1",-18,0)
    {
    Cond = "(View==0)&&(CuL>0)"
    }
   Electrical("B1",-18,0)
    {
    Cond = "(View==0)&&(YD1==1||CuL<=0.0)"
    }
   Electrical("B1",-36,0)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("N1",-36,-18)
    {
    Cond = "(View!=0)&&(YD1==0)&&(CuL>0.0)"
    Dim  = [3]
    }
   Electrical("A1",-36,-36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("B1",-36,0)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Electrical("C1",-36,36)
    {
    Cond = "(View==0)&&(YD1==0)&&(CuL>0.0)"
    Type = Removable
    }
   Input("NINF",0,18)
    {
    Type = Integer
    }
   Output("NOUTF",0,18)
    {
    Type = Integer
    }
   }

  Graphics = 
   {
   Pen(,,0.6)
   Cond = "(View==1)"
   Ellipse(-40,-18,-4,18)
   Pen(,,0.2)
   Cond = "(View==0)"
   Line(90,-36,72,-36)
   Line(90,0,72,0)
   Line(90,36,72,36)
   Cond = "(YD1==0)&&(View==0)"
   Line(-4,-5,-4,16)
   Cond = "(YD2==0)&&(View==0)"
   Line(22,-5,4,-16)
   Line(22,-5,22,16)
   Cond = "(YD2!=0)&&(View==0)"
   Line(40,-16,58,16)
   Line(58,16,22,16)
   Line(22,16,40,-16)
   Cond = "(YD1!=0)&&(View==0)"
   Line(-4,16,-40,16)
   Line(-40,16,-22,-16)
   Line(-22,-16,-4,16)
   Cond = "(YD1==0)&&(View==0)"
   Line(-18,49,-18,72)
   Cond = "(YD2==0)&&(View==0)"
   Line(36,54,36,72)
   Cond = "(YD1==0)&&(View==0)"
   Line(-4,-5,-22,-16)
   Line(-4,-5,14,-16)
   Cond = "(YD1==0)&&(View==1)"
   Line(-24,23,-21,21)
   Line(-24,23,-27,21)
   Line(-24,23,-24,27)
   Cond = "(YD1!=0)&&(View==1)"
   Line(-24,20,-21,27)
   Line(-27,27,-24,20)
   Line(-21,27,-27,27)
   Cond = "(YD2!=0)&&(View==1)"
   Line(3,27,6,20)
   Line(9,27,3,27)
   Line(6,20,9,27)
   Cond = "(YD2==0)&&(View==1)"
   Line(6,23,3,21)
   Line(6,23,9,21)
   Line(6,23,6,27)
   Pen(,,0.6)
   Cond = "(View==1)"
   Ellipse(-15,-18,21,18)
   Line(21,0,36,0)
   Pen(,,0.2)
   Line(28,3,33,-4)
   Cond = "View==1"
   Line(22,3,27,-4)
   Line(25,3,30,-4)
   Cond = "(YD1==0)&&(View==1)"
   Line(-18,16,-18,36)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-7,-18,1,-9,-450,-180)
   Arc(-19,-9,-10,0,-270,-180)
   Arc(-7,-9,1,0,-450,-180)
   Line(-3,0,36,0)
   Pen(,,0.2)
   Cond = "(YD1!=0)&&(View==2)"
   Line(-16,27,-13,21)
   Line(-10,27,-16,27)
   Line(-13,21,-10,27)
   Cond = "(YD1==0)&&(View==2)"
   Line(-13,23,-16,21)
   Line(-13,23,-10,21)
   Line(-13,23,-13,27)
   Cond = "(YD2!=0)&&(View==2)"
   Line(-7,27,-4,21)
   Line(-4,21,-1,27)
   Line(-1,27,-7,27)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-7,21)
   Cond = "(YD2==0)&&(View==1)"
   Line(0,18,0,36)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-1,21)
   Line(0,18,0,36)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-19,-18,-10,-9,-270,-180)
   Pen(,,0.2)
   Cond = "(YD1==0)&&(View==2)"
   Line(-18,18,-18,36)
   Cond = "(YD2==0)&&(View==2)"
   Line(-4,23,-4,27)
   Cond = "View==2"
   Line(-10,24,-7,24)
   Pen(,,0.6)
   Arc(-7,0,1,9,-450,-180)
   Pen(,,0.2)
   Cond = "(YD1==0)&&(View==2)"
   Line(-15,18,-18,18)
   Pen(,,0.6)
   Cond = "View==2"
   Arc(-19,9,-10,18,-270,-180)
   Arc(-7,9,1,18,-450,-180)
   Arc(-19,0,-10,9,-270,-180)
   Pen(,,0.2)
   Cond = "(YD2==0)&&(View==2)"
   Line(0,18,-3,18)
   Pen(,,0.6)
   Cond = "(tap!=0)&&(View==2)"
   Line(-9,-12,-7,-22)
   Line(-12,-13,-7,-22)
   Line(-21,19,-7,-22)
   Cond = "(tap!=0)&&(View==1)"
   Line(-24,-12,-25,-22)
   Line(-21,-13,-25,-22)
   Line(-12,19,-25,-22)
   Pen(,,0.2)
   Cond = "(tap!=0)&&(View!=0)"
   Line(-54,-18,-42,-18)
   Cond = "(tap!=0)&&(View==1)"
   Line(-42,-18,-19,-1)
   Cond = "(tap!=0)&&(View==2)"
   Line(-42,-18,-15,-4)
   Cond = "(Tap!=0)&&(View==0)"
   Line(-18,-54,-18,-72)
   Line(-23,-59,-18,-54)
   Line(-18,-54,-12,-59)
   Cond = "(View==0)"
   Rectangle(-54,-54,72,50)
   Cond = "(YD2==0)&&(View==0)"
   Line(22,-5,40,-16)
   Cond = "(View==0)"
   Text(81,-37,"A")
   Text(81,-1,"B")
   Text(81,34,"C")
   Text(40,47,"%V2")
   Text(58,6,"#2")
   Text(-22,6,"#1")
   Text(-4,33,"%V1")
   Text(7,-23,"%Tmva")
   Cond = "(View==1)"
   Text(-25,6,"#1")
   Text(6,6,"#2")
   Cond = "(View==2)"
   Text(-24,-7,"#1")
   Text(7,-7,"#2")
   Cond = "(View!=0)&&(Dtls==1)"
   Text(20,-41,"%Tmva")
   Text(28,-19,"%V1 / %V2")
   Cond = "(Tap!=0)&&(View==0)"
   Text(-7,-57,"Tap")
   Font(,,Right)
   Cond = "(View==0)"
   Text(26,-42,"scalar model 2")
   Pen(,,0.6)
   Cond = "View==2"
   Line(-17,-18,-14,-18)
   Font(,,Centre)
   Cond = "(View==2)"
   Text(-23,12,"E")
   Font(,,Left)
   Text(-13,-30,"Scaling 2")
   Pen(,,0.2)
   Cond = "true"
   Line(-39,-1,-60,-1)
   Line(-39,3,-60,3)
   Line(-55,-6,-63,1)
   Line(-55,8,-63,1)
   Font(,,Centre)
   Text(-50,18,"$Port")
   Text(-41,-17,"E+")
   }

  Section(EMTDC)
   {
   Computations = "\
INTEGER NCW = Ideal ? -2 : 2
REAL    MVA = Tmva/3
REAL    XL1 = xl*0.5
REAL    V_1 = YD1 ? V1 : V1/sqrt(3.0)
REAL    V_2 = YD2 ? V2 : V2/sqrt(3.0)
REAL    I_m1= Im1*0.01
REAL    I_m2= I_m1
REAL    w   = 2*pi*f
REAL    ib1 = MVA/V_1
REAL    zb1 = V_1/ib1
REAL    ib2 = MVA/V_2
REAL    tr  = V_1/V_2
REAL    L1  = Ideal==1 ? w/(XL1*zb1) : V_1/(w*I_m1*ib1)
REAL    L2  = Ideal==1 ? tr*tr*L1   : V_2/(w*I_m2*ib2)
REAL    L12 = Ideal==1 ? -tr*L1     : (1-XL1*zb1/(2*w*L1))*sqrt(L1*L2)
REAL    Rd1 = NLL ? 2.0*V_1*V_1/(MVA*NLL) : 0
REAL    Rd2 = NLL ? 2.0*V_2*V_2/(MVA*NLL) : 0
REAL    Rc1 = CuL>0.0 ? 0.5*CuL*MVA/(ib1*ib1) : 0
REAL    Rc2 = CuL>0.0 ? 0.5*CuL*MVA/(ib2*ib2) : 0
INTEGER SW  = Enab ? Sat : 0"
   Branch = "\
#IF CuL>0
 #IF View==0
$A1 $XA1     $Rc1 0.0 0.0
$B1 $XB1     $Rc1 0.0 0.0
$C1 $XC1     $Rc1 0.0 0.0
$A2 $XA2     $Rc2 0.0 0.0
$B2 $XB2     $Rc2 0.0 0.0
$C2 $XC2     $Rc2 0.0 0.0
 #ELSE
$N1(1) $X1(1)     $Rc1 0.0 0.0
$N1(2) $X1(2)     $Rc1 0.0 0.0
$N1(3) $X1(3)     $Rc1 0.0 0.0
$N2(1) $X2(1)     $Rc2 0.0 0.0
$N2(2) $X2(2)     $Rc2 0.0 0.0
$N2(3) $X2(3)     $Rc2 0.0 0.0
 #ENDIF
 #IF NLL>0
  #IF View==0
#CASE YD1*Lead {$XA1 $G1     $Rd1 0.0 0.0} {$XA1 $B1     $Rd1 0.0 0.0} {$XA1 $C1     $Rd1 0.0 0.0}
#CASE YD1*Lead {$XB1 $G1     $Rd1 0.0 0.0} {$XB1 $C1     $Rd1 0.0 0.0} {$XB1 $A1     $Rd1 0.0 0.0}
#CASE YD1*Lead {$XC1 $G1     $Rd1 0.0 0.0} {$XC1 $A1     $Rd1 0.0 0.0} {$XC1 $B1     $Rd1 0.0 0.0}
#CASE YD2*Lead {$XA2 $G2     $Rd2 0.0 0.0} {$XA2 $B2     $Rd2 0.0 0.0} {$XA2 $C2     $Rd2 0.0 0.0}
#CASE YD2*Lead {$XB2 $G2     $Rd2 0.0 0.0} {$XB2 $C2     $Rd2 0.0 0.0} {$XB2 $A2     $Rd2 0.0 0.0}
#CASE YD2*Lead {$XC2 $G2     $Rd2 0.0 0.0} {$XC2 $A2     $Rd2 0.0 0.0} {$XC2 $B2     $Rd2 0.0 0.0}
  #ELSE
#CASE YD1*Lead {$X1(1) $G1     $Rd1 0.0 0.0} {$X1(1) $N1(2)     $Rd1 0.0 0.0} {$X1(1) $N1(3)     $Rd1 0.0 0.0}
#CASE YD1*Lead {$X1(2) $G1     $Rd1 0.0 0.0} {$X1(2) $N1(3)     $Rd1 0.0 0.0} {$X1(2) $N1(1)     $Rd1 0.0 0.0}
#CASE YD1*Lead {$X1(3) $G1     $Rd1 0.0 0.0} {$X1(3) $N1(1)     $Rd1 0.0 0.0} {$X1(3) $N1(2)     $Rd1 0.0 0.0}
#CASE YD2*Lead {$X2(1) $G2     $Rd2 0.0 0.0} {$X2(1) $N2(2)     $Rd2 0.0 0.0} {$X2(1) $N2(3)     $Rd2 0.0 0.0}
#CASE YD2*Lead {$X2(2) $G2     $Rd2 0.0 0.0} {$X2(2) $N2(3)     $Rd2 0.0 0.0} {$X2(2) $N2(1)     $Rd2 0.0 0.0}
#CASE YD2*Lead {$X2(3) $G2     $Rd2 0.0 0.0} {$X2(3) $N2(1)     $Rd2 0.0 0.0} {$X2(3) $N2(2)     $Rd2 0.0 0.0}
  #ENDIF
 #ENDIF
#ELSE 
 #IF NLL>0
  #IF View==0
#CASE YD1 {$A1 $G1     $Rd1 0.0 0.0} {$A1 $B1     $Rd1 0.0 0.0}
#CASE YD1 {$B1 $G1     $Rd1 0.0 0.0} {$B1 $C1     $Rd1 0.0 0.0}
#CASE YD1 {$C1 $G1     $Rd1 0.0 0.0} {$C1 $A1     $Rd1 0.0 0.0}
#CASE YD2 {$A2 $G2     $Rd2 0.0 0.0} {$A2 $B2     $Rd2 0.0 0.0}
#CASE YD2 {$B2 $G2     $Rd2 0.0 0.0} {$B2 $C2     $Rd2 0.0 0.0}
#CASE YD2 {$C2 $G2     $Rd2 0.0 0.0} {$C2 $A2     $Rd2 0.0 0.0}
  #ELSE
#CASE YD1 {$N1(1) $G1     $Rd1 0.0 0.0} {$N1(1) $N1(2)     $Rd1 0.0 0.0}
#CASE YD1 {$N1(2) $G1     $Rd1 0.0 0.0} {$N1(2) $N1(3)     $Rd1 0.0 0.0}
#CASE YD1 {$N1(3) $G1     $Rd1 0.0 0.0} {$N1(3) $N1(1)     $Rd1 0.0 0.0}
#CASE YD2 {$N2(1) $G2     $Rd2 0.0 0.0} {$N2(1) $N2(2)     $Rd2 0.0 0.0}
#CASE YD2 {$N2(2) $G2     $Rd2 0.0 0.0} {$N2(2) $N2(3)     $Rd2 0.0 0.0}
#CASE YD2 {$N2(3) $G2     $Rd2 0.0 0.0} {$N2(3) $N2(1)     $Rd2 0.0 0.0}
  #ENDIF
 #ENDIF
#ENDIF"
   Transformers = "\
#TRANSFORMERS 3
#WINDINGS 2
C   3 Phase, 2 Winding Transformer
C*     Name: %Name   Tmva: $Tmva MVA,    Freq: $f Hz,   V1: $V1 kV,      V2: $V2 kV
C*     Imag1: $I_m1 p.u.,    Imag2: $I_m2 p.u.,   Xl: $Xl p.u.
C*     Sat: $SW ,      ~
#IF SW
~      Xair: $Xair p.u.,     Knee: $Xknee p.u.,   Tdc: $Tdc sec
#ENDIF
  $NCW / Number of windings...
#IF CuL>0
 #IF View==0
#CASE YD1*Lead  {  $XA1 $G1 ~}  {  $XA1 $B1 ~}  {  $XA1 $C1 ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $XA2 $G2 ~}  {  $XA2 $B2 ~}  {  $XA2 $C2 ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $XB1 $G1 /}  {  $XB1 $C1 /}  {  $XB1 $A1 /}
#CASE YD2*Lead  {  $XB2 $G2 /}  {  $XB2 $C2 /}  {  $XB2 $A2 /}
 888 /
#CASE YD1*Lead  {  $XC1 $G1 /}  {  $XC1 $A1 /}  {  $XC1 $B1 /}
#CASE YD2*Lead  {  $XC2 $G2 /}  {  $XC2 $A2 /}  {  $XC2 $B2 /}
 #ELSE
#CASE YD1*Lead  {  $X1(1) $G1 ~}  {  $X1(1) $N1(2) ~}  {  $X1(1) $N1(3) ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $X2(1) $G2 ~}  {  $X2(1) $N2(2) ~}  {  $X2(1) $N2(3) ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $X1(2) $G1 /}  {  $X1(2) $N1(3) /}  {  $X1(2) $N1(1) /}
#CASE YD2*Lead  {  $X2(2) $G2 /}  {  $X2(2) $N2(3) /}  {  $X2(2) $N2(1) /}
 888 /
#CASE YD1*Lead  {  $X1(3) $G1 /}  {  $X1(3) $N1(1) /}  {  $X1(3) $N1(2) /}
#CASE YD2*Lead  {  $X2(3) $G2 /}  {  $X2(3) $N2(1) /}  {  $X2(3) $N2(2) /}
 #ENDIF
#ELSE
 #IF View==0
#CASE YD1*Lead  {  $A1 $G1 ~}  {  $A1 $B1 ~}  {  $A1 $C1 ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $A2 $G2 ~}  {  $A2 $B2 ~}  {  $A2 $C2 ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $B1 $G1 /}  {  $B1 $C1 /}  {  $B1 $A1 /}
#CASE YD2*Lead  {  $B2 $G2 /}  {  $B2 $C2 /}  {  $B2 $A2 /}
 888 /
#CASE YD1*Lead  {  $C1 $G1 /}  {  $C1 $A1 /}  {  $C1 $B1 /}
#CASE YD2*Lead  {  $C2 $G2 /}  {  $C2 $A2 /}  {  $C2 $B2 /}
 #ELSE
#CASE YD1*Lead  {  $N1(1) $G1 ~}  {  $N1(1) $N1(2) ~}  {  $N1(1) $N1(3) ~}
  #IF Ideal {~   $L1 /}{~   0.0 $L1 /}
#CASE YD2*Lead  {  $N2(1) $G2 ~}  {  $N2(1) $N2(2) ~}  {  $N2(1) $N2(3) ~}
  #IF Ideal {~   $L12   $L2 /}{~   0.0 $L12   0.0 $L2 /}
 888 /
#CASE YD1*Lead  {  $N1(2) $G1 /}  {  $N1(2) $N1(3) /}  {  $N1(2) $N1(1) /}
#CASE YD2*Lead  {  $N2(2) $G2 /}  {  $N2(2) $N2(3) /}  {  $N2(2) $N2(1) /}
 888 /
#CASE YD1*Lead  {  $N1(3) $G1 /}  {  $N1(3) $N1(1) /}  {  $N1(3) $N1(2) /}
#CASE YD2*Lead  {  $N2(3) $G2 /}  {  $N2(3) $N2(1) /}  {  $N2(3) $N2(2) /}
 #ENDIF
#ENDIF
C
"
   Matrix-fill = "\
#IF CuL>0
 #IF View==0
  #IF YD1*Lead==0
   #CASE YD2*Lead {$XA1 $G1 $XA2 $G2} {$XA1 $G1 $XA2 $B2} {$XA1 $G1 $XA2 $C2}
   #CASE YD2*Lead {$XB1 $G1 $XB2 $G2} {$XB1 $G1 $XB2 $C2} {$XB1 $G1 $XC2 $B2}
   #CASE YD2*Lead {$XC1 $G1 $XC2 $G2} {$XC1 $G1 $XC2 $A2} {$XC1 $G1 $XB2 $A2}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$XA1 $B1 $XA2 $G2} {$XA1 $B1 $XA2 $B2} {$XA1 $B1 $XA2 $C2}
   #CASE YD2*Lead {$XB1 $C1 $XB2 $G2} {$XB1 $C1 $XB2 $C2} {$XB1 $C1 $XC2 $B2}
   #CASE YD2*Lead {$XC1 $A1 $XC2 $G2} {$XC1 $A1 $XC2 $A2} {$XC1 $A1 $XB2 $A2}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$XA1 $C1 $XA2 $G2} {$XA1 $C1 $XA2 $B2} {$XA1 $C1 $XA2 $C2}
   #CASE YD2*Lead {$XC1 $B1 $XB2 $G2} {$XC1 $B1 $XB2 $C2} {$XC1 $B1 $XC2 $B2}
   #CASE YD2*Lead {$XB1 $A1 $XC2 $G2} {$XB1 $A1 $XC2 $A2} {$XB1 $A1 $XB2 $A2}
  #ENDIF
 #ELSE
  #IF YD1*Lead==0
   #CASE YD2*Lead {$X1(1) $G1 $X2(1) $G2} {$X1(1) $G1 $X2(1) $N2(2)} {$X1(1) $G1 $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(2) $G1 $X2(2) $G2} {$X1(2) $G1 $X2(2) $N2(3)} {$X1(2) $G1 $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(3) $G1 $X2(3) $G2} {$X1(3) $G1 $X2(3) $N2(1)} {$X1(3) $G1 $X2(2) $N2(1)}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$X1(1) $N1(2) $X2(1) $G2} {$X1(1) $N1(2) $X2(1) $N2(2)} {$X1(1) $N1(2) $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(2) $N1(3) $X2(2) $G2} {$X1(2) $N1(3) $X2(2) $N2(3)} {$X1(2) $N1(3) $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(3) $N1(1) $X2(3) $G2} {$X1(3) $N1(1) $X2(3) $N2(1)} {$X1(3) $N1(1) $X2(2) $N2(1)}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$X1(1) $N1(3) $X2(1) $G2} {$X1(1) $N1(3) $X2(1) $N2(2)} {$X1(1) $N1(3) $X2(1) $N2(3)}
   #CASE YD2*Lead {$X1(3) $N1(2) $X2(2) $G2} {$X1(3) $N1(2) $X2(2) $N2(3)} {$X1(3) $N1(2) $X2(3) $N2(2)}
   #CASE YD2*Lead {$X1(2) $N1(1) $X2(3) $G2} {$X1(2) $N1(1) $X2(3) $N2(1)} {$X1(2) $N1(1) $X2(2) $N2(1)}
  #ENDIF
 #ENDIF
#ELSE
 #IF View==0
  #IF YD1*Lead==0
   #CASE YD2*Lead {$A1 $G1 $A2 $G2} {$A1 $G1 $A2 $B2} {$A1 $G1 $A2 $C2}
   #CASE YD2*Lead {$B1 $G1 $B2 $G2} {$B1 $G1 $B2 $C2} {$B1 $G1 $C2 $B2}
   #CASE YD2*Lead {$C1 $G1 $C2 $G2} {$C1 $G1 $C2 $A2} {$C1 $G1 $B2 $A2}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$A1 $B1 $A2 $G2} {$A1 $B1 $A2 $B2} {$A1 $B1 $A2 $C2}
   #CASE YD2*Lead {$B1 $C1 $B2 $G2} {$B1 $C1 $B2 $C2} {$B1 $C1 $C2 $B2}
   #CASE YD2*Lead {$C1 $A1 $C2 $G2} {$C1 $A1 $C2 $A2} {$C1 $A1 $B2 $A2}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$A1 $C1 $A2 $G2} {$A1 $C1 $A2 $B2} {$A1 $C1 $A2 $C2}
   #CASE YD2*Lead {$C1 $B1 $B2 $G2} {$C1 $B1 $B2 $C2} {$C1 $B1 $C2 $B2}
   #CASE YD2*Lead {$B1 $A1 $C2 $G2} {$B1 $A1 $C2 $A2} {$B1 $A1 $B2 $A2}
  #ENDIF
 #ELSE
  #IF YD1*Lead==0
   #CASE YD2*Lead {$N1(1) $G1 $N2(1) $G2} {$N1(1) $G1 $N2(1) $N2(2)} {$N1(1) $G1 $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(2) $G1 $N2(2) $G2} {$N1(2) $G1 $N2(2) $N2(3)} {$N1(2) $G1 $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(3) $G1 $N2(3) $G2} {$N1(3) $G1 $N2(3) $N2(1)} {$N1(3) $G1 $N2(2) $N2(1)}
  #ELSEIF YD1*Lead==1
   #CASE YD2*Lead {$N1(1) $N1(2) $N2(1) $G2} {$N1(1) $N1(2) $N2(1) $N2(2)} {$N1(1) $N1(2) $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(2) $N1(3) $N2(2) $G2} {$N1(2) $N1(3) $N2(2) $N2(3)} {$N1(2) $N1(3) $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(3) $N1(1) $N2(3) $G2} {$N1(3) $N1(1) $N2(3) $N2(1)} {$N1(3) $N1(1) $N2(2) $N2(1)}
  #ELSEIF YD1*Lead==2
   #CASE YD2*Lead {$N1(1) $N1(3) $N2(1) $G2} {$N1(1) $N1(3) $N2(1) $N2(2)} {$N1(1) $N1(3) $N2(1) $N2(3)}
   #CASE YD2*Lead {$N1(3) $N1(2) $N2(2) $G2} {$N1(3) $N1(2) $N2(2) $N2(3)} {$N1(3) $N1(2) $N2(3) $N2(2)}
   #CASE YD2*Lead {$N1(2) $N1(1) $N2(3) $G2} {$N1(2) $N1(1) $N2(3) $N2(1)} {$N1(2) $N1(1) $N2(2) $N2(1)}
  #ENDIF
 #ENDIF
#ENDIF"
   Dsdyn = "\
!  TRANSFORMER SATURATION SUBROUTINE
#IF Tap
 #STORAGE STOR:36
 #IF SAT==TAP
  #LOCAL REAL RVD1_1
      RVD1_1 = $TapI
      IF (RVD1_1 .LT. 1.0E-8) RVD1_1 = 1.0
 #ENDIF
#ELSE
 #STORAGE STOR:21
#ENDIF
#SUBROUTINE TSAT21 Transformer Saturation Subroutine
#LOCAL REAL X_KNEE
#If Txk>0
      IF (TIME.GT.$Txk) THEN
         X_KNEE = $Xknee
      ELSE
         X_KNEE = -$Xknee
      ENDIF
#ELSE
      X_KNEE = $Xknee
#ENDIF
#LOCAL REAL TURNS_V
#IF SAT==1
      TURNS_V = $V_1
#ELSE
      TURNS_V = $V_2
#ENDIF
#IF SAT==TAP
     + * RVD1_1
#ENDIF
      CALL TSAT21(~
#IF CuL>0
 #IF View==0
  #IF SAT==1
   #CASE YD1 {~$XA1,$G1, $XB1,$G1, $XC1,$G1,} {~$XA1,$B1, $XB1,$C1, $XC1,$A1,}
  #ELSE
   #CASE YD2 {~$XA2,$G2, $XB2,$G2, $XC2,$G2,} {~$XA2,$B2, $XB2,$C2, $XC2,$A2,}
  #ENDIF
 #ELSE
  #IF SAT==1
   #CASE YD1 {~$X1(1),$G1, $X1(2),$G1, $X1(3),$G1,} {~$X1(1),$N1(2), $X1(2),$N1(3), $X1(3),$N1(1),}
  #ELSE
   #CASE YD2 {~$X2(1),$G2, $X2(2),$G2, $X2(3),$G2,} {~$X2(1),$N2(2), $X2(2),$N2(3), $X2(3),$N2(1),}
  #ENDIF
 #ENDIF
#ELSE
 #IF View==0
  #IF SAT==1
   #CASE YD1 {~$A1,$G1, $B1,$G1, $C1,$G1,} {~$A1,$B1, $B1,$C1, $C1,$A1,}
  #ELSE
   #CASE YD2 {~$A2,$G2, $B2,$G2, $C2,$G2,} {~$A2,$B2, $B2,$C2, $C2,$A2,}
  #ENDIF
 #ELSE
  #IF SAT==1
   #CASE YD1 {~$N1(1),$G1, $N1(2),$G1, $N1(3),$G1,} {~$N1(1),$N1(2), $N1(2),$N1(3), $N1(3),$N1(1),}
  #ELSE
   #CASE YD2 {~$N2(1),$G2, $N2(2),$G2, $N2(3),$G2,} {~$N2(1),$N2(2), $N2(2),$N2(3), $N2(3),$N2(1),}
  #ENDIF
 #ENDIF
#ENDIF
     +$SS,$MVA,TURNS_V,$Xair,X_KNEE,$f,$Tdc,$I_m1, 0.0, $Enab)
#IF (SAT==1 ? YD1 : YD2) == 1
#OUTPUT REAL IMAB  {-STOR(NEXC-21+17)}
#OUTPUT REAL IMBC  {-STOR(NEXC-21+18)}
#OUTPUT REAL IMCA  {-STOR(NEXC-21+19)}
#OUTPUT REAL FLXAB {STOR(NEXC-21+11)}
#OUTPUT REAL FLXBC {STOR(NEXC-21+13)}
#OUTPUT REAL FLXCA {STOR(NEXC-21+15)}
#ELSE
#OUTPUT REAL IMA   {-STOR(NEXC-21+17)}
#OUTPUT REAL IMB   {-STOR(NEXC-21+18)}
#OUTPUT REAL IMC   {-STOR(NEXC-21+19)}
#OUTPUT REAL FLXA  {STOR(NEXC-21+11)}
#OUTPUT REAL FLXB  {STOR(NEXC-21+13)}
#OUTPUT REAL FLXC  {STOR(NEXC-21+15)}
#ENDIF
#IF Tap
      CALL TRTAP5($#[1], $Tap, $SS, $TapI)
      CALL TRTAP5($#[2], $Tap, $SS, $TapI)
      CALL TRTAP5($#[3], $Tap, $SS, $TapI)
#ENDIF
!

! Electranix Parallel Processing Scaling Transformer - Side 2 (on load/device side with scaling 1)
#IF (View==0)
      CALL ETRAN_COM_Scaling_Trf_DSDYN($A1,$A2,$A3,$SS,$Port,$Tmva,$f,$V1,$Xl,1.0,$NOUTF)
#ELSE
      CALL ETRAN_COM_Scaling_Trf_DSDYN($N1(1),$N1(2),$N1(3),$SS,$Port,$Tmva,$f,$V1,$Xl,1.0,$NOUTF)
#ENDIF
"
   Dsout = "\
#IF YD1
#  IF Lead==1
#OUTPUT REAL IAB1 {CDCTR(1,$#[1])}
#OUTPUT REAL IBC1 {CDCTR(1,$#[2])}
#OUTPUT REAL ICA1 {CDCTR(1,$#[3])}
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])-CDCTR(1,$#[3])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])-CDCTR(1,$#[1])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])-CDCTR(1,$#[2])}
#  ELSE
#OUTPUT REAL IAB1 {-CDCTR(1,$#[2])}
#OUTPUT REAL IBC1 {-CDCTR(1,$#[3])}
#OUTPUT REAL ICA1 {-CDCTR(1,$#[1])}
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])-CDCTR(1,$#[2])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])-CDCTR(1,$#[3])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])-CDCTR(1,$#[1])}
#  ENDIF
#ELSE
#OUTPUT REAL ILA1 {CDCTR(1,$#[1])}
#OUTPUT REAL ILB1 {CDCTR(1,$#[2])}
#OUTPUT REAL ILC1 {CDCTR(1,$#[3])}
#ENDIF
#IF YD2
#  IF Lead==1
#OUTPUT REAL IAB2 {CDCTR(2,$#[1])}
#OUTPUT REAL IBC2 {CDCTR(2,$#[2])}
#OUTPUT REAL ICA2 {CDCTR(2,$#[3])}
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])-CDCTR(2,$#[3])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])-CDCTR(2,$#[1])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])-CDCTR(2,$#[2])}
#  ELSE
#OUTPUT REAL IAB2 {-CDCTR(2,$#[2])}
#OUTPUT REAL IBC2 {-CDCTR(2,$#[3])}
#OUTPUT REAL ICA2 {-CDCTR(2,$#[1])}
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])-CDCTR(2,$#[2])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])-CDCTR(2,$#[3])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])-CDCTR(2,$#[1])}
#  END
#ELSE
#OUTPUT REAL ILA2 {CDCTR(2,$#[1])}
#OUTPUT REAL ILB2 {CDCTR(2,$#[2])}
#OUTPUT REAL ILC2 {CDCTR(2,$#[3])}
#ENDIF

! Electranix Parallel Processing Scaling Transformer - Side 2 (on load/device side with scaling 1)
#IF (View==0)
      CALL ETRAN_COM_Scaling_Trf_DSOUT($NINF,$A1,$A2,$A3,$SS,$Port,$Tmva,$f,$V1,$Xl)
#ELSE
      CALL ETRAN_COM_Scaling_Trf_DSOUT($NINF,$N1(1),$N1(2),$N1(3),$SS,$Port,$Tmva,$f,$V1,$Xl)
#ENDIF"
   }
  Section(Help)
   {
   Flyby = "\
3-phase bank of 1-phase 2-winding transformers
:TapI
Tap setting
:A1
Phase A - Winding 1
:B1
Phase B - Winding 1
:C1
Phase C - Winding 1
:A2
Phase A - Winding 2
:B2
Phase B - Winding 2
:C2
Phase C - Winding 2
:G1
Neutral - Winding 1
:G2
Neutral - Winding 2
:N1
Winding 1 terminals
:N2
Winding 2 terminals
"
   }
  }
 Component("Electranix_Scale_1")
  {
  Desc = "Parallel 3P, 2W ScalingTransformer_Side1!"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Input("Tmva",5,12,201,12,2)
     {
     Desc = "3 Phase Transformer MVA"
     Def = "100.0"
     Data = Real
     Unit = "MVA"
     Len = 15
     Min = 1e-006
     }
    Input("f",5,28,201,12,2)
     {
     Desc = "Base operation frequency"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     Min = 0.0001
     }
    Input("Xl",5,44,201,12,2)
     {
     Desc = "Positive sequence leakage reactance"
     Def = "0.1"
     Data = Real
     Unit = "pu"
     Len = 15
     Min = 0
     Max = 1
     }
    Input("Port",5,60,201,12,2)
     {
     Desc = "TCP/IP Port (2000)"
     Def = "2000"
     Data = Integer
     Len = 15
     }
    Choice("View",5,80,201,11,2)
     {
     Style = 0
     Desc = "Graphics Display"
     Def = "1"
     Len = 24
     Cond = "(true)"
     *0 = "3 phase view"
     *1 = "Single line"
     }
    Input("V1",5,96,201,12,2)
     {
     Desc = "Winding 1 Line to Line voltage (RMS)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     Min = 0.0001
     }
    }
   Category("Winding 1 Line Currents")
    {
    Text("ILA1",5,4,201,12,2)
     {
     Desc = "Name for Phase A Current (+in,kA)"
     Len = 15
     }
    Text("ILB1",5,20,201,12,2)
     {
     Desc = "Name for Phase B Current (+in,kA)"
     Len = 15
     }
    Text("ILC1",5,36,201,12,2)
     {
     Desc = "Name for Phase C Current (+in,kA)"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("N1",-18,0)
    {
    Cond = "View==1"
    Dim  = [3]
    }
   Input("scl",0,-36)
    {
    Type = Real
    }
   Input("NINF",0,0)
    {
    Type = Integer
    }
   Output("NOUTF",0,0)
    {
    Type = Integer
    }
   Electrical("A1",-18,-36)
    {
    Cond = "View!=1"
    }
   Electrical("B1",-18,0)
    {
    Cond = "View!=1"
    }
   Electrical("C1",-18,36)
    {
    Cond = "View!=1"
    }
   }

  Graphics = 
   {
   Line(0,-37,0,-17)
   Pen(,ByNode,0.6)
   Rectangle(-10,-17,11,19)
   Cond = "View==1"
   Line(-19,0,-10,0)
   Pen(,Solid,0.2)
   Cond = "true"
   Line(29,-2,8,-2)
   Line(29,2,8,2)
   Line(24,-7,32,0)
   Line(24,7,32,0)
   Text(28,19,"$Port")
   Text(10,-28,"Scl")
   Line(-5,-22,0,-17)
   Line(4,-22,0,-17)
   Cond = "View!=1"
   Line(-18,0,-9,0)
   Line(-18,-36,-11,-1)
   Line(-18,36,-11,1)
   Cond = "true"
   Text(-2,-5,"E+")
   }

  Section(EMTDC)
   {
   Dsdyn = "\
! Electranix Parallel Processing Scaling Transformer - Side 1 (on load/device side with scaling factor)
#STORAGE REAL:11
#STORAGE INTEGER:6
#STORAGE LOGICAL:6
#IF (View==0)
      CALL ETRAN_COM_Scaling_Trf_DSDYN($A1,$A2,$A3,$SS,$Port,$Tmva,$f,$V1,$Xl,$scl,$NOUTF)
#ELSE
      CALL ETRAN_COM_Scaling_Trf_DSDYN($N1(1),$N1(2),$N1(3),$SS,$Port,$Tmva,$f,$V1,$Xl,$scl,$NOUTF)
#ENDIF"
   DSOUT = "\
! Electranix Parallel Processing Scaling Transformer - Side 1 (on load/device side with scaling factor)
#IF (View==0)
      CALL ETRAN_COM_Scaling_Trf_DSOUT($NINF,$A1,$A2,$A3,$SS,$Port,$Tmva,$f,$V1,$Xl)
#ELSE
      CALL ETRAN_COM_Scaling_Trf_DSOUT($NINF,$N1(1),$N1(2),$N1(3),$SS,$Port,$Tmva,$f,$V1,$Xl)
#ENDIF"
   }
  Section(Help)
   {
   Flyby = "\
:N
Winding 1 terminals

"
   }
  }
 Component("Sequencer_Electranix_PSCAD_chan_export")
  {
  Desc = "Exporting PSCAD Signals to PSSE"
  FileDate = 0
  Parameters = 
   {
   Category("General")
    {
    Input("Port",5,4,246,12,6)
     {
     Desc = "TCP/IP Communication Port"
     Def = "2000"
     Data = Integer
     Len = 11
     Min = 0
     }
    Choice("CTGY",5,20,246,11,2)
     {
     Style = 0
     Desc = "Category"
     Def = "1"
     Len = 30
     *1 = "PSSE Outage"
     *2 = "PSSE Array Change"
     }
    }
   Category("Outage Data")
    {
    Cond = "CTGY==1"
    Choice("fault",5,4,246,11,2)
     {
     Style = 0
     Desc = "Outage Type"
     Def = "0"
     Len = 20
     *0 = "None"
     *1 = "Bus Trip"
     *2 = "Load Shed"
     *3 = "Branch Trip/close"
     *4 = "Drop/connect Unit"
     }
    Text("IBUS",5,20,246,12,2)
     {
     Desc = "Bus Number (from)"
     Def = "100"
     Len = 12
     Cond = "fault !=0 "
     }
    Text("JBUS",5,36,246,12,2)
     {
     Desc = "Bus Number (to)"
     Def = "200"
     Len = 12
     Cond = "(fault ==3 )"
     }
    Choice("CHECK",5,52,246,11,2)
     {
     Style = 0
     Desc = "Three Wdg TF?"
     Def = "0"
     Len = 12
     Cond = "(fault ==3 )"
     *0 = " NO"
     *1 = " YES"
     }
    Text("KBUS",5,68,246,12,2)
     {
     Desc = "Bus Number (3rd bus)"
     Def = "300"
     Len = 12
     Cond = "(CHECK ==1 && (fault ==3))"
     }
    Text("IDD",5,84,246,12,2)
     {
     Desc = "Circult/Machine/Load ID"
     Def = "1"
     Len = 12
     Cond = "(fault >=2 && fault <=4)"
     }
    }
   Category("Array Change Data")
    {
    Cond = "CTGY==2"
    Text("ID",5,36,246,12,2)
     {
     Desc = "Machine ID"
     Def = "1"
     Len = 11
     Cond = "(Chan <8 && Chan != 0)"
     }
    Text("Bus1",5,20,246,12,2)
     {
     Desc = "Bus1 (or Index) "
     Def = "100"
     Len = 11
     Cond = "Chan != 0"
     }
    Choice("Chan",5,4,247,12,2)
     {
     Style = 0
     Desc = "PSSE Qty sending from PSCAD"
     Def = "0"
     Len = 35
     *0 = "None"
     *1 = "EFD (mach field volt, pu)"
     *2 = "PMECH (mach power, pu MBASE)"
     *3 = "ECOMP (mach comp voltage, pu)"
     *4 = "VOTHSG (mach stab signal, pu)"
     *5 = "VOEL (max exci lim signal, pu)"
     *6 = "VUEL (min exci lim signal, pu)"
     *7 = "VREF (mach reg ref, pu)"
     *8 = "VAR (units vary)"
     *9 = "STATE (units vary)"
     }
    }
   }

  Nodes = 
   {
   Input("In",-90,0)
    {
    Cond = ""
    Type = Real
    }
   Input("In",-108,0)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Rectangle(-93,-33,96,39)
   Text(-68,-22,"E+")
   Text(2,-13,"ETRAN PSCAD->PSSE")
   Line(-108,0,-94,0)
   Font(,,Left)
   Cond = "CTGY ==0"
   Text(-75,4,"None")
   Cond = "(CTGY ==2 && Chan ==1)"
   Text(28,4,"EFD")
   Cond = "(CTGY ==2 && Chan ==2)"
   Text(29,4,"PMECH")
   Cond = "(CTGY ==2 && Chan ==3)"
   Text(29,4,"ECOMP")
   Cond = "(CTGY ==2 && Chan ==4)"
   Text(29,4,"VOTHSG")
   Cond = "(CTGY ==2 && Chan ==7)"
   Text(29,4,"VREF")
   Cond = "(CTGY ==2 && Chan ==8)"
   Text(29,4,"VAR")
   Cond = "(CTGY ==2 && Chan ==5)"
   Text(29,4,"VUEL")
   Cond = "(CTGY ==2 && Chan ==9)"
   Text(29,4,"STATE")
   Cond = "(CTGY ==2  && Chan !=0)"
   Text(-93,35,"%Bus1")
   Cond = "((CTGY==1) && (fault>=2 && fault<=4))"
   Text(41,35,"%IDD")
   Cond = "(CTGY==1 && (fault !=0))"
   Text(-91,22,"Bus1")
   Cond = "((CTGY==1) && (fault>=2 && fault<=4))"
   Text(42,21,"ID")
   Cond = "(CTGY ==2 && Chan >= 8)"
   Text(-93,20,"Index")
   Cond = "true"
   Text(63,21,"Port")
   Text(62,34,"%Port")
   Cond = "CTGY==1"
   Text(-75,4,"Outage ")
   Cond = "CTGY ==2"
   Text(-75,3,"PSSE Array ")
   Cond = "(CTGY ==2 && Chan ==6)"
   Text(29,4,"VOEL")
   Cond = "(CTGY ==2 && Chan ==0)"
   Text(29,4,"None")
   Cond = "(fault ==0 && CTGY ==1)"
   Text(29,4,"None")
   Cond = "(CTGY ==1 && fault ==1)"
   Text(-7,4,"Bus Trip")
   Cond = "(CTGY ==1 && fault ==2)"
   Text(-7,4,"Load Shed")
   Cond = "(CTGY ==1 && fault ==3)"
   Text(-7,4,"Br Trip/close")
   Cond = "(CTGY ==1 && fault ==4)"
   Text(-7,5,"DROP UNIT")
   Cond = "(CTGY ==1 && (fault==3))"
   Text(-49,21,"Bus2")
   Cond = "(CTGY ==1 && fault !=0)"
   Text(-93,36,"%IBUS")
   Cond = "(CTGY ==1 && (fault==3) && CHECK == 1)"
   Text(-3,21,"Bus3")
   Cond = "(CTGY ==1 && (fault==3))"
   Text(-47,35,"%JBUS")
   Cond = "(CTGY ==1 && (fault==3) && CHECK == 1)"
   Text(-4,35,"%KBUS")
   Cond = "(CTGY==2 && (Chan <8 && Chan !=0))"
   Text(-93,21,"Bus1")
   Cond = "(CTGY ==2  && (Chan !=0 && Chan < 8)) "
   Text(30,22,"ID")
   Text(31,34,"%ID")
   }

  Section(EMTDC)
   {
   DSDYN = "\
! Collect all channel names and get output signal
      CALL ETRAN_DSD_PSSE_FAULT($In, $CTGY,~
#IF (CTGY==1)
     ~$fault,~
#ELSE
     ~0,~
#ENDIF
#IF (CTGY==2)
     ~$Chan,~
#ELSE
     ~0,~
#ENDIF
#IF (CTGY==1)
     ~$IBUS,~
#ELSE
     ~0,~
#ENDIF
#IF ((CTGY==1) && (fault==2 || fault==3))
     ~$JBUS,~
#ELSE
     ~0,~
#ENDIF
#IF ((CTGY==1) && (fault==2 || fault==3))
     ~$CHECK,~
#ELSE
     ~0,~
#ENDIF
#IF ((CTGY==1) && (CHECK==1 && (fault==2 || fault==3)))
     ~$KBUS,~
#ELSE
     ~0,~
#ENDIF
#IF ((CTGY==1) && (fault>=2 && fault<=4))
     ~\"$IDD\",~
#ELSE
     ~\"0\",~
#ENDIF
#IF ((CTGY==2) && (Chan!=0))
     ~$Bus1,~
#ELSE
     ~0,~
#ENDIF
#IF ((CTGY==2) && (Chan<8 && Chan!= 0))
     ~\"$ID\",$Port)
#ELSE
     ~\"0\",$Port)
#ENDIF
"
   DSOUT = "\
! ETRAN Plus coms to PSS/E for channel plotting
      CALL ETRAN_DSO_PSSE_FAULT()"
   }
  }
 Component("Sequencer_Electranix_PSSE_chan_import")
  {
  Desc = "Imports PSSE output channels to PSCAD"
  FileDate = 0
  Parameters = 
   {
   Category("Channel Selection")
    {
    Input("Port",5,8,151,12,6)
     {
     Desc = "TCP/IP Communication Port"
     Def = "2000"
     Data = Integer
     Len = 11
     Min = 0
     }
    Choice("Chan",5,24,310,11,2)
     {
     Style = 0
     Desc = "Channel to monitor"
     Def = "0"
     Len = 50
     *0 = "None"
     *1 = "1 ANGLE(rotor ang,deg)"
     *2 = "2 PELEC(mach elec power, pu SBASE)"
     *3 = "3 QELEC(mach reactive power, pu SBASE)"
     *4 = "4 ETERM(mach terminal volt, pu)"
     *5 = "5 EFD(mach field volt, pu)"
     *6 = "6 PMECH(mach power, pu MBASE)"
     *7 = "7 SPEED(mach speed dev, pu)"
     *8 = "8 XADIFD(mach field current, pu)"
     *9 = "9 ECOMP(mach comp voltage, pu)"
     *10 = "10 VOTHSG(mach stab signal, pu)"
     *11 = "11 VREF(mach reg ref, pu)"
     *12 = "12 BSFREQ(freq dev, pu)"
     *13 = "13 VOLTAGE(bus volt, pu)"
     *14 = "14 ANG(bus angle, deg)"
     *15 = "15 FLOW P(br flow, MW)"
     *16 = "16 FLOW Q(br flow, MVAR)"
     *17 = "17 FLOW MVA(br flow, MVA)"
     *18 = "18 RELAY2(R, pu)"
     *181 = "181 RELAY2(X, pu)"
     *19 = "19 VAR(units vary)"
     *20 = "20 STATE(units vary)"
     *21 = "21 MACH ITERM(mach term current, pu)"
     *22 = "22 Mach apparent imp(R, pu)"
     *221 = "221 Mach apparent imp(X, pu)"
     *23 = "23 VUEL(min exci lim signal, pu)"
     *24 = "24 VOEL(max exci lim signal, pu)"
     *25 = "25 PLOAD(active power load, pu)"
     *26 = "26 QLOAD(reactive power load, pu)"
     }
    Text("Bus1",5,40,151,12,2)
     {
     Desc = "Bus1 (or Index) "
     Def = "100"
     Len = 11
     Cond = "(Chan!=0)"
     }
    Text("Bus2",5,56,151,12,2)
     {
     Desc = "Bus 2 (or index)"
     Def = "200"
     Len = 11
     Cond = "(Chan==15)||(Chan==16)||(Chan==17)||(Chan==18)||(Chan==181)"
     }
    Text("ID",5,72,151,12,2)
     {
     Desc = "Machine/Load/Circuit ID"
     Def = "1"
     Len = 11
     Cond = "(Chan!=0)&&(Chan!=12)&&(Chan!=13)&&(Chan!=14)&&(Chan!=19)&&(Chan!=20)"
     }
    }
   }

  Nodes = 
   {
   Output("Out",90,0)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Rectangle(-76,-33,79,38)
   Text(-68,-22,"E+")
   Text(2,-13,"ETRAN PSSE->PSCAD")
   Line(78,0,90,0)
   Font(,,Left)
   Cond = "Chan==0"
   Text(-70,4,"None")
   Cond = "Chan==1"
   Text(-70,4,"ANGLE")
   Cond = "Chan==2"
   Text(-70,4,"PELEC")
   Cond = "Chan==3"
   Text(-71,4,"QELEC")
   Cond = "Chan==4"
   Text(-72,3,"ETERM")
   Cond = "Chan==5"
   Text(-71,4,"EFD")
   Cond = "Chan==6"
   Text(-71,3,"PMECH")
   Cond = "Chan==7"
   Text(-72,4,"SPEED")
   Cond = "Chan==8"
   Text(-73,4,"XADIFD")
   Cond = "Chan==9"
   Text(-73,4,"ECOMP")
   Cond = "Chan==10"
   Text(-74,3,"VOTHSG")
   Cond = "Chan==11"
   Text(-74,4,"VREF")
   Cond = "Chan==12"
   Text(-74,3,"BSFREQ")
   Cond = "Chan==13"
   Text(-74,3,"VOLTAGE")
   Cond = "Chan==14"
   Text(-74,3,"ANG")
   Cond = "Chan==15"
   Text(-74,3,"FLOW P")
   Cond = "Chan==17"
   Text(-71,3,"FLOW MVA")
   Cond = "Chan==18"
   Text(-73,3,"RELAY2 R")
   Cond = "Chan==181"
   Text(-74,3,"RELAY2 X")
   Cond = "Chan==19"
   Text(-73,4,"VAR")
   Cond = "Chan==16"
   Text(-70,3,"FLOW Q")
   Cond = "Chan==21"
   Text(-74,4,"ITERM")
   Cond = "Chan==22"
   Text(-75,4,"MAC APP R")
   Cond = "Chan==221"
   Text(-75,4,"MAC APP X")
   Cond = "Chan==23"
   Text(-75,4,"VUEL")
   Cond = "Chan==20"
   Text(-73,3,"STATE")
   Cond = "Chan==25"
   Text(-74,3,"PLOAD")
   Cond = "Chan==26"
   Text(-74,3,"QLOAD")
   Cond = "Chan==24"
   Text(-74,3,"VOEL")
   Cond = "(Chan!=19)&&(Chan!=20)&&(Chan!=0)"
   Text(-75,33,"%Bus1")
   Cond = "(Chan==15)||(Chan==16)||(Chan==17)||(Chan==18)||(Chan==181)"
   Text(-29,33,"%Bus2")
   Cond = "(Chan!=12)&&(Chan!=13)&&(Chan!=14)&&(Chan!=19)&&(Chan!=20)&&(Chan!=0)"
   Text(15,33,"%ID")
   Cond = "(Chan!=19)&&(Chan!=20)&&(Chan!=0)"
   Text(-74,21,"Bus1")
   Cond = "(Chan==15)||(Chan==16)||(Chan==17)||(Chan==18)||(Chan==181)"
   Text(-29,21,"Bus2")
   Cond = "(Chan!=12)&&(Chan!=13)&&(Chan!=14)&&(Chan!=19)&&(Chan!=20)&&(Chan!=0)"
   Text(13,21,"ID")
   Cond = "(Chan==19)||(Chan==20)"
   Text(-74,21,"Index")
   Cond = "true"
   Text(45,21,"Port")
   Text(44,33,"%Port")
   }

  Section(EMTDC)
   {
   DSDYN = "\
! Collect all channel names and get output signal
      CALL ETRAN_DSD_PSSE_SIG($Chan,~
#IF ( (Chan==0) )
     ~0,~
#ELSE
     ~$Bus1,~
#ENDIF 
#IF ( (Chan==15)||(Chan==16)||(Chan==17)||(Chan==18)||(Chan==181) )
     ~$Bus2,~
#ELSE
     ~0,~
#ENDIF
#IF ( (Chan!=0)&&(Chan!=12)&&(Chan!=13)&&(Chan!=14)&&(Chan!=19)&&(Chan!=20) )
     ~\"$ID\",$Port,$Out)
#ELSE
     ~\"0\",$Port,$Out)
#ENDIF

"
   DSOUT = "\
! ETRAN Plus coms to PSS/E for channel plotting
      CALL ETRAN_DSO_PSSE_SIG()
"
   }
  }
 Component("Electranix_Breaker_Control")
  {
  Desc = ""
  FileDate = 0
  Parameters = 
   {
   }

  Nodes = 
   {
   Input("VratedX",-54,-324)
    {
    Type = Real
    }
   Input("VRatedY",-54,-288)
    {
    Type = Real
    }
   Input("PD_X_FX",-54,-252)
    {
    Type = Real
    }
   Input("PD_Y_FX",-54,-216)
    {
    Type = Real
    }
   Input("PD_X_FY",-54,-180)
    {
    Type = Real
    }
   Input("PD_Y_FY",-54,-144)
    {
    Type = Real
    }
   Input("FltLoc_X",-54,-108)
    {
    Type = Integer
    }
   Input("TPAR_X",-54,-36)
    {
    Type = Integer
    }
   Input("TPAR_simul",-54,0)
    {
    Type = Integer
    }
   Input("SPAR",-54,36)
    {
    Type = Integer
    }
   Input("RCFailDelay",-54,72)
    {
    Type = Real
    }
   Input("RecloseDelay",-54,108)
    {
    Type = Real
    }
   Input("RCEnabled",-54,144)
    {
    Type = Integer
    }
   Input("FltTime",-54,216)
    {
    Type = Real
    }
   Input("FltLoc",-54,252)
    {
    Type = Integer
    }
   Input("FltDuration",-54,288)
    {
    Type = Real
    }
   Input("FltType",-54,324)
    {
    Type = Integer
    }
   Input("InstantTrip",-54,360)
    {
    Type = Integer
    }
   Output("BRKAX",144,-234)
    {
    Type = Integer
    }
   Output("BRKBX",144,-198)
    {
    Type = Integer
    }
   Output("BRKCX",144,-162)
    {
    Type = Integer
    }
   Output("BRKAY",144,-126)
    {
    Type = Integer
    }
   Output("BRKBY",144,-90)
    {
    Type = Integer
    }
   Output("BRKCY",144,-54)
    {
    Type = Integer
    }
   Output("FTime1",144,-18)
    {
    Type = Real
    }
   Output("FTime2",144,18)
    {
    Type = Real
    }
   Output("VScaleLLX",144,54)
    {
    Type = Real
    }
   Output("VScaleLLY",144,90)
    {
    Type = Real
    }
   Output("VScaleLGX",144,126)
    {
    Type = Real
    }
   Output("VScaleLGY",144,162)
    {
    Type = Real
    }
   Input("FltLoc_Y",-54,-72)
    {
    Type = Integer
    }
   Input("RCSuccDel",-54,180)
    {
    Type = Real
    }
   }

  Graphics = 
   {
   Rectangle(-39,-345,129,373)
   Pen(ByNode,ByNode,ByNode,VratedX)
   Line(-54,-324,-39,-324)
   Pen(,Solid)
   Line(-39,-324,-44,-329)
   Line(-39,-324,-44,-319)
   Pen(,ByNode,,VRatedY)
   Line(-54,-288,-39,-288)
   Pen(,Solid)
   Line(-39,-288,-44,-293)
   Line(-39,-288,-44,-283)
   Pen(,ByNode,,PD_X_FX)
   Line(-54,-252,-39,-252)
   Pen(,Solid)
   Line(-39,-252,-44,-257)
   Line(-39,-252,-44,-247)
   Pen(,ByNode,,PD_Y_FX)
   Line(-54,-216,-39,-216)
   Pen(,Solid)
   Line(-39,-216,-44,-221)
   Line(-39,-216,-44,-211)
   Font(,,Left)
   Text(-36,-212,"ProtDelay_Y_FX")
   Pen(,ByNode,,PD_X_FY)
   Line(-54,-180,-39,-180)
   Pen(,Solid)
   Line(-39,-180,-44,-185)
   Line(-39,-180,-44,-175)
   Text(-36,-176,"ProtDelay_X_FY")
   Pen(,ByNode,,PD_Y_FY)
   Line(-54,-144,-39,-144)
   Pen(,Solid)
   Line(-39,-144,-44,-149)
   Line(-39,-144,-44,-139)
   Text(-36,-140,"ProtDelay_Y_FY")
   Pen(,ByNode,,FltLoc_X)
   Line(-54,-108,-39,-108)
   Pen(,Solid)
   Line(-39,-108,-44,-113)
   Line(-39,-108,-44,-103)
   Text(-36,-104,"FltLoc_X")
   Pen(,ByNode,,TPAR_X)
   Line(-54,-72,-39,-72)
   Pen(,Solid)
   Line(-39,-72,-44,-77)
   Line(-39,-72,-44,-67)
   Text(-36,-32,"TPAR_X")
   Pen(,ByNode,,TPAR_simul)
   Line(-54,-36,-39,-36)
   Pen(,Solid)
   Line(-39,-36,-44,-41)
   Line(-39,-36,-44,-31)
   Text(-36,4,"TPAR_simul")
   Pen(,ByNode,,SPAR)
   Line(-54,0,-39,0)
   Pen(,Solid)
   Line(-39,0,-44,-5)
   Line(-39,0,-44,5)
   Text(-36,40,"SPAR")
   Pen(,ByNode,,RCFailDelay)
   Line(-54,36,-39,36)
   Pen(,Solid)
   Line(-39,36,-44,31)
   Line(-39,36,-44,41)
   Text(-36,76,"ReclFailDelay")
   Pen(,ByNode,,RecloseDelay)
   Line(-54,72,-39,72)
   Pen(,Solid)
   Line(-39,72,-44,67)
   Line(-39,72,-44,77)
   Text(-36,112,"RecloseDelay")
   Pen(,ByNode,,RCEnabled)
   Line(-54,108,-39,108)
   Pen(,Solid)
   Line(-39,108,-44,103)
   Line(-39,108,-44,113)
   Text(-36,148,"RecloseEnabled")
   Pen(,ByNode,,FltTime)
   Line(-54,144,-39,144)
   Pen(,Solid)
   Line(-39,144,-44,139)
   Line(-39,144,-44,149)
   Text(-36,220,"FltTime")
   Pen(,ByNode,,FltLoc)
   Line(-54,216,-39,216)
   Pen(,Solid)
   Line(-39,216,-44,211)
   Line(-39,216,-44,221)
   Text(-36,256,"FltLoc")
   Pen(Real,Real,0.2)
   Line(-54,252,-39,252)
   Pen(,Solid)
   Line(-39,252,-44,247)
   Line(-39,252,-44,257)
   Text(-36,293,"FltDuration")
   Pen(,Real)
   Line(-54,288,-39,288)
   Pen(,Solid)
   Line(-39,288,-44,283)
   Line(-39,288,-44,293)
   Text(-36,328,"FltType")
   Pen(,Real)
   Line(-54,324,-39,324)
   Pen(,Solid)
   Line(-39,324,-44,319)
   Line(-39,324,-44,329)
   Text(-36,364,"InstantTrip")
   Pen(,Real)
   Line(-54,360,-39,360)
   Pen(,Solid)
   Line(-39,360,-44,355)
   Line(-39,360,-44,365)
   Pen(,Real)
   Line(144,-234,129,-234)
   Font(,,Right)
   Text(126,-230,"BRKAX")
   Line(144,-198,129,-198)
   Text(126,-194,"BRKBX")
   Line(144,-162,129,-162)
   Text(126,-158,"BRKCX")
   Line(144,-126,129,-126)
   Text(126,-122,"BRKAY")
   Line(144,-90,129,-90)
   Text(126,-86,"BRKBY")
   Line(144,-54,129,-54)
   Text(126,-50,"BRKCY")
   Line(144,-18,129,-18)
   Text(126,-15,"FTime1")
   Line(144,18,129,18)
   Text(126,22,"FTime2")
   Line(144,54,129,54)
   Text(126,58,"VScaleLLX")
   Line(144,90,129,90)
   Text(126,94,"VScaleLLY")
   Line(144,126,129,126)
   Text(126,129,"VScaleLGX")
   Line(144,162,129,162)
   Text(126,166,"VScaleLGY")
   Font(,,Left)
   Text(-36,-68,"FltLoc_Y")
   Text(-36,183,"ReclSuccessDelay")
   Line(-54,180,-39,180)
   Pen(,Solid)
   Line(-39,180,-44,175)
   Line(-39,180,-44,185)
   Font(,,Centre)
   Text(81,-321,"Breaker")
   Text(81,-304,"Controller")
   Font(,,Left)
   Text(-36,-320,"VratedX")
   Text(-36,-284,"VratedY")
   Text(-36,-248,"ProtDelay_X_FX")
   }

  Section(EMTDC)
   {
   Fortran = "      CALL Electranix_BreakerControl($VratedX, $VRatedY, $PD_X_FX, $PD_Y_FX, $PD_X_FY, $PD_Y_FY, $FltLoc_X, $FltLoc_Y, $TPAR_X, $TPAR_simul, $SPAR, $RCFailDelay, $RecloseDelay, $RCEnabled, $FltTime, $FltLoc, $FltDuration, $FltType, $InstantTrip, $RCSuccDel, $BRKAX, $BRKBX, $BRKCX, $BRKAY, $BRKBY, $BRKCY, $FTime1, $FTime2, $VScaleLLX, $VScaleLLY, $VScaleLGX, $VScaleLGY)"
   Branch = ""
   Computations = ""
   }
  }
 Component("Electranix_switch")
  {
  Desc = "3 Phase Switch/Breaker/Disconnect with X"
  FileDate = 0
  Parameters = 
   {
   Category("Configuration")
    {
    Input("NAMEA",5,8,241,12,6)
     {
     Desc = "A Breaker Signal (0=Closed,1=Open)"
     Def = "BRK"
     Data = Integer
     Len = 15
     Min = 0
     Max = 1
     }
    Input("NAMEB",5,24,241,12,6)
     {
     Desc = "B Breaker Signal (0=Closed,1=Open)"
     Def = "BRK"
     Data = Integer
     Len = 15
     Min = 0
     Max = 1
     }
    Input("NAMEC",5,40,241,12,6)
     {
     Desc = "C Breaker Signal (0=Closed,1=Open)"
     Def = "BRK"
     Data = Integer
     Len = 15
     Min = 0
     Max = 1
     }
    Input("ROFF",5,56,241,12,2)
     {
     Desc = "Breaker Open Resistance"
     Def = "1.0e8"
     Data = Real
     Unit = "ohm"
     Len = 15
     Min = 1
     }
    Input("RON",5,72,241,12,2)
     {
     Desc = "Breaker Closed  Resistance"
     Def = "0.001"
     Data = Real
     Unit = "ohm"
     Len = 15
     Min = 0.001
     }
    Choice("OPCUR",5,92,241,11,2)
     {
     Style = 0
     Desc = "Open at crossing level or at any current?"
     Def = "0"
     Len = 25
     *0 = "Open Only at Crossing"
     *1 = "Open Immediately"
     }
    Input("CLVL",5,108,241,12,2)
     {
     Desc = "Current chopping limit"
     Def = "0.0"
     Data = Real
     Unit = "kA"
     Len = 15
     Cond = "OPCUR==0"
     }
    Input("XSw",5,128,241,12,2)
     {
     Desc = "Switch Reactance (pu)"
     Def = "0.0"
     Data = Real
     Unit = "pu"
     Len = 15
     }
    Input("VRated",5,144,241,12,2)
     {
     Desc = "Rated Voltage (kV,LL,rms)"
     Def = "230.0"
     Data = Real
     Unit = "kV"
     Len = 15
     }
    Input("MVA",5,160,241,12,2)
     {
     Desc = "Rated MVA"
     Def = "100"
     Data = Real
     Unit = "MVA"
     Len = 15
     }
    Input("F",5,176,241,12,2)
     {
     Desc = "Rated Frequency"
     Def = "60.0"
     Data = Real
     Unit = "Hz"
     Len = 15
     }
    Input("TS",5,196,241,12,2)
     {
     Desc = "Power Measurement Smoothing Time Constant"
     Def = "0.02"
     Data = Real
     Unit = "sec"
     Len = 15
     }
    Choice("DisPQ",5,214,241,11,2)
     {
     Style = 0
     Desc = "Display Power Flow"
     Def = "0"
     Len = 21
     *0 = "No"
     *1 = "Yes"
     }
    Choice("SwType",5,230,241,11,2)
     {
     Style = 0
     Desc = "Switch Type"
     Def = "0"
     Len = 21
     *0 = "Generic Switch"
     *1 = "Circuit Breaker"
     *2 = "Disconnect"
     }
    Choice("PSCADV",5,248,241,11,2)
     {
     Style = 0
     Desc = "PSCAD Version"
     Def = "0"
     Len = 21
     *0 = "Old PSCAD (V4.2.1 or older)"
     *1 = "New PSCAD (V4.5 or higher)"
     }
    }
   Category("Internal Outputs")
    {
    Text("IBRA",6,3,243,12,2)
     {
     Desc = "Name for Breaker Current, A (kA)"
     Len = 20
     }
    Text("IBRB",6,17,243,12,2)
     {
     Desc = "Name for Breaker Current, B (kA)"
     Len = 20
     }
    Text("IBRC",6,30,243,12,2)
     {
     Desc = "Name for Breaker Current, C (kA)"
     Len = 20
     }
    Text("IBR0",6,44,243,12,2)
     {
     Desc = "Name for Calculated Zero Seq. Current (kA)"
     Len = 20
     }
    Text("SBRA",6,58,243,12,2)
     {
     Desc = "Name for Breaker A Status"
     Len = 20
     }
    Text("SBRB",6,72,243,12,2)
     {
     Desc = "Name for Breaker B Status"
     Len = 20
     }
    Text("SBRC",6,86,243,12,2)
     {
     Desc = "Name for Breaker C Status"
     Len = 20
     }
    Text("BP",6,100,243,12,2)
     {
     Desc = "Name for Active Power"
     Len = 20
     }
    Text("BQ",6,114,243,12,2)
     {
     Desc = "Name for Reactive Power"
     Len = 20
     }
    }
   Category("Animation States")
    {
    Choice("BOpen1",6,2,238,11,2)
     {
     Style = 0
     Desc = "Breaker A state"
     Def = "0"
     Len = 15
     *0 = "close"
     *1 = "open"
     }
    Choice("BOpen2",6,16,238,11,2)
     {
     Style = 0
     Desc = "Breaker B state"
     Def = "0"
     Len = 15
     *0 = "close"
     *1 = "open"
     }
    Choice("BOpen3",6,30,238,11,2)
     {
     Style = 0
     Desc = "Breaker C state"
     Def = "0"
     Len = 15
     *0 = "close"
     *1 = "open"
     }
    Text("P",5,56,237,12,2)
     {
     Desc = "Real Power Measured"
     Def = "0.0"
     Len = 15
     }
    Text("Q",5,72,237,12,2)
     {
     Desc = "Reactive Power Measured"
     Def = "0.0"
     Len = 15
     }
    }
   }

  Nodes = 
   {
   Electrical("N1",54,0)
    {
    Dim  = [3]
    }
   Electrical("N2",-54,0)
    {
    Dim  = [3]
    }
   Electrical("N3",0,0)
    {
    Cond = "( abs(XSw) > 1.0E-10 )&&(PSCADV<=0)"
    Dim  = [3]
    }
   Electrical("N3",0,0)
    {
    Cond = "( (XSw > 0.000001)||(XSw < -0.000001) )&&(PSCADV<=0)"
    Dim  = [3]
    }
   }

  Graphics = 
   {
   Pen(Red,,ByNode,N1)
   Cond = "((BOpen1==0)||(BOpen2==0)||(BOpen3==0))"
   Line(6,0,54,0)
   Pen(,,,N2)
   Line(-54,0,-6,0)
   Pen(Black,,0.2)
   Cond = "(SwType==1)"
   Rectangle(-6,-7,6,7)
   Pen(,,0.4)
   Cond = "true"
   Line(-6,-11,-3,-8)
   Line(-3,-14,-6,-11)
   Line(-6,-11,6,-11)
   Font(,,Left)
   Cond = "DisPQ==1"
   Text(-24,-18,"%Q MVAR")
   Text(-24,-31,"%P MW")
   Font(,,Centre)
   Cond = "true"
   Text(14,-5,"E")
   Pen(Red,,ByNode)
   Cond = "((SwType==2)||(SwType==0))&&((BOpen1==0)||(BOpen2==0)||(BOpen3==0))"
   Line(-5,0,5,0)
   Pen(,,0.2)
   Brush(Solid,Red)
   Cond = "(SwType==1)&&(BOpen1==0)"
   Rectangle(-5,-6,5,-2)
   Cond = "(SwType==1)&&(BOpen2==0)"
   Rectangle(-5,-2,5,2)
   Cond = "(SwType==1)&&(BOpen3==0)"
   Rectangle(-5,2,5,6)
   Pen(Lime)
   Brush(,Lime)
   Cond = "(SwType==1)&&(BOpen1!=0)"
   Rectangle(-5,-6,5,-2)
   Cond = "(SwType==1)&&(BOpen2!=0)"
   Rectangle(-5,-2,5,2)
   Cond = "(SwType==1)&&(BOpen3!=0)"
   Rectangle(-5,2,5,6)
   Pen(,,ByNode)
   Cond = "((SwType==2)||(SwType==0))&&((BOpen1!=0)&&(BOpen2!=0)&&(BOpen3!=0))"
   Line(-6,0,3,-9)
   Line(2,0,7,0)
   Pen(Red,DotDashed)
   Cond = "((SwType==2)||(SwType==0))&&((BOpen1!=BOpen2)||(BOpen2!=BOpen3)||(BOpen3!=BOpen1))"
   Line(2,-7,5,0)
   Pen(Lime,Solid)
   Cond = "((BOpen1!=0)&&(BOpen2!=0)&&(BOpen3!=0))"
   Line(-54,0,-6,0)
   Pen(,,,N1)
   Line(6,0,54,0)
   Pen(Red,,,N2)
   Cond = "((SwType==2)||(SwType==0))&&((BOpen1!=BOpen2)||(BOpen2!=BOpen3)||(BOpen3!=BOpen1))"
   Line(-6,0,3,-9)
   Pen(Black,,0.2)
   Brush(,Black)
   Cond = "(SwType==2)||(SwType==0)"
   Ellipse(4,-1,7,1)
   Ellipse(-7,-1,-4,1)
   }

  Section(EMTDC)
   {
   Checks = "\
ERROR Open Resistance must be greater than Closed resistance : (ROFF>RON)
ERROR On Resistance must be greater than 0.001 ohms : (RON>=0.001)"
   Branch = "\
#IF ( PSCADV >= 1 )
    BR  = $N1 $N2     BREAKER  $ROFF
#ELSE
  #IF ( (XSw > 0.000001)||(XSw < -0.000001) )
    BR  = $N1 $N3     BREAKER  $ROFF
    #IF ( XSw > 0.0 )
       BRX  = $N3 $N2     0.0  $LSw 0.0
    #ELSE
       BRX  = $N3 $N2     0.0  0.0 $CSw
    #END
  #ELSE
    BR  = $N1 $N2     BREAKER  $ROFF
  #END
#END"
   Dsdyn = "\
#LOCAL INTEGER B_Stta
#LOCAL INTEGER B_Sttb
#LOCAL INTEGER B_Sttc
#LOCAL INTEGER NSTORI_SAVE
#STORAGE INTEGER:3
#LOCAL REAL R_1(3),L_1,C_1
#LOCAL INTEGER Enable_RLC(3)
      NSTORI_SAVE = NSTORI
      NSTORI = NSTORI + 3
      CALL Electranix_Switch($SS,$N1,$N2,$BR(1),$BR(2),$BR(3),$NAMEA,$NAMEB,$NAMEC,$OPCUR,$SwType,$ROFF,$RON,$CLVL,$XSw,$VRated,$MVA,$F,B_Stta,B_Sttb,B_Sttc,Enable_RLC,R_1,L_1,C_1)
#IF (PSCADV>=1)
      CALL E_VARIMPBRANCH($BR(1),$SS,Enable_RLC(1),Enable_RLC(2),Enable_RLC(3),R_1(1),L_1,C_1)
      CALL E_VARIMPBRANCH($BR(2),$SS,Enable_RLC(1),Enable_RLC(2),Enable_RLC(3),R_1(2),L_1,C_1)
      CALL E_VARIMPBRANCH($BR(3),$SS,Enable_RLC(1),Enable_RLC(2),Enable_RLC(3),R_1(3),L_1,C_1)
#ELSE
      CALL EMTDC_VARRLC10( $BR(1),$SS , 0 , RVD1_1 ,R_1(1), 0.0)
      CALL EMTDC_VARRLC10( $BR(2),$SS , 0 , RVD1_1 ,R_1(2), 0.0)
      CALL EMTDC_VARRLC10( $BR(3),$SS , 0 , RVD1_1 ,R_1(3), 0.0)
#ENDIF

      IF (FIRSTSTEP .OR. (STORI(NSTORI_SAVE+0) .NE. B_Stta)) THEN
         CALL PSCAD_AGI($#Component,B_Stta,\"BOpen1\")
      ENDIF
      IF (FIRSTSTEP .OR. (STORI(NSTORI_SAVE+1) .NE. B_Sttb)) THEN
         CALL PSCAD_AGI($#Component,B_Sttb,\"BOpen2\")
      ENDIF
      IF (FIRSTSTEP .OR. (STORI(NSTORI_SAVE+2) .NE. B_Sttc)) THEN
         CALL PSCAD_AGI($#Component,B_Sttc,\"BOpen3\")
      ENDIF
! Save Breaker Animation States
      STORI(NSTORI_SAVE+0)=B_Stta
      STORI(NSTORI_SAVE+1)=B_Sttb
      STORI(NSTORI_SAVE+2)=B_Sttc
#OUTPUT INTEGER SBRA {B_Stta}
#OUTPUT INTEGER SBRB {B_Sttb}
#OUTPUT INTEGER SBRC {B_Sttc}"
   Monitoring = "\
Ch1: Menu=\"$IBRA\"
Ch2: Menu=\"$IBRB\"
Ch3: Menu=\"$IBRC\""
   Dsout = "\
! Three Phase Breaker Currents
#OUTPUT REAL IBRA {$CBR:BR(1)}
#OUTPUT REAL IBRB {$CBR:BR(2)}
#OUTPUT REAL IBRC {$CBR:BR(3)}
#OUTPUT REAL IBR0 {$CBR:BR(1)+$CBR:BR(2)+$CBR:BR(3))/3.0}

! Three Phase Breaker PQ Measurement
#STORAGE STOR:4
#FUNCTION REAL P3PH2 Three Phase Real Power Meter
#FUNCTION REAL Q3PH2 Three Phase Reactive Power Meter
#LOCAL REAL P_1
#LOCAL REAL Q_1


#IF (PSCADV>=1)
      P_1 = P3PH2($SS,$N2(1),$N2(2),$N2(3),$N1(1),$N1(2),$N1(3),$TS)
      Q_1 = Q3PH2($SS,$N2(1),$N2(2),$N2(3),$N1(1),$N1(2),$N1(3),$TS)
#ELSE
   #IF ( abs(XSw)>0.000001)
      P_1 = P3PH2($SS,$N3(1),$N3(2),$N3(3),$N1(1),$N1(2),$N1(3),$TS)
      Q_1 = Q3PH2($SS,$N3(1),$N3(2),$N3(3),$N1(1),$N1(2),$N1(3),$TS)
   #ELSE
      P_1 = P3PH2($SS,$N2(1),$N2(2),$N2(3),$N1(1),$N1(2),$N1(3),$TS)
      Q_1 = Q3PH2($SS,$N2(1),$N2(2),$N2(3),$N1(1),$N1(2),$N1(3),$TS)
   #END
#ENDIF




!
#IF DisPQ==1
      IF (UPDATE_AG) THEN
        CALL PSCAD_AGRG($#Component,P_1,\"P\")
        CALL PSCAD_AGRG($#Component,Q_1,\"Q\")
      ENDIF
#ENDIF
#OUTPUT REAL BP {P_1}
#OUTPUT REAL BQ {Q_1}"
   COMPUTATIONS = "\
LSw = (XSw>1.0E-6) ? XSw*(VRated*VRated/MVA)/(2.0*pi*F) : 0.0
CSw = (XSw<-1.0E-6) ? 1.0E6/((-1.0*Xsw)*(VRated*VRated/MVA))/(2.0*pi*F) : 0.0
"
   }
  }
 Module("Main")
  {
  Desc = "Main Page"
  FileDate = 0
  Nodes = 
   {
   }

  Graphics = 
   {
   Rectangle(-18,-18,18,18)
   }


  Page(B/A3,Landscape,16,[1280,678],100)
   {
   0.annotation([522,216],0,0,-1)
    {
    AL1 = "Generator"
    AL2 = ""
    }
   0.annotation([972,378],0,0,-1)
    {
    AL1 = "Transformer"
    AL2 = ""
    }
   0.annotation([972,540],0,0,-1)
    {
    AL1 = "Meter for V,Angle,P,Q"
    AL2 = ""
    }
   0.annotation([522,378],0,0,-1)
    {
    AL1 = "PI Section"
    AL2 = ""
    }
   0.annotation([342,504],0,0,-1)
    {
    AL1 = "1 Phase to 3 Phase"
    AL2 = "Converter"
    }
   .Electranix_NodeExport([126,468],0,0,-1)
    {
    }
   0.annotation([522,540],0,0,-1)
    {
    AL1 = "Load Model"
    AL2 = ""
    }
   0.annotation([144,504],0,0,-1)
    {
    AL1 = "Node Export Symbol"
    AL2 = "(this node continues on a sub-page)"
    }
   0.annotation([738,378],0,0,-1)
    {
    AL1 = "Series Capacitor"
    AL2 = ""
    }
   0.annotation([972,216],0,0,-1)
    {
    AL1 = ""
    AL2 = "Phase Locked Loop"
    }
   0.annotation([738,216],0,0,-1)
    {
    AL1 = "DC Link"
    AL2 = "(non-switching model)"
    }
   .Electranix_1to3([324,468],0,0,-1)
    {
    F = "60.0 [Hz]"
    SrcTyp = "1"
    PhAdv1 = "0"
    PhAdv2 = "1"
    R1 = "1.0 [ohm]"
    R2 = "1.0 [ohm]"
    View = "1"
    }
   0.annotation([756,540],0,0,-1)
    {
    AL1 = "Switched Shunt"
    AL2 = ""
    }
   0.annotation([1188,378],0,0,-1)
    {
    AL1 = "Phase Shifting Transformer"
    AL2 = ""
    }
   0.annotation([1206,234],0,0,-1)
    {
    AL1 = "Transfer of Information Between Pages"
    AL2 = ""
    }
   .Electranix_DCLink([738,180],0,0,-1)
    {
    Name = "DC1"
    VDCRATED = "100.0 [kV]"
    IDCRATED = "1.0 [kA]"
    DCR = "1.0 [ohm]"
    DCL = "0.0 [Henries]"
    BLOCK = "1"
    DIR = "1"
    PLOC = "0"
    FastInit = "1"
    Control = "0"
    View = "1"
    Enable = "1"
    AUNITS = "0"
    FR1 = "60.0 [Hz]"
    VBASE1 = "230.0 [kV]"
    VVBASE1 = "40.0 [kV]"
    NG1 = "2"
    X1 = "0.1 [pu]"
    TMVA1 = "60.0 [MVA]"
    TAP1 = "1.0"
    TAUV1 = "0.01 [sec]"
    TAUI1 = "0.01 [sec]"
    SR1 = "0.1 [H]"
    ACMAG1 = "1.0 [pu]"
    ACPHASE1 = "0.0 [°]"
    FR2 = "60.0 [Hz]"
    VBASE2 = "230.0 [kV]"
    VVBASE2 = "40.0 [kV]"
    NG2 = "2"
    X2 = "0.1 [pu]"
    TMVA2 = "60.0 [MVA]"
    TAP2 = "1.0"
    TAUV2 = "0.01 [sec]"
    TAUI2 = "0.01 [sec]"
    SR2 = "0.1 [H]"
    ACMAG2 = "1.0 [pu]"
    ACPHASE2 = "0.0 [°]"
    PORI = "0"
    PILEVEL = "1.0 [pu]"
    SCHEDDCV = "1.0 [pu]"
    TAUVMEAS = "1.0 [sec]"
    VDCLVHI = "0.8 [pu]"
    VDCLVLO = "0.4 [pu]"
    VDCLILO = "0.3 [pu]"
    VDCLRATE = "5.0 [pu/sec]"
    VDCLOFFSET = "0.2 [pu]"
    GPR = "0.2"
    TIR = "0.05"
    ALPHAMINR = "0.0 [°]"
    ALPHAMAXR = "140.0 [°]"
    IMARGINR = "0.0 [pu]"
    VMARGINR = "0.1 [pu]"
    ALINITR = "90.0 [°]"
    RGAINIR = "1.0 [pu]"
    RGAINVR = "1.0 [pu]"
    GPI = "0.2"
    TII = "0.05"
    ALPHAMINI = "90.0 [°]"
    ALPHAMAXI = "160.0 [°]"
    GAMMANOMI = "18.0 [°]"
    IMARGINI = "0.1 [pu]"
    VMARGINI = "0.0 [pu]"
    GMARGINI = "5.0 [°]"
    ALINITI = "90.0 [°]"
    RGAINII = "1.0 [pu]"
    RGAINVI = "1.0 [pu]"
    RGAINGI = "1.0 [pu]"
    COMFAIL = "2"
    CFVLEVEL = "0.5 [pu]"
    CFGLEVEL = "8.0 [°]"
    CFDUR = "0.02 [sec]"
    PAC1 = ""
    QAC1 = ""
    VDC1 = ""
    IDC1 = ""
    GAMMA1 = ""
    U1 = ""
    ALPHAOUT1 = ""
    IORDER1 = ""
    MODE1 = ""
    PAC2 = ""
    QAC2 = ""
    VDC2 = ""
    IDC2 = ""
    GAMMA2 = ""
    U2 = ""
    ALPHAOUT2 = ""
    IORDER2 = ""
    MODE2 = ""
    }
   .Electranix_SwitchedShunt([702,504],0,0,-1)
    {
    Name = "SwitchShunt 1"
    PO = "0.0 [MW]"
    QO = "25.0 [MVAR]"
    FR = "60.0 [Hz]"
    VBO = "230.0 [KV]"
    VO = "1.0 [p.u.]"
    Enable = "1"
    View = "1"
    PL = ""
    QL = ""
    INAME = ""
    Pdisplay = "0.0"
    Qdisplay = "0.0"
    }
   .Electranix_singlephase_rms([972,216],0,0,-1)
    {
    VBase = "230.0 [kV]"
    FINIT = "50.0 [Hz]"
    REFPH = "REFPH"
    PHASE = ""
    View = "0"
    }
   .Electranix_Init_Conditions([594,684],0,0,-1)
    {
    Type = "-1"
    Shift = "0"
    NumMac = "1.0"
    Volts = "1.0 [pu]"
    Phase = "0 [°]"
    P = "0.0 [MW]"
    Q = "0 [MVAR]"
    }
   .Electranix_Common_Set([1134,180],0,0,-1)
    {
    Name = "X1"
    Type = "0"
    Dim = "1"
    Index = "1"
    Com = "0"
    Port = "2000"
    TStart = "1.0 [sec]"
    }
   .Electranix_Common_Get([1242,180],0,0,-1)
    {
    Name = "X1"
    Type = "0"
    Dim = "1"
    Index = "1"
    Com = "0"
    Port = "2000"
    TStart = "1.0 [sec]"
    Interp = "0"
    }
   .Electranix_SeriesCapacitor([738,342],0,0,-1)
    {
    Name = "Br1"
    MVA2 = "100.0 [MVA]"
    F = "60.0 [Hz]"
    VR2 = "230.0 [kV]"
    RPUP2 = "0.00336786 [p.u.]"
    XLPUP2 = "0.0593346 [p.u.]"
    Ideal = "0"
    Enable = "1"
    View = "1"
    GI = "0.0 [p.u.]"
    BI = "0.0 [p.u.]"
    GJ = "0.0 [p.u.]"
    BJ = "1.0 [p.u.]"
    }
   .Electranix_meter_1phase([954,504],0,0,-1)
    {
    PQMon = "1"
    PU = "0"
    VBase = "230.0 [kV]"
    MVABase = "100.0 [MVA]"
    FINIT = "60.0 [Hz]"
    F_NAME = ""
    Irms = ""
    Iphase = ""
    View = "0"
    }
   .Electranix_Gen([486,180],0,0,-1)
    {
    Name = "Source1"
    MVA = "100.0 [MVA]"
    F = "60.0 [Hz]"
    VBASE = "230.0 [kV]"
    Imped = "1"
    RPU = "0.0 [pu]"
    XPU = "0.01 [pu]"
    VType = "1"
    TInit = "0.05 [sec]"
    Enable = "1"
    View = "1"
    ZeroSeq = "0"
    RPU0 = ".0 [pu]"
    XPU0 = ".0 [pu]"
    Dynamic = "0"
    CUR = ""
    V = "1.0 [pu]"
    Phase = "0.0 [°]"
    POUT = "0.0 [MW]"
    QOUT = "0.0 [MVAR]"
    Port = "2000"
    Vterm = ""
    ANGterm = ""
    POutI = ""
    QOutI = ""
    ConvergeError = ""
    }
   .Electranix_Init_Tap([594,774],0,0,-1)
    {
    TapSide = "-1"
    Tap = "1.0"
    }
   -Sticky-([18,576],0)
    {
    Name = ""
    Font = 1
    Bounds = 18,576,414,882
    Alignment = 0
    Style = 1
    Arrow = 0
    Color = 0,15792890
    Text = "\
Substitution Library Syntax:
E_frombus_tobus_ckt (for example, E_123_456_T1)

E_ General (will substitute anything with anything)
L_ Loads (only substitute shunt loads)
G_ Generator (only substitute generators)
B_ Branch (only substitute series branches (not transformers))     
T_ Transformer (only substitute transformers)
S_ SwitchedShunt (only substitute switched shunts)
F_ FixedShunt (only substitute fixed shunts)
D_ DC Link (only substitute DC links)

Substition works for:
- Page components (set the page component definition name),
- Tlines (set the tline sub-page to B_frbus_tobus_ckt), or 
- any low-level component definition (set the NAME parameter)




"
    }
   -Sticky-([18,18],0)
    {
    Name = ""
    Font = 1
    Bounds = 18,18,450,432
    Alignment = 0
    Style = 1
    Arrow = 0
    Color = 0,15792890
    Text = "\
E-TRAN PSCAD Library - Version 5.0.0.6 - April 27, 2018

This library is required to run cases translated by
E-TRAN (PSSE to PSCAD for example).

Input data has been standardized as follows:
- Voltages (kV, L-L, RMS)
- MVA (3 phase MVA)
- P,Q (MW,MVAR, 3 phase)
- Impedances (R,X,B in per unit)


Electranix Corporation

For updates, please see http://www.electranix.com/E-TRAN            
Contact us at E-TRAN@electranix.com

Note: This E-TRAN.psl library must be used with an
E-TRAN.lib of the same version.  Check the E-TRAN version in RunTime Messages, and compare to the version above.

This library includes components for:
- E-TRAN Plus for PSSE (hybrid simulation between PSCAD and PSSE)
- E-TRAN Plus for PSCAD (parallel processing interface between PSCAD cases)
E-TRAN Plus products require a separate license.


"
    }
   .Electranix_Pi([522,342],0,0,-1)
    {
    Name = "Line1"
    MVA2 = "100.0 [MVA]"
    F = "60.0 [Hz]"
    VR2 = "230.0 [kV]"
    RPUP2 = "0.00336786 [p.u.]"
    XLPUP2 = "0.0593346 [p.u.]"
    BPUP2 = "0.193387 [p.u.]"
    len = "100.0"
    Enable = "1"
    View = "1"
    Ideal = "0"
    ZeroSeq = "0"
    RPUZ2 = "0.0 [p.u.]"
    XLPUZ2 = "0.0 [p.u.]"
    BPUZ2 = "0.0 [p.u.]"
    GI = "0"
    BI = "0"
    GJ = "0"
    BJ = "0"
    GI0 = "0.0 [p.u.]"
    BI0 = "0.0 [p.u.]"
    GJ0 = "0.0 [p.u.]"
    BJ0 = "0.0 [p.u.]"
    }
   .Electranix_Init_DCLink([594,864],0,0,-1)
    {
    RTapSide = "0"
    ITapSide = "0"
    TapR = "1.0"
    TapI = "1.0"
    }
   0.annotation([1170,522],0,0,-1)
    {
    AL1 = "Line Shunt L or C"
    AL2 = "(used only with Bergeron lines)"
    }
   0.annotation([594,900],0,0,-1)
    {
    AL1 = "Transfer Initial Conditions from Loadflow"
    AL2 = "(use these components to use initialize custom models)"
    }
   .Electranix_Error([1368,504],0,0,-1)
    {
    Type = "1"
    Write1 = "0"
    Message = "Message Text"
    }
   0.annotation([1386,522],0,0,-1)
    {
    AL1 = "Outputs Warning Messages"
    AL2 = "or Error Messages (and Stops)"
    }
   .Electranix_remote_vmeas_set([1386,648],0,0,-1)
    {
    VBase = "230.0 [kV]"
    FINIT = "60.0 [Hz]"
    BUS = "1"
    Enable = "1"
    }
   .Electranix_remote_vmeas_get([1386,612],0,0,-1)
    {
    BUS = "1"
    Enable = "1"
    }
   .Electranix_PSSE_Exciter_Models([972,720],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Model = "48"
    Bus = "1000"
    Ckt = "1"
    VUEL = "1"
    VOEL = "1"
    Comp = "4"
    QELEC = "Q"
    Wpu = "Wpu"
    }
   .Electranix_PSSE_Governors([954,972],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Model = "20"
    Bus = "1000"
    Ckt = "1"
    TE = "TE"
    MBASE = "120.0 [MVA]"
    SBASE = "100.0 [MVA]"
    TI = "10000.0 [sec]"
    }
   .Electranix_PSSE_Machine([990,846],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Model = "4"
    Bus = "1000"
    Ckt = "1"
    machsw = "1"
    Enab = "1"
    Vbase = "10.0 [kV]"
    MVA = "100.0 [MVA]"
    Fbase = "60.0 [Hz]"
    MM = "1"
    SAT = "1"
    RPU = "0.0 [pu]"
    XPU = "0.1 [pu]"
    VT = "1.0 [p.u.]"
    Pheta = "0.0 [°]"
    P0 = "0.0 [MW]"
    Q0 = "0.0 [MVAR]"
    RAMPTIME = "0.1 [sec]"
    POut = ""
    QOut = ""
    Vneut = ""
    Cneut = ""
    Lang = ""
    Theta = ""
    Wang = ""
    }
   .Electranix_PSSE_Stabilizers([846,684],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Model = "2"
    Bus = "1000"
    Ckt = "1"
    VT = "#NaN"
    NumIN = "2"
    }
   -Wire-([1098,954],0,0,-1)
    {
    Vertex="0,0;0,-36"
    }
   -Wire-([900,738],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.realpole([882,774],4,0,220)
    {
    Limit = "1"
    COM = "Real_Pole"
    Reset = "0"
    YO = "0.0"
    G = "1.0"
    T = "0.05 [sec]"
    Max = "10.0"
    Min = "-10.0"
    }
   0.realpole([1062,918],0,0,220)
    {
    Limit = "1"
    COM = "Real_Pole"
    Reset = "0"
    YO = "0.0"
    G = "1.0"
    T = "0.05 [sec]"
    Max = "10.0"
    Min = "-10.0"
    }
   -Wire-([1098,954],0,0,-1)
    {
    Vertex="0,0;-72,0"
    }
   0.datalabel([846,630],6,0,-1)
    {
    Name = "EnabExc"
    }
   0.datalabel([900,990],0,0,-1)
    {
    Name = "EnabGov"
    }
   0.datalabel([954,666],6,0,-1)
    {
    Name = "EnabExc"
    }
   0.const([936,612],0,0,-1)
    {
    Name = ""
    Value = "1.0"
    }
   0.datalabel([990,612],6,0,-1)
    {
    Name = "VREF"
    }
   -Wire-([900,990],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.const([900,1044],0,0,-1)
    {
    Name = ""
    Value = "1.0"
    }
   0.datalabel([954,1044],0,0,-1)
    {
    Name = "WREF"
    }
   0.annotation([954,1080],0,0,-1)
    {
    AL1 = "PSS/E Compatible Exciters, Governors, Machines and Stabilizers"
    AL2 = "These models read data from the PSS/E .dyr file."
    }
   0.annotation([954,1116],0,0,-1)
    {
    AL1 = "E-TRAN will automatically translate the .dyr file"
    AL2 = "and generate a sub-page for each machine..."
    }
   0.annotation([1368,666],0,0,-1)
    {
    AL1 = "Remote bus voltage measurement functions"
    AL2 = "(these are used by E-TRAN for exciters and stabilizer inputs, REMCMP etc...)"
    }
   .Electranix_volt_stab_detect([1386,756],0,0,-1)
    {
    VTHRESH = "100000.0 [kV]"
    ITHRESH = "100000.0 [kA]"
    }
   0.annotation([1368,792],0,0,-1)
    {
    AL1 = "This component checks for any voltage or current"
    AL2 = "which is above a threshold, generates an error then exits..."
    }
   .Electranix_ReadPSSEDYR([288,1026],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Model = "HYGOV"
    Bus = "11111"
    Ckt = "1"
    USRMDL = "0"
    Dim = "1"
    }
   0.annotation([234,1080],0,0,-1)
    {
    AL1 = "Model which can be used to read in any PSS/E .dyr"
    AL2 = "model and output it for use in a custom model..."
    }
   -Wire-([342,1026],0,0,-1)
    {
    Vertex="0,0;54,0"
    }
   0.datalabel([378,1026],6,0,-1)
    {
    Name = "NData"
    }
   0.datatap([414,1062],0,0,20)
    {
    Index = "1"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([414,1098],0,0,30)
    {
    Index = "2"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   -Wire-([396,1044],0,0,-1)
    {
    Vertex="0,0;0,144"
    }
   0.datatap([414,1134],0,0,40)
    {
    Index = "3"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([414,1170],0,0,50)
    {
    Index = "4"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([414,1206],0,0,70)
    {
    Index = "5"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   -Wire-([594,1044],0,0,-1)
    {
    Vertex="0,0;-252,0"
    }
   -Wire-([414,1062],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([432,1062],6,0,-1)
    {
    Name = "Rperm"
    }
   -Wire-([414,1098],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([432,1098],6,0,-1)
    {
    Name = "Rtemp"
    }
   -Wire-([414,1134],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([432,1134],6,0,-1)
    {
    Name = "TR"
    }
   -Wire-([414,1170],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([432,1170],6,0,-1)
    {
    Name = "TF"
    }
   -Wire-([414,1206],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([432,1206],6,0,-1)
    {
    Name = "TG"
    }
   0.datatap([504,1062],0,0,20)
    {
    Index = "6"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([504,1098],0,0,30)
    {
    Index = "7"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   -Wire-([486,1044],0,0,-1)
    {
    Vertex="0,0;0,144"
    }
   0.datatap([504,1134],0,0,40)
    {
    Index = "8"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([504,1170],0,0,50)
    {
    Index = "9"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([504,1206],0,0,70)
    {
    Index = "10"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   -Wire-([504,1062],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([522,1062],6,0,-1)
    {
    Name = "VELM"
    }
   -Wire-([504,1098],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([522,1098],6,0,-1)
    {
    Name = "GMAX"
    }
   -Wire-([504,1134],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([522,1134],6,0,-1)
    {
    Name = "GMIN"
    }
   -Wire-([504,1170],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([522,1170],6,0,-1)
    {
    Name = "TW"
    }
   -Wire-([504,1206],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([522,1206],6,0,-1)
    {
    Name = "AT"
    }
   0.datatap([594,1062],0,0,20)
    {
    Index = "11"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   0.datatap([594,1098],0,0,30)
    {
    Index = "12"
    Dim = "1"
    Type = "2"
    Style = "0"
    Disp = "1"
    }
   -Wire-([576,1044],0,0,-1)
    {
    Vertex="0,0;0,36"
    }
   -Wire-([594,1062],0,0,-1)
    {
    Vertex="0,0;36,0"
    }
   0.datalabel([630,1062],6,0,-1)
    {
    Name = "DTURB"
    }
   -Wire-([594,1098],0,0,-1)
    {
    Vertex="0,0;36,0"
    }
   0.datalabel([630,1098],6,0,-1)
    {
    Name = "QNL"
    }
   0.datalabel([378,1044],6,0,-1)
    {
    Name = "DATA1"
    }
   .Electranix_Compounding_VRef([1440,1026],0,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Comp = "1"
    Bus = "1000"
    Ckt = "1"
    MVA = "100.0 [MVA]"
    NumMac = "1.0"
    }
   -Wire-([936,1044],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   -Wire-([954,1044],0,0,-1)
    {
    Vertex="0,0;0,-18"
    }
   -Wire-([990,666],0,0,-1)
    {
    Vertex="0,0;0,-54"
    }
   -Wire-([990,612],0,0,-1)
    {
    Vertex="0,0;-18,0"
    }
   -Wire-([846,774],0,0,-1)
    {
    Vertex="0,0;0,-36"
    }
   -Wire-([846,738],0,0,-1)
    {
    Vertex="0,0;54,0"
    }
   -Wire-([1026,774],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   -Wire-([1044,774],0,0,-1)
    {
    Vertex="0,0;0,-36"
    }
   -Wire-([1044,738],0,0,-1)
    {
    Vertex="0,0;-18,0"
    }
   .Electranix_PSSE_Shaf25([882,846],3,0,-1)
    {
    FName = "..\\inputfile.dyr"
    Bus = "1000"
    Ckt = "1"
    FR = "60.0 [Hz]"
    Output = "1"
    MD12 = "0.0 [pu]"
    MD23 = "0.0 [pu]"
    MD34 = "0.0 [pu]"
    MD45 = "0.0 [pu]"
    MD56 = "0.0 [pu]"
    MD67 = "0.0 [pu]"
    MD78 = "0.0 [pu]"
    MD89 = "0.0 [pu]"
    MD910 = "0.0 [pu]"
    MD1011 = "0.0 [pu]"
    MD1112 = "0.0 [pu]"
    MD1213 = "0.0 [pu]"
    MD1314 = "0.0 [pu]"
    MD1415 = "0.0 [pu]"
    MD1516 = "0.0 [pu]"
    MD1617 = "0.0 [pu]"
    MD1718 = "0.0 [pu]"
    MD1819 = "0.0 [pu]"
    MD1920 = "0.0 [pu]"
    MD2021 = "0.0 [pu]"
    MD2122 = "0.0 [pu]"
    MD2223 = "0.0 [pu]"
    MD2324 = "0.0 [pu]"
    MD2425 = "0.0 [pu]"
    W = ""
    Angle = ""
    TS = ""
    }
   0.annotation([1440,1080],0,0,-1)
    {
    AL1 = "Voltage Compounding"
    AL2 = "Models"
    }
   0.annotation([1260,1152],0,0,-1)
    {
    AL1 = "Static and Dynamic Control"
    AL2 = "of Switched Shunt Reactors or Capacitors"
    }
   0.annotation([1260,1188],0,0,-1)
    {
    AL1 = "Voltage Control, SVC Control or Manual Control"
    AL2 = ""
    }
   .Electranix_Switched_Shunt_Control([1242,954],0,0,-1)
    {
    Mode = "1"
    NumL = "1"
    MVARL = "10.0 [MVAR]"
    NumC = "8"
    MVARC = "10.0 [MVAR]"
    TStart = "1.0"
    EnableD = "1.0"
    TDelay = "0.1 [sec]"
    VHigh = "1.05 [pu]"
    VLow = "0.95 [pu]"
    AlphaHigh = "170.0 [°]"
    AlphaLow = "100.0 [°]"
    }
   .xfmr_2w_scaled([360,1458],0,0,-1)
    {
    Name = "T32"
    Tmva = "100.0 [MVA]"
    f = "60.0 [Hz]"
    YD1 = "0"
    YD2 = "1"
    Lead = "1"
    Xl = "0.1 [pu]"
    Ideal = "0"
    NLL = "0.0 [pu]"
    CuL = "0.0 [pu]"
    Tap = "0"
    View = "2"
    Dtls = "0"
    V1 = "230.0 [kV]"
    V2 = "115.0 [kV]"
    Enab = "0"
    Sat = "1"
    Xair = "0.2 [pu]"
    Tdc = "1.0 [s]"
    Xknee = "1.25 [pu]"
    Txk = "0.1 [s]"
    Im1 = "0.4 [%]"
    ILA1 = ""
    ILB1 = ""
    ILC1 = ""
    IAB1 = ""
    IBC1 = ""
    ICA1 = ""
    ILA2 = ""
    ILB2 = ""
    ILC2 = ""
    IAB2 = ""
    IBC2 = ""
    ICA2 = ""
    IMA = ""
    IMB = ""
    IMC = ""
    FLXA = ""
    FLXB = ""
    FLXC = ""
    IMAB = ""
    IMBC = ""
    IMCA = ""
    FLXAB = ""
    FLXBC = ""
    FLXCA = ""
    }
   0.source3([180,1512],3,0,-1)
    {
    Name = "S33kV"
    Type = "4"
    Ctrl = "0"
    MVA = "100.0 [MVA]"
    Vm = "230.0 [kV]"
    F = "60.0 [Hz]"
    Tc = "0.05 [s]"
    ZSeq = "0"
    Imp = "1"
    Exph = "1"
    View = "1"
    Term = "0"
    R1s = "1.0 [ohm]"
    R1p = "1.0 [ohm]"
    L1p = "0.1 [H]"
    Z1 = "10.89 [ohm]"
    Phi1 = "85.0 [deg]"
    RN = "3.0"
    R0p = "1.0 [ohm]"
    L0p = "0.1 [H]"
    Z0 = "1.0 [ohm]"
    Phi0 = "80.0 [deg]"
    Es = "230.0 [kV]"
    F0 = "60.0 [Hz]"
    Ph = "-10.0 [deg]"
    Pinit = "0.0 [pu]"
    Qinit = "0.0 [pu]"
    VCtrl = "0"
    Vdes = "1.0 [pu]"
    Vbase = "230.0 [kV]"
    Tvm = "0.02 [s]"
    Tvc = "0.05 [s]"
    PCtrl = "0"
    Pdes = "1.0 [pu]"
    Tpm = "0.02 [s]"
    Tpc = "0.05 [s]"
    P = ""
    Q = ""
    V = ""
    Theta = ""
    Ia = ""
    Ib = ""
    Ic = ""
    }
   -Wire-([288,1458],0,0,-1)
    {
    Vertex="0,0;-54,0"
    }
   -Wire-([198,1458],0,0,-1)
    {
    Vertex="0,0;-18,0;-18,18"
    }
   0.source3([504,1512],3,0,-1)
    {
    Name = "S33kV"
    Type = "4"
    Ctrl = "0"
    MVA = "100.0 [MVA]"
    Vm = "115.0 [kV]"
    F = "60.0 [Hz]"
    Tc = "0.05 [s]"
    ZSeq = "0"
    Imp = "1"
    Exph = "1"
    View = "1"
    Term = "0"
    R1s = "1.0 [ohm]"
    R1p = "1.0 [ohm]"
    L1p = "0.1 [H]"
    Z1 = "10.89 [ohm]"
    Phi1 = "85.0 [deg]"
    RN = "3.0"
    R0p = "1.0 [ohm]"
    L0p = "0.1 [H]"
    Z0 = "1.0 [ohm]"
    Phi0 = "80.0 [deg]"
    Es = "115.0 [kV]"
    F0 = "60.0 [Hz]"
    Ph = "-25.0 [deg]"
    Pinit = "0.0 [pu]"
    Qinit = "0.0 [pu]"
    VCtrl = "0"
    Vdes = "1.0 [pu]"
    Vbase = "230.0 [kV]"
    Tvm = "0.02 [s]"
    Tvc = "0.05 [s]"
    PCtrl = "0"
    Pdes = "1.0 [pu]"
    Tpm = "0.02 [s]"
    Tpc = "0.05 [s]"
    P = ""
    Q = ""
    V = ""
    Theta = ""
    Ia = ""
    Ib = ""
    Ic = ""
    }
   0.ground([504,1548],1,0,-1)
    {
    }
   0.ground([180,1548],1,0,-1)
    {
    }
   0.ground([342,1494],1,0,-1)
    {
    }
   -Wire-([432,1458],0,0,-1)
    {
    Vertex="0,0;-36,0"
    }
   -Wire-([468,1458],0,0,-1)
    {
    Vertex="0,0;36,0;36,18"
    }
   -Sticky-([144,1242],0)
    {
    Name = ""
    Font = 1
    Bounds = 144,1242,558,1386
    Alignment = 0
    Style = 1
    Arrow = 2
    Color = 0,15792890
    Text = "\
TRANSFORMER CURRENT SCALING COMPONENT

This component scales current out of Winding 1 of the transformer to a value defined by the scaling factor applied.  Voltages are defined by the winding turns ratio and not by the scaling factor.

Transformer losses will reduce the resultant power scale.

The scale factor can be adjusted dynamically."
    }
   -Wire-([324,1422],0,0,-1)
    {
    Vertex="0,0;18,0"
    }
   0.datalabel([342,1422],2,0,-1)
    {
    Name = "Scl"
    }
   0.const([288,1422],0,0,-1)
    {
    Name = ""
    Value = "10.0"
    }
   0.multimeter([216,1458],4,0,20)
    {
    MeasI = "0"
    MeasV = "0"
    MeasP = "1"
    MeasQ = "1"
    RMS = "1"
    MeasPh = "0"
    S = "1.0 [MVA]"
    BaseV = "1.0 [kV]"
    TS = "0.02 [s]"
    Freq = "60.0 [Hz]"
    Dis = "1"
    CurI = ""
    VolI = ""
    P = "PscRE"
    Q = "QscRE"
    Vrms = "VscRE"
    Ph = ""
    hide1 = "1"
    hide2 = "1"
    Pd = "592.3"
    Qd = "-36.61"
    Vd = "229"
    }
   0.multimeter([450,1458],4,0,40)
    {
    MeasI = "0"
    MeasV = "0"
    MeasP = "1"
    MeasQ = "1"
    RMS = "1"
    MeasPh = "0"
    S = "1.0 [MVA]"
    BaseV = "1.0 [kV]"
    TS = "0.02 [s]"
    Freq = "60.0 [Hz]"
    Dis = "1"
    CurI = ""
    VolI = ""
    P = "PscSE"
    Q = "QscSE"
    Vrms = "VscSE"
    Ph = ""
    hide1 = "1"
    hide2 = "1"
    Pd = "59.23"
    Qd = "1.369"
    Vd = "114.2"
    }
   .ETRAN_COM_BERG([1170,1476],0,0,-1)
    {
    LName = "TestLine1"
    Port = "2000"
    Rpu = "1 [pu]"
    Xpu = "1 [pu]"
    Bpu = "1 [pu]"
    R0pu = ".1 [pu]"
    X0pu = "2 [pu]"
    B0pu = "2 [pu]"
    MVA = "100 [MVA]"
    VBase = "230 [kV]"
    F = "60 [Hz]"
    NumC = "3"
    scl = "1.0 [pu]"
    }
   0.annotation([1260,1224],0,0,-1)
    {
    AL1 = "E-TRAN Plus components for Parallel Processing Using Com Library"
    AL2 = "(these models all require an \"E-TRAN Plus\" runtime license)"
    }
   .ETRAN_COM_BERG([1224,1476],4,0,-1)
    {
    LName = "TestLine1"
    Port = "2000"
    Rpu = "1 [pu]"
    Xpu = "1 [pu]"
    Bpu = "1 [pu]"
    R0pu = ".1 [pu]"
    X0pu = "2 [pu]"
    B0pu = "2 [pu]"
    MVA = "100 [MVA]"
    VBase = "230 [kV]"
    F = "60 [Hz]"
    NumC = "3"
    scl = "1.0 [pu]"
    }
   .Sequencer_Electranix_ETRANPlus_Com([828,1278],0,0,-1)
    {
    Option = "0"
    TxtName = "C:\\Temp\\Port_Computer_Map.txt"
    TStart = "1.0 [sec]"
    header1 = ""
    Port1 = "2000"
    EPort1 = "0"
    CName1b = "localhost"
    Port2 = "2001"
    EPort2 = "0"
    CName2b = "192.168.0.102"
    Port3 = "0"
    EPort3 = "0"
    CName3b = "Comp3b"
    Port4 = "0"
    EPort4 = "0"
    CName4b = "Comp4b"
    Port5 = "0"
    EPort5 = "0"
    CName5b = "Comp5b"
    Port6 = "0"
    EPort6 = "0"
    CName6b = "Comp6b"
    Port7 = "0"
    EPort7 = "0"
    CName7b = "Comp7b"
    Port8 = "0"
    EPort8 = "0"
    CName8b = "Comp8b"
    Port9 = "0"
    EPort9 = "0"
    CName9b = "Comp9b"
    Port10 = "0"
    EPort10 = "0"
    CName10b = "Comp10b"
    header2 = ""
    Port11 = "0"
    EPort11 = "0"
    CName11b = "Comp11b"
    Port12 = "0"
    EPort12 = "0"
    CName12b = "Comp12b"
    Port13 = "0"
    EPort13 = "0"
    CName13b = "Comp13b"
    Port14 = "0"
    EPort14 = "0"
    CName14b = "Comp14b"
    Port15 = "0"
    EPort15 = "0"
    CName15b = "Comp15b"
    Port16 = "0"
    EPort16 = "0"
    CName16b = "Comp16b"
    Port17 = "0"
    EPort17 = "0"
    CName17b = "Comp17b"
    Port18 = "0"
    EPort18 = "0"
    CName18b = "Comp18b"
    Port19 = "0"
    EPort19 = "0"
    CName19b = "Comp19b"
    Port20 = "0"
    EPort20 = "0"
    CName20b = "Comp20b"
    header3 = ""
    Port21 = "0"
    EPort21 = "0"
    CName21b = "Comp21b"
    Port22 = "0"
    EPort22 = "0"
    CName22b = "Comp22b"
    Port23 = "0"
    EPort23 = "0"
    CName23b = "Comp23b"
    Port24 = "0"
    EPort24 = "0"
    CName24b = "Comp24b"
    Port25 = "0"
    EPort25 = "0"
    CName25b = "Comp25b"
    Port26 = "0"
    EPort26 = "0"
    CName26b = "Comp26b"
    Port27 = "0"
    EPort27 = "0"
    CName27b = "Comp27b"
    Port28 = "0"
    EPort28 = "0"
    CName28b = "Comp28b"
    Port29 = "0"
    EPort29 = "0"
    CName29b = "Comp29b"
    Port30 = "0"
    EPort30 = "0"
    CName30b = "Comp30b"
    header4 = ""
    Port31 = "0"
    EPort31 = "0"
    CName31b = "Comp31b"
    Port32 = "0"
    EPort32 = "0"
    CName32b = "Comp32b"
    Port33 = "0"
    EPort33 = "0"
    CName33b = "Comp33b"
    Port34 = "0"
    EPort34 = "0"
    CName34b = "Comp34b"
    Port35 = "0"
    EPort35 = "0"
    CName35b = "Comp35b"
    Port36 = "0"
    EPort36 = "0"
    CName36b = "Comp36b"
    Port37 = "0"
    EPort37 = "0"
    CName37b = "Comp37b"
    Port38 = "0"
    EPort38 = "0"
    CName38b = "Comp38b"
    Port39 = "0"
    EPort39 = "0"
    CName39b = "Comp39b"
    Port40 = "0"
    EPort40 = "0"
    CName40b = "Comp40b"
    header5 = ""
    Port41 = "0"
    EPort41 = "0"
    CName41b = "Comp41b"
    Port42 = "0"
    EPort42 = "0"
    CName42b = "Comp42b"
    Port43 = "0"
    EPort43 = "0"
    CName43b = "Comp43b"
    Port44 = "0"
    EPort44 = "0"
    CName44b = "Comp44b"
    Port45 = "0"
    EPort45 = "0"
    CName45b = "Comp45b"
    Port46 = "0"
    EPort46 = "0"
    CName46b = "Comp46b"
    Port47 = "0"
    EPort47 = "0"
    CName47b = "Comp47b"
    Port48 = "0"
    EPort48 = "0"
    CName48b = "Comp48b"
    Port49 = "0"
    EPort49 = "0"
    CName49b = "Comp49b"
    Port50 = "0"
    EPort50 = "0"
    CName50b = "Comp50b"
    header6 = ""
    Port51 = "0"
    EPort51 = "0"
    CName51b = "Comp51b"
    Port52 = "0"
    EPort52 = "0"
    CName52b = "Comp52b"
    Port53 = "0"
    EPort53 = "0"
    CName53b = "Comp53b"
    Port54 = "0"
    EPort54 = "0"
    CName54b = "Comp54b"
    Port55 = "0"
    EPort55 = "0"
    CName55b = "Comp55b"
    Port56 = "0"
    EPort56 = "0"
    CName56b = "Comp56b"
    Port57 = "0"
    EPort57 = "0"
    CName57b = "Comp57b"
    Port58 = "0"
    EPort58 = "0"
    CName58b = "Comp58b"
    Port59 = "0"
    EPort59 = "0"
    CName59b = "Comp59b"
    Port60 = "0"
    EPort60 = "0"
    CName60b = "Comp60b"
    header7 = ""
    Port61 = "0"
    EPort61 = "0"
    CName61b = "Comp61b"
    Port62 = "0"
    EPort62 = "0"
    CName62b = "Comp62b"
    Port63 = "0"
    EPort63 = "0"
    CName63b = "Comp63b"
    Port64 = "0"
    EPort64 = "0"
    CName64b = "Comp64b"
    }
   -Wire-([666,1584],0,0,-1)
    {
    Vertex="0,0;0,-360;1404,-360;1404,0"
    }
   .Electranix_Common_GetSet([828,1476],0,0,-1)
    {
    Name = "X1"
    DimI = "10"
    DimO = "10"
    Port = "2000"
    CDelay = "0 [sec]"
    TStart = "1.0 [sec]"
    Interp = "0"
    }
   .Sequencer_Electranix_AutoLaunch([1188,1314],0,0,-1)
    {
    Strt1 = "1"
    CName1 = "localhost"
    PName1 = "..\\Case1.emt"
    FName1 = "Case1.exe"
    Kill1 = "0"
    Proc1 = "0"
    Strt2 = "0"
    CName2 = "192.168.0.100"
    PName2 = "..\\Case2.emt"
    FName2 = "Case2.bat"
    Kill2 = "0"
    Proc2 = "0"
    Strt3 = "0"
    CName3 = "Comp3"
    PName3 = "..\\Case3.emt"
    FName3 = "Case3.exe"
    Kill3 = "0"
    Proc3 = "0"
    Strt4 = "0"
    CName4 = "Comp4"
    PName4 = "..\\Case4.emt"
    FName4 = "Case4.exe"
    Kill4 = "0"
    Proc4 = "0"
    Strt5 = "0"
    CName5 = "Comp5"
    PName5 = "..\\Case5.emt"
    FName5 = "Case5.exe"
    Kill5 = "0"
    Proc5 = "0"
    Strt6 = "0"
    CName6 = "Comp6"
    PName6 = "..\\Case6.emt"
    FName6 = "Case6.exe"
    Kill6 = "0"
    Proc6 = "0"
    Strt7 = "0"
    CName7 = "Comp7"
    PName7 = "..\\Case7.emt"
    FName7 = "Case7.exe"
    Kill7 = "0"
    Proc7 = "0"
    Strt8 = "0"
    CName8 = "Comp8"
    PName8 = "..\\Case8.emt"
    FName8 = "Case8.exe"
    Kill8 = "0"
    Proc8 = "0"
    Strt9 = "0"
    CName9 = "Comp9"
    PName9 = "..\\Case9.emt"
    FName9 = "Case9.exe"
    Kill9 = "0"
    Proc9 = "0"
    Strt10 = "0"
    CName10 = "Comp10"
    PName10 = "..\\Case10.emt"
    FName10 = "Case10.exe"
    Kill10 = "0"
    Proc10 = "0"
    Strt11 = "0"
    CName11 = "Comp11"
    PName11 = "..\\Case11.emt"
    FName11 = "Case11.exe"
    Kill11 = "0"
    Proc11 = "0"
    Strt12 = "0"
    CName12 = "Comp12"
    PName12 = "..\\Case12.emt"
    FName12 = "Case12.exe"
    Kill12 = "0"
    Proc12 = "0"
    Strt13 = "0"
    CName13 = "Comp13"
    PName13 = "..\\Case13.emt"
    FName13 = "Case13.exe"
    Kill13 = "0"
    Proc13 = "0"
    Strt14 = "0"
    CName14 = "Comp14"
    PName14 = "..\\Case14.emt"
    FName14 = "Case14.exe"
    Kill14 = "0"
    Proc14 = "0"
    Strt15 = "0"
    CName15 = "Comp15"
    PName15 = "..\\Case15.emt"
    FName15 = "Case15.exe"
    Kill15 = "0"
    Proc15 = "0"
    Strt16 = "0"
    CName16 = "Comp16"
    PName16 = "..\\Case16.emt"
    FName16 = "Case16.exe"
    Kill16 = "0"
    Proc16 = "0"
    Strt17 = "0"
    CName17 = "Comp17"
    PName17 = "..\\Case17.emt"
    FName17 = "Case17.exe"
    Kill17 = "0"
    Proc17 = "0"
    Strt18 = "0"
    CName18 = "Comp18"
    PName18 = "..\\Case18.emt"
    FName18 = "Case18.exe"
    Kill18 = "0"
    Proc18 = "0"
    Strt19 = "0"
    CName19 = "Comp19"
    PName19 = "..\\Case19.emt"
    FName19 = "Case19.exe"
    Kill19 = "0"
    Proc19 = "0"
    Strt20 = "0"
    CName20 = "Comp20"
    PName20 = "..\\Case20.emt"
    FName20 = "Case20.exe"
    Kill20 = "0"
    Proc20 = "0"
    Strt21 = "0"
    CName21 = "Comp21"
    PName21 = "..\\Case21.emt"
    FName21 = "Case21.exe"
    Kill21 = "0"
    Proc21 = "0"
    Strt22 = "0"
    CName22 = "Comp22"
    PName22 = "..\\Case22.emt"
    FName22 = "Case22.exe"
    Kill22 = "0"
    Proc22 = "0"
    Strt23 = "0"
    CName23 = "Comp23"
    PName23 = "..\\Case23.emt"
    FName23 = "Case23exe"
    Kill23 = "0"
    Proc23 = "0"
    Strt24 = "0"
    CName24 = "Comp24"
    PName24 = "..\\Case24.emt"
    FName24 = "Case24.exe"
    Kill24 = "0"
    Proc24 = "0"
    Strt25 = "0"
    CName25 = "Comp25"
    PName25 = "..\\Case25.emt"
    FName25 = "Case25.exe"
    Kill25 = "0"
    Proc25 = "0"
    Strt26 = "0"
    CName26 = "Comp26"
    PName26 = "..\\Case26.emt"
    FName26 = "Case26.exe"
    Kill26 = "0"
    Proc26 = "0"
    Strt27 = "0"
    CName27 = "Comp27"
    PName27 = "..\\Case27.emt"
    FName27 = "Case27.exe"
    Kill27 = "0"
    Proc27 = "0"
    Strt28 = "0"
    CName28 = "Comp28"
    PName28 = "..\\Case28.emt"
    FName28 = "Case28.exe"
    Kill28 = "0"
    Proc28 = "0"
    Strt29 = "0"
    CName29 = "Comp29"
    PName29 = "..\\Case29.emt"
    FName29 = "Case29.exe"
    Kill29 = "0"
    Proc29 = "0"
    Strt30 = "0"
    CName30 = "Comp30"
    PName30 = "..\\Case30.emt"
    FName30 = "Case30.exe"
    Kill30 = "0"
    Proc30 = "0"
    Strt31 = "0"
    CName31 = "Comp31"
    PName31 = "..\\Case31.emt"
    FName31 = "Case31.exe"
    Kill31 = "0"
    Proc31 = "0"
    Strt32 = "0"
    CName32 = "Comp32"
    PName32 = "..\\Case32.emt"
    FName32 = "Case32exe"
    Kill32 = "0"
    Proc32 = "0"
    Strt33 = "0"
    CName33 = "Comp33"
    PName33 = "..\\Case33.emt"
    FName33 = "Case33.exe"
    Kill33 = "0"
    Proc33 = "0"
    Strt34 = "0"
    CName34 = "Comp34"
    PName34 = "..\\Case34.emt"
    FName34 = "Case34.exe"
    Kill34 = "0"
    Proc34 = "0"
    Strt35 = "0"
    CName35 = "Comp35"
    PName35 = "..\\Case35.emt"
    FName35 = "Case35.exe"
    Kill35 = "0"
    Proc35 = "0"
    Strt36 = "0"
    CName36 = "Comp36"
    PName36 = "..\\Case36.emt"
    FName36 = "Case36.exe"
    Kill36 = "0"
    Proc36 = "0"
    Priority = "0"
    }
   0.annotation([1188,1512],0,0,-1)
    {
    AL1 = "PSCAD to PSCAD Parallel Processing"
    AL2 = "Bergeron Line Model"
    }
   0.annotation([846,1350],0,0,-1)
    {
    AL1 = "PSCAD to PSCAD"
    AL2 = "(must be used once if any E-TRAN plus models are used)"
    }
   0.annotation([1188,1350],0,0,-1)
    {
    AL1 = "AutoLaunch"
    AL2 = "Used to start other EMTDC .exe cases or PSS/E .bat cases"
    }
   0.annotation([1602,1332],0,0,-1)
    {
    AL1 = "PSS/E to PSCAD Signal Passing"
    AL2 = ""
    }
   0.annotation([1602,1350],0,0,-1)
    {
    AL1 = "Can be called many times"
    AL2 = "(each time PSCAD gets one PSS/E signal)"
    }
   0.annotation([828,1512],0,0,-1)
    {
    AL1 = "Wireles Transfer with a time delay"
    AL2 = "Used to communicate signals between processes"
    }
   .Electranix_Load([486,504],0,0,-1)
    {
    Name = "Load 1"
    PO = "100 [MW]"
    QO = "25 [MVAR]"
    FR = "60 [Hz]"
    VBO = "230 [KV]"
    VO = "1 [p.u.]"
    HOLD = "1"
    LoadType = "0"
    Compact = "0"
    View = "1"
    Enable = "1"
    ZeroSeq = "0"
    MVA = "100 [MVA]"
    R0pu = "0 [pu]"
    X0pu = "1 [pu]"
    PL = ""
    QL = ""
    INAME = ""
    Pdisplay = "0.0"
    Qdisplay = "0.0"
    }
   0.annotation([1386,378],0,0,-1)
    {
    AL1 = "3 Winding Transformer"
    AL2 = ""
    }
   .Electranix_Load([1152,504],0,0,-1)
    {
    Name = "Load 1"
    PO = "100 [MW]"
    QO = "25 [MVAR]"
    FR = "60 [Hz]"
    VBO = "230 [KV]"
    VO = "1 [p.u.]"
    HOLD = "1"
    LoadType = "3"
    Compact = "1"
    View = "1"
    Enable = "1"
    ZeroSeq = "2"
    MVA = "100 [MVA]"
    R0pu = "0 [pu]"
    X0pu = "1 [pu]"
    PL = ""
    QL = ""
    INAME = ""
    Pdisplay = ""
    Qdisplay = ""
    }
   .Electranix_Scale_2([1656,1458],0,0,-1)
    {
    Name = "T32"
    Tmva = "100.0 [MVA]"
    f = "60.0 [Hz]"
    YD1 = "0"
    YD2 = "0"
    Lead = "1"
    Xl = "0.1 [pu]"
    Ideal = "0"
    NLL = "0.0 [pu]"
    CuL = "0.0 [pu]"
    Tap = "0"
    View = "1"
    Dtls = "0"
    Port = "2000"
    V2 = "230.0 [kV]"
    V1 = "230.0 [kV]"
    Im1 = "0.4 [%]"
    Txk = "0.1 [s]"
    Xknee = "1.25 [pu]"
    Tdc = "1.0 [s]"
    Xair = "0.2 [pu]"
    Sat = "1"
    Enab = "0"
    ILC1 = ""
    ILB1 = ""
    ILA1 = ""
    ICA1 = ""
    IBC1 = ""
    IAB1 = ""
    ILC2 = ""
    ILB2 = ""
    ILA2 = ""
    ICA2 = ""
    IBC2 = ""
    IAB2 = ""
    FLXC = ""
    FLXB = ""
    FLXA = ""
    IMC = ""
    IMB = ""
    IMA = ""
    FLXCA = ""
    FLXBC = ""
    FLXAB = ""
    IMCA = ""
    IMBC = ""
    IMAB = ""
    }
   0.annotation([1584,1512],0,0,-1)
    {
    AL1 = "PSCAD to PSCAD"
    AL2 = "Transformer Scaling (parallel version)"
    }
   .Electranix_Scale_1([1494,1458],0,0,-1)
    {
    Tmva = "100.0 [MVA]"
    f = "60.0 [Hz]"
    Xl = "0.1 [pu]"
    Port = "2000"
    View = "1"
    V1 = "230.0 [kV]"
    ILA1 = ""
    ILB1 = ""
    ILC1 = ""
    }
   0.annotation([1908,1350],0,0,-1)
    {
    AL1 = "Can be called many times"
    AL2 = "(each time PSCAD passes one signal to PSS/E )"
    }
   0.annotation([1908,1332],0,0,-1)
    {
    AL1 = "PSCAD to PSS/E Signal Passing"
    AL2 = ""
    }
   .Sequencer_Electranix_PSCAD_chan_export([1908,1278],0,0,-1)
    {
    Port = "2000"
    CTGY = "1"
    fault = "3"
    IBUS = "100"
    JBUS = "200"
    CHECK = "0"
    KBUS = "300"
    IDD = "1"
    ID = "1"
    Bus1 = "100"
    Chan = "0"
    }
   .Sequencer_Electranix_PSSE_chan_import([1602,1278],0,0,-1)
    {
    Port = "2000"
    Chan = "13"
    Bus1 = "100"
    Bus2 = "200"
    ID = "1"
    }
   .Electranix_Breaker_Control([1710,504],0,0,-1)
    {
    }
   0.annotation([1764,900],0,0,-1)
    {
    AL1 = "Breaker Controller component for breaker subpages"
    AL2 = "(Use E-TRAN to generate the breaker pages automatically)"
    }
   .Electranix_xfmr_3w([1386,342],0,0,-1)
    {
    Name = "T1"
    Tmva3 = "100 [MVA]"
    f = "60 [Hz]"
    Enable = "1"
    V5Format = "0"
    V1LL = "230 [kV]"
    V2LL = "115 [kV]"
    V3LL = "13.8 [kV]"
    Rw12 = "0.01 [p.u.]"
    Xl12 = "0.1 [p.u.]"
    Rw23 = "0.01 [p.u.]"
    Xl23 = "0.1 [p.u.]"
    Rw13 = "0.01 [p.u.]"
    Xl13 = "0.1 [p.u.]"
    Config1 = "0"
    Config2 = "0"
    Config3 = "0"
    Tap = "0"
    Tap1 = "1 [pu]"
    Tap2 = "1 [pu]"
    Tap3 = "1 [pu]"
    XlTable = "0"
    XlFactor = "1.0 [p.u.]"
    XlFactj = "0.0 [p.u.]"
    XlTable2 = "0"
    XlFact2 = "1.0 [p.u.]"
    XlFact2j = "0.0 [p.u.]"
    XlTable3 = "0"
    XlFact3 = "1.0 [p.u.]"
    XlFact3j = "0.0 [p.u.]"
    ZCOD = "1"
    Enab = "0"
    Sat = "1"
    Xair = "0.2 [p.u.]"
    Tdc = "1.0 [sec]"
    Xknee = "1.25 [p.u.]"
    Txk = "0.1 [sec]"
    Im1 = "0.4 [%]"
    IL1 = ""
    IL2 = ""
    IL3 = ""
    IMAG = ""
    FLUX = ""
    }
   .Electranix_xfmr_2w([972,342],0,0,-1)
    {
    Name = "T1"
    Tmva3 = "100 [MVA]"
    f = "60 [Hz]"
    V1LL = "230 [kV]"
    V2LL = "230 [kV]"
    Rw = "0.01 [p.u.]"
    Xl = "0.1 [p.u.]"
    B = "0.0 [p.u.]"
    Config1 = "0"
    Config2 = "0"
    Enable = "1"
    PHSHFT = "0"
    View = "1"
    NegXCap = "0"
    V5Format = "0"
    Tap = "0"
    TapI = "1 [pu]"
    PSANG = "0.0 [°]"
    XlTable = "0"
    XlFactor = "1.0 [p.u.]"
    XlFactj = "0.0 [p.u.]"
    GI = "0.0 [p.u.]"
    BI = "0.0 [p.u.]"
    GJ = "0.0 [p.u.]"
    BJ = "0.0 [p.u.]"
    Enab = "0"
    Sat = "1"
    Xair = "0.2 [p.u.]"
    Tdc = "1.0 [sec]"
    Xknee = "1.25 [p.u.]"
    Txk = "0.1 [sec]"
    Im1 = "0.4 [%]"
    IL1 = ""
    IL2 = ""
    IMAG = ""
    FLUX = ""
    }
   .Electranix_xfmr_2w([1188,342],0,0,-1)
    {
    Name = "T1"
    Tmva3 = "100 [MVA]"
    f = "60 [Hz]"
    V1LL = "230 [kV]"
    V2LL = "230 [kV]"
    Rw = "0.01 [p.u.]"
    Xl = "0.1 [p.u.]"
    B = "0.0 [p.u.]"
    Config1 = "0"
    Config2 = "0"
    Enable = "1"
    PHSHFT = "1"
    View = "1"
    NegXCap = "0"
    V5Format = "0"
    Tap = "2"
    TapI = "1 [pu]"
    PSANG = "0.0 [°]"
    XlTable = "0"
    XlFactor = "1.0 [p.u.]"
    XlFactj = "0.0 [p.u.]"
    GI = "0.0 [p.u.]"
    BI = "0.0 [p.u.]"
    GJ = "0.0 [p.u.]"
    BJ = "0.0 [p.u.]"
    Enab = "0"
    Sat = "1"
    Xair = "0.2 [p.u.]"
    Tdc = "1.0 [sec]"
    Xknee = "1.25 [p.u.]"
    Txk = "0.1 [sec]"
    Im1 = "0.4 [%]"
    IL1 = ""
    IL2 = ""
    IMAG = ""
    FLUX = ""
    }
   .Electranix_switch([1566,342],0,0,-1)
    {
    NAMEA = "BRK"
    NAMEB = "BRK"
    NAMEC = "BRK"
    ROFF = "1.0e8 [ohm]"
    RON = "0.001 [ohm]"
    OPCUR = "0"
    CLVL = "0.0 [kA]"
    XSw = "0.0 [pu]"
    VRated = "230.0 [kV]"
    MVA = "100 [MVA]"
    F = "60.0 [Hz]"
    TS = "0.02 [sec]"
    DisPQ = "1"
    SwType = "0"
    PSCADV = "0"
    IBRA = ""
    IBRB = ""
    IBRC = ""
    IBR0 = ""
    SBRA = ""
    SBRB = ""
    SBRC = ""
    BP = ""
    BQ = ""
    BOpen1 = "2"
    BOpen2 = "2"
    BOpen3 = "2"
    P = "10.0"
    Q = "20.0"
    }
   0.annotation([1566,378],0,0,-1)
    {
    AL1 = "Switch Model"
    AL2 = ""
    }
   }
  }
 }

